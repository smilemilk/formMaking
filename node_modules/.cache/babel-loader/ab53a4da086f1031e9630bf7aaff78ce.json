{"remainingRequest":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/babel-loader/lib/index.js!/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/eslint-loader/index.js??ref--13-0!/Users/shanliguo/Documents/workstudy/vue-form-making/src/lib/tinymce/plugins/image/plugin.js","dependencies":[{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/src/lib/tinymce/plugins/image/plugin.js","mtime":1551936176000},{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var image = function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var hasDimensions = function (editor) {\n      return editor.settings.image_dimensions === false ? false : true;\n    };\n\n    var hasAdvTab = function (editor) {\n      return editor.settings.image_advtab === true ? true : false;\n    };\n\n    var getPrependUrl = function (editor) {\n      return editor.getParam('image_prepend_url', '');\n    };\n\n    var getClassList = function (editor) {\n      return editor.getParam('image_class_list');\n    };\n\n    var hasDescription = function (editor) {\n      return editor.settings.image_description === false ? false : true;\n    };\n\n    var hasImageTitle = function (editor) {\n      return editor.settings.image_title === true ? true : false;\n    };\n\n    var hasImageCaption = function (editor) {\n      return editor.settings.image_caption === true ? true : false;\n    };\n\n    var getImageList = function (editor) {\n      return editor.getParam('image_list', false);\n    };\n\n    var hasUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', false);\n    };\n\n    var hasUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', false);\n    };\n\n    var getUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url');\n    };\n\n    var getUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler');\n    };\n\n    var getUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path');\n    };\n\n    var getUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials');\n    };\n\n    var $_cwfv1xctjnlpb19i = {\n      hasDimensions: hasDimensions,\n      hasAdvTab: hasAdvTab,\n      getPrependUrl: getPrependUrl,\n      getClassList: getClassList,\n      hasDescription: hasDescription,\n      hasImageTitle: hasImageTitle,\n      hasImageCaption: hasImageCaption,\n      getImageList: getImageList,\n      hasUploadUrl: hasUploadUrl,\n      hasUploadHandler: hasUploadHandler,\n      getUploadUrl: getUploadUrl,\n      getUploadHandler: getUploadHandler,\n      getUploadBasePath: getUploadBasePath,\n      getUploadCredentials: getUploadCredentials\n    };\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var path = function (parts, scope) {\n      var o = scope !== undefined && scope !== null ? scope : Global;\n\n      for (var i = 0; i < parts.length && o !== undefined && o !== null; ++i) o = o[parts[i]];\n\n      return o;\n    };\n\n    var resolve = function (p, scope) {\n      var parts = p.split('.');\n      return path(parts, scope);\n    };\n\n    var unsafe = function (name, scope) {\n      return resolve(name, scope);\n    };\n\n    var getOrDie = function (name, scope) {\n      var actual = unsafe(name, scope);\n      if (actual === undefined || actual === null) throw name + ' not available on this browser';\n      return actual;\n    };\n\n    var $_4q4g1acwjnlpb19s = {\n      getOrDie: getOrDie\n    };\n\n    function FileReader() {\n      var f = $_4q4g1acwjnlpb19s.getOrDie('FileReader');\n      return new f();\n    }\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var parseIntAndGetMax = function (val1, val2) {\n      return Math.max(parseInt(val1, 10), parseInt(val2, 10));\n    };\n\n    var getImageSize = function (url, callback) {\n      var img = document.createElement('img');\n\n      function done(width, height) {\n        if (img.parentNode) {\n          img.parentNode.removeChild(img);\n        }\n\n        callback({\n          width: width,\n          height: height\n        });\n      }\n\n      img.onload = function () {\n        var width = parseIntAndGetMax(img.width, img.clientWidth);\n        var height = parseIntAndGetMax(img.height, img.clientHeight);\n        done(width, height);\n      };\n\n      img.onerror = function () {\n        done(0, 0);\n      };\n\n      var style = img.style;\n      style.visibility = 'hidden';\n      style.position = 'fixed';\n      style.bottom = style.left = '0px';\n      style.width = style.height = 'auto';\n      document.body.appendChild(img);\n      img.src = url;\n    };\n\n    var buildListItems = function (inputList, itemCallback, startItems) {\n      function appendItems(values, output) {\n        output = output || [];\n        global$2.each(values, function (item) {\n          var menuItem = {\n            text: item.text || item.title\n          };\n\n          if (item.menu) {\n            menuItem.menu = appendItems(item.menu);\n          } else {\n            menuItem.value = item.value;\n            itemCallback(menuItem);\n          }\n\n          output.push(menuItem);\n        });\n        return output;\n      }\n\n      return appendItems(inputList, startItems || []);\n    };\n\n    var removePixelSuffix = function (value) {\n      if (value) {\n        value = value.replace(/px$/, '');\n      }\n\n      return value;\n    };\n\n    var addPixelSuffix = function (value) {\n      if (value.length > 0 && /^[0-9]+$/.test(value)) {\n        value += 'px';\n      }\n\n      return value;\n    };\n\n    var mergeMargins = function (css) {\n      if (css.margin) {\n        var splitMargin = css.margin.split(' ');\n\n        switch (splitMargin.length) {\n          case 1:\n            css['margin-top'] = css['margin-top'] || splitMargin[0];\n            css['margin-right'] = css['margin-right'] || splitMargin[0];\n            css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n            css['margin-left'] = css['margin-left'] || splitMargin[0];\n            break;\n\n          case 2:\n            css['margin-top'] = css['margin-top'] || splitMargin[0];\n            css['margin-right'] = css['margin-right'] || splitMargin[1];\n            css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n            css['margin-left'] = css['margin-left'] || splitMargin[1];\n            break;\n\n          case 3:\n            css['margin-top'] = css['margin-top'] || splitMargin[0];\n            css['margin-right'] = css['margin-right'] || splitMargin[1];\n            css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n            css['margin-left'] = css['margin-left'] || splitMargin[1];\n            break;\n\n          case 4:\n            css['margin-top'] = css['margin-top'] || splitMargin[0];\n            css['margin-right'] = css['margin-right'] || splitMargin[1];\n            css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n            css['margin-left'] = css['margin-left'] || splitMargin[3];\n        }\n\n        delete css.margin;\n      }\n\n      return css;\n    };\n\n    var createImageList = function (editor, callback) {\n      var imageList = $_cwfv1xctjnlpb19i.getImageList(editor);\n\n      if (typeof imageList === 'string') {\n        global$3.send({\n          url: imageList,\n          success: function (text) {\n            callback(JSON.parse(text));\n          }\n        });\n      } else if (typeof imageList === 'function') {\n        imageList(callback);\n      } else {\n        callback(imageList);\n      }\n    };\n\n    var waitLoadImage = function (editor, data, imgElm) {\n      function selectImage() {\n        imgElm.onload = imgElm.onerror = null;\n\n        if (editor.selection) {\n          editor.selection.select(imgElm);\n          editor.nodeChanged();\n        }\n      }\n\n      imgElm.onload = function () {\n        if (!data.width && !data.height && $_cwfv1xctjnlpb19i.hasDimensions(editor)) {\n          editor.dom.setAttribs(imgElm, {\n            width: imgElm.clientWidth,\n            height: imgElm.clientHeight\n          });\n        }\n\n        selectImage();\n      };\n\n      imgElm.onerror = selectImage;\n    };\n\n    var blobToDataUri = function (blob) {\n      return new global$1(function (resolve, reject) {\n        var reader = FileReader();\n\n        reader.onload = function () {\n          resolve(reader.result);\n        };\n\n        reader.onerror = function () {\n          reject(reader.error.message);\n        };\n\n        reader.readAsDataURL(blob);\n      });\n    };\n\n    var $_c1uzycujnlpb19l = {\n      getImageSize: getImageSize,\n      buildListItems: buildListItems,\n      removePixelSuffix: removePixelSuffix,\n      addPixelSuffix: addPixelSuffix,\n      mergeMargins: mergeMargins,\n      createImageList: createImageList,\n      waitLoadImage: waitLoadImage,\n      blobToDataUri: blobToDataUri\n    };\n    var global$4 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n    var shallow = function (old, nu) {\n      return nu;\n    };\n\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n\n        for (var i = 0; i < objects.length; i++) objects[i] = arguments[i];\n\n        if (objects.length === 0) throw new Error('Can\\'t merge zero objects');\n        var ret = {};\n\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n\n          for (var key in curObject) if (hasOwnProperty.call(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n\n        return ret;\n      };\n    };\n\n    var merge = baseMerge(shallow);\n    var DOM = global$4.DOM;\n\n    var getHspace = function (image) {\n      if (image.style.marginLeft && image.style.marginRight && image.style.marginLeft === image.style.marginRight) {\n        return $_c1uzycujnlpb19l.removePixelSuffix(image.style.marginLeft);\n      } else {\n        return '';\n      }\n    };\n\n    var getVspace = function (image) {\n      if (image.style.marginTop && image.style.marginBottom && image.style.marginTop === image.style.marginBottom) {\n        return $_c1uzycujnlpb19l.removePixelSuffix(image.style.marginTop);\n      } else {\n        return '';\n      }\n    };\n\n    var getBorder = function (image) {\n      if (image.style.borderWidth) {\n        return $_c1uzycujnlpb19l.removePixelSuffix(image.style.borderWidth);\n      } else {\n        return '';\n      }\n    };\n\n    var getAttrib = function (image, name$$1) {\n      if (image.hasAttribute(name$$1)) {\n        return image.getAttribute(name$$1);\n      } else {\n        return '';\n      }\n    };\n\n    var getStyle = function (image, name$$1) {\n      return image.style[name$$1] ? image.style[name$$1] : '';\n    };\n\n    var hasCaption = function (image) {\n      return image.parentNode !== null && image.parentNode.nodeName === 'FIGURE';\n    };\n\n    var setAttrib = function (image, name$$1, value) {\n      image.setAttribute(name$$1, value);\n    };\n\n    var wrapInFigure = function (image) {\n      var figureElm = DOM.create('figure', {\n        class: 'image'\n      });\n      DOM.insertAfter(figureElm, image);\n      figureElm.appendChild(image);\n      figureElm.appendChild(DOM.create('figcaption', {\n        contentEditable: true\n      }, 'Caption'));\n      figureElm.contentEditable = 'false';\n    };\n\n    var removeFigure = function (image) {\n      var figureElm = image.parentNode;\n      DOM.insertAfter(image, figureElm);\n      DOM.remove(figureElm);\n    };\n\n    var toggleCaption = function (image) {\n      if (hasCaption(image)) {\n        removeFigure(image);\n      } else {\n        wrapInFigure(image);\n      }\n    };\n\n    var normalizeStyle = function (image, normalizeCss) {\n      var attrValue = image.getAttribute('style');\n      var value = normalizeCss(attrValue !== null ? attrValue : '');\n\n      if (value.length > 0) {\n        image.setAttribute('style', value);\n        image.setAttribute('data-mce-style', value);\n      } else {\n        image.removeAttribute('style');\n      }\n    };\n\n    var setSize = function (name$$1, normalizeCss) {\n      return function (image, name$$1, value) {\n        if (image.style[name$$1]) {\n          image.style[name$$1] = $_c1uzycujnlpb19l.addPixelSuffix(value);\n          normalizeStyle(image, normalizeCss);\n        } else {\n          setAttrib(image, name$$1, value);\n        }\n      };\n    };\n\n    var getSize = function (image, name$$1) {\n      if (image.style[name$$1]) {\n        return $_c1uzycujnlpb19l.removePixelSuffix(image.style[name$$1]);\n      } else {\n        return getAttrib(image, name$$1);\n      }\n    };\n\n    var setHspace = function (image, value) {\n      var pxValue = $_c1uzycujnlpb19l.addPixelSuffix(value);\n      image.style.marginLeft = pxValue;\n      image.style.marginRight = pxValue;\n    };\n\n    var setVspace = function (image, value) {\n      var pxValue = $_c1uzycujnlpb19l.addPixelSuffix(value);\n      image.style.marginTop = pxValue;\n      image.style.marginBottom = pxValue;\n    };\n\n    var setBorder = function (image, value) {\n      var pxValue = $_c1uzycujnlpb19l.addPixelSuffix(value);\n      image.style.borderWidth = pxValue;\n    };\n\n    var setBorderStyle = function (image, value) {\n      image.style.borderStyle = value;\n    };\n\n    var getBorderStyle = function (image) {\n      return getStyle(image, 'borderStyle');\n    };\n\n    var isFigure = function (elm) {\n      return elm.nodeName === 'FIGURE';\n    };\n\n    var defaultData = function () {\n      return {\n        src: '',\n        alt: '',\n        title: '',\n        width: '',\n        height: '',\n        class: '',\n        style: '',\n        caption: false,\n        hspace: '',\n        vspace: '',\n        border: '',\n        borderStyle: ''\n      };\n    };\n\n    var getStyleValue = function (normalizeCss, data) {\n      var image = document.createElement('img');\n      setAttrib(image, 'style', data.style);\n\n      if (getHspace(image) || data.hspace !== '') {\n        setHspace(image, data.hspace);\n      }\n\n      if (getVspace(image) || data.vspace !== '') {\n        setVspace(image, data.vspace);\n      }\n\n      if (getBorder(image) || data.border !== '') {\n        setBorder(image, data.border);\n      }\n\n      if (getBorderStyle(image) || data.borderStyle !== '') {\n        setBorderStyle(image, data.borderStyle);\n      }\n\n      return normalizeCss(image.getAttribute('style'));\n    };\n\n    var create = function (normalizeCss, data) {\n      var image = document.createElement('img');\n      write(normalizeCss, merge(data, {\n        caption: false\n      }), image);\n      setAttrib(image, 'alt', data.alt);\n\n      if (data.caption) {\n        var figure = DOM.create('figure', {\n          class: 'image'\n        });\n        figure.appendChild(image);\n        figure.appendChild(DOM.create('figcaption', {\n          contentEditable: true\n        }, 'Caption'));\n        figure.contentEditable = 'false';\n        return figure;\n      } else {\n        return image;\n      }\n    };\n\n    var read = function (normalizeCss, image) {\n      return {\n        src: getAttrib(image, 'src'),\n        alt: getAttrib(image, 'alt'),\n        title: getAttrib(image, 'title'),\n        width: getSize(image, 'width'),\n        height: getSize(image, 'height'),\n        class: getAttrib(image, 'class'),\n        style: normalizeCss(getAttrib(image, 'style')),\n        caption: hasCaption(image),\n        hspace: getHspace(image),\n        vspace: getVspace(image),\n        border: getBorder(image),\n        borderStyle: getStyle(image, 'borderStyle')\n      };\n    };\n\n    var updateProp = function (image, oldData, newData, name$$1, set) {\n      if (newData[name$$1] !== oldData[name$$1]) {\n        set(image, name$$1, newData[name$$1]);\n      }\n    };\n\n    var normalized = function (set, normalizeCss) {\n      return function (image, name$$1, value) {\n        set(image, value);\n        normalizeStyle(image, normalizeCss);\n      };\n    };\n\n    var write = function (normalizeCss, newData, image) {\n      var oldData = read(normalizeCss, image);\n      updateProp(image, oldData, newData, 'caption', function (image, _name, _value) {\n        return toggleCaption(image);\n      });\n      updateProp(image, oldData, newData, 'src', setAttrib);\n      updateProp(image, oldData, newData, 'alt', setAttrib);\n      updateProp(image, oldData, newData, 'title', setAttrib);\n      updateProp(image, oldData, newData, 'width', setSize('width', normalizeCss));\n      updateProp(image, oldData, newData, 'height', setSize('height', normalizeCss));\n      updateProp(image, oldData, newData, 'class', setAttrib);\n      updateProp(image, oldData, newData, 'style', normalized(function (image, value) {\n        return setAttrib(image, 'style', value);\n      }, normalizeCss));\n      updateProp(image, oldData, newData, 'hspace', normalized(setHspace, normalizeCss));\n      updateProp(image, oldData, newData, 'vspace', normalized(setVspace, normalizeCss));\n      updateProp(image, oldData, newData, 'border', normalized(setBorder, normalizeCss));\n      updateProp(image, oldData, newData, 'borderStyle', normalized(setBorderStyle, normalizeCss));\n    };\n\n    var normalizeCss = function (editor, cssText) {\n      var css = editor.dom.styles.parse(cssText);\n      var mergedCss = $_c1uzycujnlpb19l.mergeMargins(css);\n      var compressed = editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));\n      return editor.dom.styles.serialize(compressed);\n    };\n\n    var getSelectedImage = function (editor) {\n      var imgElm = editor.selection.getNode();\n      var figureElm = editor.dom.getParent(imgElm, 'figure.image');\n\n      if (figureElm) {\n        return editor.dom.select('img', figureElm)[0];\n      }\n\n      if (imgElm && (imgElm.nodeName !== 'IMG' || imgElm.getAttribute('data-mce-object') || imgElm.getAttribute('data-mce-placeholder'))) {\n        return null;\n      }\n\n      return imgElm;\n    };\n\n    var splitTextBlock = function (editor, figure) {\n      var dom = editor.dom;\n      var textBlock = dom.getParent(figure.parentNode, function (node) {\n        return editor.schema.getTextBlockElements()[node.nodeName];\n      });\n\n      if (textBlock) {\n        return dom.split(textBlock, figure);\n      } else {\n        return figure;\n      }\n    };\n\n    var readImageDataFromSelection = function (editor) {\n      var image = getSelectedImage(editor);\n      return image ? read(function (css) {\n        return normalizeCss(editor, css);\n      }, image) : defaultData();\n    };\n\n    var insertImageAtCaret = function (editor, data) {\n      var elm = create(function (css) {\n        return normalizeCss(editor, css);\n      }, data);\n      editor.dom.setAttrib(elm, 'data-mce-id', '__mcenew');\n      editor.focus();\n      editor.selection.setContent(elm.outerHTML);\n      var insertedElm = editor.dom.select('*[data-mce-id=\"__mcenew\"]')[0];\n      editor.dom.setAttrib(insertedElm, 'data-mce-id', null);\n\n      if (isFigure(insertedElm)) {\n        var figure = splitTextBlock(editor, insertedElm);\n        editor.selection.select(figure);\n      } else {\n        editor.selection.select(insertedElm);\n      }\n    };\n\n    var syncSrcAttr = function (editor, image) {\n      editor.dom.setAttrib(image, 'src', image.getAttribute('src'));\n    };\n\n    var deleteImage = function (editor, image) {\n      if (image) {\n        var elm = editor.dom.is(image.parentNode, 'figure.image') ? image.parentNode : image;\n        editor.dom.remove(elm);\n        editor.focus();\n        editor.nodeChanged();\n\n        if (editor.dom.isEmpty(editor.getBody())) {\n          editor.setContent('');\n          editor.selection.setCursorLocation();\n        }\n      }\n    };\n\n    var writeImageDataToSelection = function (editor, data) {\n      var image = getSelectedImage(editor);\n      write(function (css) {\n        return normalizeCss(editor, css);\n      }, data, image);\n      syncSrcAttr(editor, image);\n\n      if (isFigure(image.parentNode)) {\n        var figure = image.parentNode;\n        splitTextBlock(editor, figure);\n        editor.selection.select(image.parentNode);\n      } else {\n        editor.selection.select(image);\n        $_c1uzycujnlpb19l.waitLoadImage(editor, data, image);\n      }\n    };\n\n    var insertOrUpdateImage = function (editor, data) {\n      var image = getSelectedImage(editor);\n\n      if (image) {\n        if (data.src) {\n          writeImageDataToSelection(editor, data);\n        } else {\n          deleteImage(editor, image);\n        }\n      } else if (data.src) {\n        insertImageAtCaret(editor, data);\n      }\n    };\n\n    var updateVSpaceHSpaceBorder = function (editor) {\n      return function (evt) {\n        var dom = editor.dom;\n        var rootControl = evt.control.rootControl;\n\n        if (!$_cwfv1xctjnlpb19i.hasAdvTab(editor)) {\n          return;\n        }\n\n        var data = rootControl.toJSON();\n        var css = dom.parseStyle(data.style);\n        rootControl.find('#vspace').value('');\n        rootControl.find('#hspace').value('');\n        css = $_c1uzycujnlpb19l.mergeMargins(css);\n\n        if (css['margin-top'] && css['margin-bottom'] || css['margin-right'] && css['margin-left']) {\n          if (css['margin-top'] === css['margin-bottom']) {\n            rootControl.find('#vspace').value($_c1uzycujnlpb19l.removePixelSuffix(css['margin-top']));\n          } else {\n            rootControl.find('#vspace').value('');\n          }\n\n          if (css['margin-right'] === css['margin-left']) {\n            rootControl.find('#hspace').value($_c1uzycujnlpb19l.removePixelSuffix(css['margin-right']));\n          } else {\n            rootControl.find('#hspace').value('');\n          }\n        }\n\n        if (css['border-width']) {\n          rootControl.find('#border').value($_c1uzycujnlpb19l.removePixelSuffix(css['border-width']));\n        } else {\n          rootControl.find('#border').value('');\n        }\n\n        if (css['border-style']) {\n          rootControl.find('#borderStyle').value(css['border-style']);\n        } else {\n          rootControl.find('#borderStyle').value('');\n        }\n\n        rootControl.find('#style').value(dom.serializeStyle(dom.parseStyle(dom.serializeStyle(css))));\n      };\n    };\n\n    var updateStyle = function (editor, win) {\n      win.find('#style').each(function (ctrl) {\n        var value = getStyleValue(function (css) {\n          return normalizeCss(editor, css);\n        }, merge(defaultData(), win.toJSON()));\n        ctrl.value(value);\n      });\n    };\n\n    var makeTab = function (editor) {\n      return {\n        title: 'Advanced',\n        type: 'form',\n        pack: 'start',\n        items: [{\n          label: 'Style',\n          name: 'style',\n          type: 'textbox',\n          onchange: updateVSpaceHSpaceBorder(editor)\n        }, {\n          type: 'form',\n          layout: 'grid',\n          packV: 'start',\n          columns: 2,\n          padding: 0,\n          defaults: {\n            type: 'textbox',\n            maxWidth: 50,\n            onchange: function (evt) {\n              updateStyle(editor, evt.control.rootControl);\n            }\n          },\n          items: [{\n            label: 'Vertical space',\n            name: 'vspace'\n          }, {\n            label: 'Border width',\n            name: 'border'\n          }, {\n            label: 'Horizontal space',\n            name: 'hspace'\n          }, {\n            label: 'Border style',\n            type: 'listbox',\n            name: 'borderStyle',\n            width: 90,\n            maxWidth: 90,\n            onselect: function (evt) {\n              updateStyle(editor, evt.control.rootControl);\n            },\n            values: [{\n              text: 'Select...',\n              value: ''\n            }, {\n              text: 'Solid',\n              value: 'solid'\n            }, {\n              text: 'Dotted',\n              value: 'dotted'\n            }, {\n              text: 'Dashed',\n              value: 'dashed'\n            }, {\n              text: 'Double',\n              value: 'double'\n            }, {\n              text: 'Groove',\n              value: 'groove'\n            }, {\n              text: 'Ridge',\n              value: 'ridge'\n            }, {\n              text: 'Inset',\n              value: 'inset'\n            }, {\n              text: 'Outset',\n              value: 'outset'\n            }, {\n              text: 'None',\n              value: 'none'\n            }, {\n              text: 'Hidden',\n              value: 'hidden'\n            }]\n          }]\n        }]\n      };\n    };\n\n    var $_cdolkdd3jnlpb1ag = {\n      makeTab: makeTab\n    };\n\n    var doSyncSize = function (widthCtrl, heightCtrl) {\n      widthCtrl.state.set('oldVal', widthCtrl.value());\n      heightCtrl.state.set('oldVal', heightCtrl.value());\n    };\n\n    var doSizeControls = function (win, f) {\n      var widthCtrl = win.find('#width')[0];\n      var heightCtrl = win.find('#height')[0];\n      var constrained = win.find('#constrain')[0];\n\n      if (widthCtrl && heightCtrl && constrained) {\n        f(widthCtrl, heightCtrl, constrained.checked());\n      }\n    };\n\n    var doUpdateSize = function (widthCtrl, heightCtrl, isContrained) {\n      var oldWidth = widthCtrl.state.get('oldVal');\n      var oldHeight = heightCtrl.state.get('oldVal');\n      var newWidth = widthCtrl.value();\n      var newHeight = heightCtrl.value();\n\n      if (isContrained && oldWidth && oldHeight && newWidth && newHeight) {\n        if (newWidth !== oldWidth) {\n          newHeight = Math.round(newWidth / oldWidth * newHeight);\n\n          if (!isNaN(newHeight)) {\n            heightCtrl.value(newHeight);\n          }\n        } else {\n          newWidth = Math.round(newHeight / oldHeight * newWidth);\n\n          if (!isNaN(newWidth)) {\n            widthCtrl.value(newWidth);\n          }\n        }\n      }\n\n      doSyncSize(widthCtrl, heightCtrl);\n    };\n\n    var syncSize = function (win) {\n      doSizeControls(win, doSyncSize);\n    };\n\n    var updateSize = function (win) {\n      doSizeControls(win, doUpdateSize);\n    };\n\n    var createUi = function () {\n      var recalcSize = function (evt) {\n        updateSize(evt.control.rootControl);\n      };\n\n      return {\n        type: 'container',\n        label: 'Dimensions',\n        layout: 'flex',\n        align: 'center',\n        spacing: 5,\n        items: [{\n          name: 'width',\n          type: 'textbox',\n          maxLength: 5,\n          size: 5,\n          onchange: recalcSize,\n          ariaLabel: 'Width'\n        }, {\n          type: 'label',\n          text: 'x'\n        }, {\n          name: 'height',\n          type: 'textbox',\n          maxLength: 5,\n          size: 5,\n          onchange: recalcSize,\n          ariaLabel: 'Height'\n        }, {\n          name: 'constrain',\n          type: 'checkbox',\n          checked: true,\n          text: 'Constrain proportions'\n        }]\n      };\n    };\n\n    var $_dk9flrdajnlpb1bd = {\n      createUi: createUi,\n      syncSize: syncSize,\n      updateSize: updateSize\n    };\n\n    var onSrcChange = function (evt, editor) {\n      var srcURL, prependURL, absoluteURLPattern;\n      var meta = evt.meta || {};\n      var control = evt.control;\n      var rootControl = control.rootControl;\n      var imageListCtrl = rootControl.find('#image-list')[0];\n\n      if (imageListCtrl) {\n        imageListCtrl.value(editor.convertURL(control.value(), 'src'));\n      }\n\n      global$2.each(meta, function (value, key) {\n        rootControl.find('#' + key).value(value);\n      });\n\n      if (!meta.width && !meta.height) {\n        srcURL = editor.convertURL(control.value(), 'src');\n        prependURL = $_cwfv1xctjnlpb19i.getPrependUrl(editor);\n        absoluteURLPattern = new RegExp('^(?:[a-z]+:)?//', 'i');\n\n        if (prependURL && !absoluteURLPattern.test(srcURL) && srcURL.substring(0, prependURL.length) !== prependURL) {\n          srcURL = prependURL + srcURL;\n        }\n\n        control.value(srcURL);\n        $_c1uzycujnlpb19l.getImageSize(editor.documentBaseURI.toAbsolute(control.value()), function (data) {\n          if (data.width && data.height && $_cwfv1xctjnlpb19i.hasDimensions(editor)) {\n            rootControl.find('#width').value(data.width);\n            rootControl.find('#height').value(data.height);\n            $_dk9flrdajnlpb1bd.syncSize(rootControl);\n          }\n        });\n      }\n    };\n\n    var onBeforeCall = function (evt) {\n      evt.meta = evt.control.rootControl.toJSON();\n    };\n\n    var getGeneralItems = function (editor, imageListCtrl) {\n      var generalFormItems = [{\n        name: 'src',\n        type: 'filepicker',\n        filetype: 'image',\n        label: 'Source',\n        autofocus: true,\n        onchange: function (evt) {\n          onSrcChange(evt, editor);\n        },\n        onbeforecall: onBeforeCall\n      }, imageListCtrl];\n\n      if ($_cwfv1xctjnlpb19i.hasDescription(editor)) {\n        generalFormItems.push({\n          name: 'alt',\n          type: 'textbox',\n          label: 'Image description'\n        });\n      }\n\n      if ($_cwfv1xctjnlpb19i.hasImageTitle(editor)) {\n        generalFormItems.push({\n          name: 'title',\n          type: 'textbox',\n          label: 'Image Title'\n        });\n      }\n\n      if ($_cwfv1xctjnlpb19i.hasDimensions(editor)) {\n        generalFormItems.push($_dk9flrdajnlpb1bd.createUi());\n      }\n\n      if ($_cwfv1xctjnlpb19i.getClassList(editor)) {\n        generalFormItems.push({\n          name: 'class',\n          type: 'listbox',\n          label: 'Class',\n          values: $_c1uzycujnlpb19l.buildListItems($_cwfv1xctjnlpb19i.getClassList(editor), function (item) {\n            if (item.value) {\n              item.textStyle = function () {\n                return editor.formatter.getCssText({\n                  inline: 'img',\n                  classes: [item.value]\n                });\n              };\n            }\n          })\n        });\n      }\n\n      if ($_cwfv1xctjnlpb19i.hasImageCaption(editor)) {\n        generalFormItems.push({\n          name: 'caption',\n          type: 'checkbox',\n          label: 'Caption'\n        });\n      }\n\n      return generalFormItems;\n    };\n\n    var makeTab$1 = function (editor, imageListCtrl) {\n      return {\n        title: 'General',\n        type: 'form',\n        items: getGeneralItems(editor, imageListCtrl)\n      };\n    };\n\n    var $_1uv9q4d9jnlpb1ba = {\n      makeTab: makeTab$1,\n      getGeneralItems: getGeneralItems\n    };\n\n    var url = function () {\n      return $_4q4g1acwjnlpb19s.getOrDie('URL');\n    };\n\n    var createObjectURL = function (blob) {\n      return url().createObjectURL(blob);\n    };\n\n    var revokeObjectURL = function (u) {\n      url().revokeObjectURL(u);\n    };\n\n    var $_9a12jidcjnlpb1bk = {\n      createObjectURL: createObjectURL,\n      revokeObjectURL: revokeObjectURL\n    };\n    var global$5 = tinymce.util.Tools.resolve('tinymce.ui.Factory');\n\n    function XMLHttpRequest() {\n      var f = $_4q4g1acwjnlpb19s.getOrDie('XMLHttpRequest');\n      return new f();\n    }\n\n    var noop = function () {};\n\n    var pathJoin = function (path1, path2) {\n      if (path1) {\n        return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n      }\n\n      return path2;\n    };\n\n    function Uploader(settings) {\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr, formData;\n        xhr = XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n\n        xhr.onload = function () {\n          var json;\n\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n\n          json = JSON.parse(xhr.responseText);\n\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n\n          success(pathJoin(settings.basePath, json.location));\n        };\n\n        formData = new FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n\n      var uploadBlob = function (blobInfo, handler) {\n        return new global$1(function (resolve, reject) {\n          try {\n            handler(blobInfo, resolve, reject, noop);\n          } catch (ex) {\n            reject(ex.message);\n          }\n        });\n      };\n\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n\n      var upload = function (blobInfo) {\n        return !settings.url && isDefaultHandler(settings.handler) ? global$1.reject('Upload url missing from the settings.') : uploadBlob(blobInfo, settings.handler);\n      };\n\n      settings = global$2.extend({\n        credentials: false,\n        handler: defaultHandler\n      }, settings);\n      return {\n        upload: upload\n      };\n    }\n\n    var onFileInput = function (editor) {\n      return function (evt) {\n        var Throbber = global$5.get('Throbber');\n        var rootControl = evt.control.rootControl;\n        var throbber = new Throbber(rootControl.getEl());\n        var file = evt.control.value();\n        var blobUri = $_9a12jidcjnlpb1bk.createObjectURL(file);\n        var uploader = Uploader({\n          url: $_cwfv1xctjnlpb19i.getUploadUrl(editor),\n          basePath: $_cwfv1xctjnlpb19i.getUploadBasePath(editor),\n          credentials: $_cwfv1xctjnlpb19i.getUploadCredentials(editor),\n          handler: $_cwfv1xctjnlpb19i.getUploadHandler(editor)\n        });\n\n        var finalize = function () {\n          throbber.hide();\n          $_9a12jidcjnlpb1bk.revokeObjectURL(blobUri);\n        };\n\n        throbber.show();\n        return $_c1uzycujnlpb19l.blobToDataUri(file).then(function (dataUrl) {\n          var blobInfo = editor.editorUpload.blobCache.create({\n            blob: file,\n            blobUri: blobUri,\n            name: file.name ? file.name.replace(/\\.[^\\.]+$/, '') : null,\n            base64: dataUrl.split(',')[1]\n          });\n          return uploader.upload(blobInfo).then(function (url) {\n            var src = rootControl.find('#src');\n            src.value(url);\n            rootControl.find('tabpanel')[0].activateTab(0);\n            src.fire('change');\n            finalize();\n            return url;\n          });\n        }).catch(function (err) {\n          editor.windowManager.alert(err);\n          finalize();\n        });\n      };\n    };\n\n    var acceptExts = '.jpg,.jpeg,.png,.gif';\n\n    var makeTab$2 = function (editor) {\n      return {\n        title: 'Upload',\n        type: 'form',\n        layout: 'flex',\n        direction: 'column',\n        align: 'stretch',\n        padding: '20 20 20 20',\n        items: [{\n          type: 'container',\n          layout: 'flex',\n          direction: 'column',\n          align: 'center',\n          spacing: 10,\n          items: [{\n            text: 'Browse for an image',\n            type: 'browsebutton',\n            accept: acceptExts,\n            onchange: onFileInput(editor)\n          }, {\n            text: 'OR',\n            type: 'label'\n          }]\n        }, {\n          text: 'Drop an image here',\n          type: 'dropzone',\n          accept: acceptExts,\n          height: 100,\n          onchange: onFileInput(editor)\n        }]\n      };\n    };\n\n    var $_bsie2ndbjnlpb1bg = {\n      makeTab: makeTab$2\n    };\n\n    var curry = function (f) {\n      var x = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n\n      var args = new Array(arguments.length - 1);\n\n      for (var i = 1; i < arguments.length; i++) args[i - 1] = arguments[i];\n\n      return function () {\n        var x = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          x[_i] = arguments[_i];\n        }\n\n        var newArgs = new Array(arguments.length);\n\n        for (var j = 0; j < newArgs.length; j++) newArgs[j] = arguments[j];\n\n        var all = args.concat(newArgs);\n        return f.apply(null, all);\n      };\n    };\n\n    var submitForm = function (editor, evt) {\n      var win = evt.control.getRoot();\n      $_dk9flrdajnlpb1bd.updateSize(win);\n      editor.undoManager.transact(function () {\n        var data = merge(readImageDataFromSelection(editor), win.toJSON());\n        insertOrUpdateImage(editor, data);\n      });\n      editor.editorUpload.uploadImagesAuto();\n    };\n\n    function Dialog(editor) {\n      function showDialog(imageList) {\n        var data = readImageDataFromSelection(editor);\n        var win, imageListCtrl;\n\n        if (imageList) {\n          imageListCtrl = {\n            type: 'listbox',\n            label: 'Image list',\n            name: 'image-list',\n            values: $_c1uzycujnlpb19l.buildListItems(imageList, function (item) {\n              item.value = editor.convertURL(item.value || item.url, 'src');\n            }, [{\n              text: 'None',\n              value: ''\n            }]),\n            value: data.src && editor.convertURL(data.src, 'src'),\n            onselect: function (e) {\n              var altCtrl = win.find('#alt');\n\n              if (!altCtrl.value() || e.lastControl && altCtrl.value() === e.lastControl.text()) {\n                altCtrl.value(e.control.text());\n              }\n\n              win.find('#src').value(e.control.value()).fire('change');\n            },\n            onPostRender: function () {\n              imageListCtrl = this;\n            }\n          };\n        }\n\n        if ($_cwfv1xctjnlpb19i.hasAdvTab(editor) || $_cwfv1xctjnlpb19i.hasUploadUrl(editor) || $_cwfv1xctjnlpb19i.hasUploadHandler(editor)) {\n          var body = [$_1uv9q4d9jnlpb1ba.makeTab(editor, imageListCtrl)];\n\n          if ($_cwfv1xctjnlpb19i.hasAdvTab(editor)) {\n            body.push($_cdolkdd3jnlpb1ag.makeTab(editor));\n          }\n\n          if ($_cwfv1xctjnlpb19i.hasUploadUrl(editor) || $_cwfv1xctjnlpb19i.hasUploadHandler(editor)) {\n            body.push($_bsie2ndbjnlpb1bg.makeTab(editor));\n          }\n\n          win = editor.windowManager.open({\n            title: 'Insert/edit image',\n            data: data,\n            bodyType: 'tabpanel',\n            body: body,\n            onSubmit: curry(submitForm, editor)\n          });\n        } else {\n          win = editor.windowManager.open({\n            title: 'Insert/edit image',\n            data: data,\n            body: $_1uv9q4d9jnlpb1ba.getGeneralItems(editor, imageListCtrl),\n            onSubmit: curry(submitForm, editor)\n          });\n        }\n\n        $_dk9flrdajnlpb1bd.syncSize(win);\n      }\n\n      function open() {\n        $_c1uzycujnlpb19l.createImageList(editor, showDialog);\n      }\n\n      return {\n        open: open\n      };\n    }\n\n    var register = function (editor) {\n      editor.addCommand('mceImage', Dialog(editor).open);\n    };\n\n    var $_jjmdwcrjnlpb19a = {\n      register: register\n    };\n\n    var hasImageClass = function (node) {\n      var className = node.attr('class');\n      return className && /\\bimage\\b/.test(className);\n    };\n\n    var toggleContentEditableState = function (state) {\n      return function (nodes) {\n        var i = nodes.length,\n            node;\n\n        var toggleContentEditable = function (node) {\n          node.attr('contenteditable', state ? 'true' : null);\n        };\n\n        while (i--) {\n          node = nodes[i];\n\n          if (hasImageClass(node)) {\n            node.attr('contenteditable', state ? 'false' : null);\n            global$2.each(node.getAll('figcaption'), toggleContentEditable);\n          }\n        }\n      };\n    };\n\n    var setup = function (editor) {\n      editor.on('preInit', function () {\n        editor.parser.addNodeFilter('figure', toggleContentEditableState(true));\n        editor.serializer.addNodeFilter('figure', toggleContentEditableState(false));\n      });\n    };\n\n    var $_e9m3rqdhjnlpb1bu = {\n      setup: setup\n    };\n\n    var register$1 = function (editor) {\n      editor.addButton('image', {\n        icon: 'image',\n        tooltip: 'Insert/edit image',\n        onclick: Dialog(editor).open,\n        stateSelector: 'img:not([data-mce-object],[data-mce-placeholder]),figure.image'\n      });\n      editor.addMenuItem('image', {\n        icon: 'image',\n        text: 'Image',\n        onclick: Dialog(editor).open,\n        context: 'insert',\n        prependToContext: true\n      });\n    };\n\n    var $_7nkb3cdijnlpb1bw = {\n      register: register$1\n    };\n    global.add('image', function (editor) {\n      $_e9m3rqdhjnlpb1bu.setup(editor);\n      $_7nkb3cdijnlpb1bw.register(editor);\n      $_jjmdwcrjnlpb19a.register(editor);\n    });\n\n    function Plugin() {}\n\n    return Plugin;\n  }();\n})();",{"version":3,"sources":["/Users/shanliguo/Documents/workstudy/vue-form-making/src/lib/tinymce/plugins/image/plugin.js"],"names":["image","global","tinymce","util","Tools","resolve","hasDimensions","editor","settings","image_dimensions","hasAdvTab","image_advtab","getPrependUrl","getParam","getClassList","hasDescription","image_description","hasImageTitle","image_title","hasImageCaption","image_caption","getImageList","hasUploadUrl","hasUploadHandler","getUploadUrl","getUploadHandler","getUploadBasePath","getUploadCredentials","$_cwfv1xctjnlpb19i","Global","window","Function","path","parts","scope","o","undefined","i","length","p","split","unsafe","name","getOrDie","actual","$_4q4g1acwjnlpb19s","FileReader","f","global$1","global$2","global$3","parseIntAndGetMax","val1","val2","Math","max","parseInt","getImageSize","url","callback","img","document","createElement","done","width","height","parentNode","removeChild","onload","clientWidth","clientHeight","onerror","style","visibility","position","bottom","left","body","appendChild","src","buildListItems","inputList","itemCallback","startItems","appendItems","values","output","each","item","menuItem","text","title","menu","value","push","removePixelSuffix","replace","addPixelSuffix","test","mergeMargins","css","margin","splitMargin","createImageList","imageList","send","success","JSON","parse","waitLoadImage","data","imgElm","selectImage","selection","select","nodeChanged","dom","setAttribs","blobToDataUri","blob","reject","reader","result","error","message","readAsDataURL","$_c1uzycujnlpb19l","global$4","hasOwnProperty","Object","prototype","shallow","old","nu","baseMerge","merger","objects","Array","arguments","Error","ret","j","curObject","key","call","merge","DOM","getHspace","marginLeft","marginRight","getVspace","marginTop","marginBottom","getBorder","borderWidth","getAttrib","name$$1","hasAttribute","getAttribute","getStyle","hasCaption","nodeName","setAttrib","setAttribute","wrapInFigure","figureElm","create","class","insertAfter","contentEditable","removeFigure","remove","toggleCaption","normalizeStyle","normalizeCss","attrValue","removeAttribute","setSize","getSize","setHspace","pxValue","setVspace","setBorder","setBorderStyle","borderStyle","getBorderStyle","isFigure","elm","defaultData","alt","caption","hspace","vspace","border","getStyleValue","write","figure","read","updateProp","oldData","newData","set","normalized","_name","_value","cssText","styles","mergedCss","compressed","serialize","getSelectedImage","getNode","getParent","splitTextBlock","textBlock","node","schema","getTextBlockElements","readImageDataFromSelection","insertImageAtCaret","focus","setContent","outerHTML","insertedElm","syncSrcAttr","deleteImage","is","isEmpty","getBody","setCursorLocation","writeImageDataToSelection","insertOrUpdateImage","updateVSpaceHSpaceBorder","evt","rootControl","control","toJSON","parseStyle","find","serializeStyle","updateStyle","win","ctrl","makeTab","type","pack","items","label","onchange","layout","packV","columns","padding","defaults","maxWidth","onselect","$_cdolkdd3jnlpb1ag","doSyncSize","widthCtrl","heightCtrl","state","doSizeControls","constrained","checked","doUpdateSize","isContrained","oldWidth","get","oldHeight","newWidth","newHeight","round","isNaN","syncSize","updateSize","createUi","recalcSize","align","spacing","maxLength","size","ariaLabel","$_dk9flrdajnlpb1bd","onSrcChange","srcURL","prependURL","absoluteURLPattern","meta","imageListCtrl","convertURL","RegExp","substring","documentBaseURI","toAbsolute","onBeforeCall","getGeneralItems","generalFormItems","filetype","autofocus","onbeforecall","textStyle","formatter","getCssText","inline","classes","makeTab$1","$_1uv9q4d9jnlpb1ba","createObjectURL","revokeObjectURL","u","$_9a12jidcjnlpb1bk","global$5","XMLHttpRequest","noop","pathJoin","path1","path2","Uploader","defaultHandler","blobInfo","failure","progress","xhr","formData","open","withCredentials","credentials","upload","onprogress","e","loaded","total","status","json","responseText","location","basePath","FormData","append","filename","uploadBlob","handler","ex","isDefaultHandler","extend","onFileInput","Throbber","throbber","getEl","file","blobUri","uploader","finalize","hide","show","then","dataUrl","editorUpload","blobCache","base64","activateTab","fire","catch","err","windowManager","alert","acceptExts","makeTab$2","direction","accept","$_bsie2ndbjnlpb1bg","curry","x","_i","args","newArgs","all","concat","apply","submitForm","getRoot","undoManager","transact","uploadImagesAuto","Dialog","showDialog","altCtrl","lastControl","onPostRender","bodyType","onSubmit","register","addCommand","$_jjmdwcrjnlpb19a","hasImageClass","className","attr","toggleContentEditableState","nodes","toggleContentEditable","getAll","setup","on","parser","addNodeFilter","serializer","$_e9m3rqdhjnlpb1bu","register$1","addButton","icon","tooltip","onclick","stateSelector","addMenuItem","context","prependToContext","$_7nkb3cdijnlpb1bw","add","Plugin"],"mappings":"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","sourcesContent":["(function () {\nvar image = (function () {\n  'use strict';\n\n  var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var hasDimensions = function (editor) {\n    return editor.settings.image_dimensions === false ? false : true;\n  };\n  var hasAdvTab = function (editor) {\n    return editor.settings.image_advtab === true ? true : false;\n  };\n  var getPrependUrl = function (editor) {\n    return editor.getParam('image_prepend_url', '');\n  };\n  var getClassList = function (editor) {\n    return editor.getParam('image_class_list');\n  };\n  var hasDescription = function (editor) {\n    return editor.settings.image_description === false ? false : true;\n  };\n  var hasImageTitle = function (editor) {\n    return editor.settings.image_title === true ? true : false;\n  };\n  var hasImageCaption = function (editor) {\n    return editor.settings.image_caption === true ? true : false;\n  };\n  var getImageList = function (editor) {\n    return editor.getParam('image_list', false);\n  };\n  var hasUploadUrl = function (editor) {\n    return editor.getParam('images_upload_url', false);\n  };\n  var hasUploadHandler = function (editor) {\n    return editor.getParam('images_upload_handler', false);\n  };\n  var getUploadUrl = function (editor) {\n    return editor.getParam('images_upload_url');\n  };\n  var getUploadHandler = function (editor) {\n    return editor.getParam('images_upload_handler');\n  };\n  var getUploadBasePath = function (editor) {\n    return editor.getParam('images_upload_base_path');\n  };\n  var getUploadCredentials = function (editor) {\n    return editor.getParam('images_upload_credentials');\n  };\n  var $_cwfv1xctjnlpb19i = {\n    hasDimensions: hasDimensions,\n    hasAdvTab: hasAdvTab,\n    getPrependUrl: getPrependUrl,\n    getClassList: getClassList,\n    hasDescription: hasDescription,\n    hasImageTitle: hasImageTitle,\n    hasImageCaption: hasImageCaption,\n    getImageList: getImageList,\n    hasUploadUrl: hasUploadUrl,\n    hasUploadHandler: hasUploadHandler,\n    getUploadUrl: getUploadUrl,\n    getUploadHandler: getUploadHandler,\n    getUploadBasePath: getUploadBasePath,\n    getUploadCredentials: getUploadCredentials\n  };\n\n  var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n  var path = function (parts, scope) {\n    var o = scope !== undefined && scope !== null ? scope : Global;\n    for (var i = 0; i < parts.length && o !== undefined && o !== null; ++i)\n      o = o[parts[i]];\n    return o;\n  };\n  var resolve = function (p, scope) {\n    var parts = p.split('.');\n    return path(parts, scope);\n  };\n\n  var unsafe = function (name, scope) {\n    return resolve(name, scope);\n  };\n  var getOrDie = function (name, scope) {\n    var actual = unsafe(name, scope);\n    if (actual === undefined || actual === null)\n      throw name + ' not available on this browser';\n    return actual;\n  };\n  var $_4q4g1acwjnlpb19s = { getOrDie: getOrDie };\n\n  function FileReader () {\n    var f = $_4q4g1acwjnlpb19s.getOrDie('FileReader');\n    return new f();\n  }\n\n  var global$1 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n  var global$2 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var global$3 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n  var parseIntAndGetMax = function (val1, val2) {\n    return Math.max(parseInt(val1, 10), parseInt(val2, 10));\n  };\n  var getImageSize = function (url, callback) {\n    var img = document.createElement('img');\n    function done(width, height) {\n      if (img.parentNode) {\n        img.parentNode.removeChild(img);\n      }\n      callback({\n        width: width,\n        height: height\n      });\n    }\n    img.onload = function () {\n      var width = parseIntAndGetMax(img.width, img.clientWidth);\n      var height = parseIntAndGetMax(img.height, img.clientHeight);\n      done(width, height);\n    };\n    img.onerror = function () {\n      done(0, 0);\n    };\n    var style = img.style;\n    style.visibility = 'hidden';\n    style.position = 'fixed';\n    style.bottom = style.left = '0px';\n    style.width = style.height = 'auto';\n    document.body.appendChild(img);\n    img.src = url;\n  };\n  var buildListItems = function (inputList, itemCallback, startItems) {\n    function appendItems(values, output) {\n      output = output || [];\n      global$2.each(values, function (item) {\n        var menuItem = { text: item.text || item.title };\n        if (item.menu) {\n          menuItem.menu = appendItems(item.menu);\n        } else {\n          menuItem.value = item.value;\n          itemCallback(menuItem);\n        }\n        output.push(menuItem);\n      });\n      return output;\n    }\n    return appendItems(inputList, startItems || []);\n  };\n  var removePixelSuffix = function (value) {\n    if (value) {\n      value = value.replace(/px$/, '');\n    }\n    return value;\n  };\n  var addPixelSuffix = function (value) {\n    if (value.length > 0 && /^[0-9]+$/.test(value)) {\n      value += 'px';\n    }\n    return value;\n  };\n  var mergeMargins = function (css) {\n    if (css.margin) {\n      var splitMargin = css.margin.split(' ');\n      switch (splitMargin.length) {\n      case 1:\n        css['margin-top'] = css['margin-top'] || splitMargin[0];\n        css['margin-right'] = css['margin-right'] || splitMargin[0];\n        css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n        css['margin-left'] = css['margin-left'] || splitMargin[0];\n        break;\n      case 2:\n        css['margin-top'] = css['margin-top'] || splitMargin[0];\n        css['margin-right'] = css['margin-right'] || splitMargin[1];\n        css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n        css['margin-left'] = css['margin-left'] || splitMargin[1];\n        break;\n      case 3:\n        css['margin-top'] = css['margin-top'] || splitMargin[0];\n        css['margin-right'] = css['margin-right'] || splitMargin[1];\n        css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n        css['margin-left'] = css['margin-left'] || splitMargin[1];\n        break;\n      case 4:\n        css['margin-top'] = css['margin-top'] || splitMargin[0];\n        css['margin-right'] = css['margin-right'] || splitMargin[1];\n        css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n        css['margin-left'] = css['margin-left'] || splitMargin[3];\n      }\n      delete css.margin;\n    }\n    return css;\n  };\n  var createImageList = function (editor, callback) {\n    var imageList = $_cwfv1xctjnlpb19i.getImageList(editor);\n    if (typeof imageList === 'string') {\n      global$3.send({\n        url: imageList,\n        success: function (text) {\n          callback(JSON.parse(text));\n        }\n      });\n    } else if (typeof imageList === 'function') {\n      imageList(callback);\n    } else {\n      callback(imageList);\n    }\n  };\n  var waitLoadImage = function (editor, data, imgElm) {\n    function selectImage() {\n      imgElm.onload = imgElm.onerror = null;\n      if (editor.selection) {\n        editor.selection.select(imgElm);\n        editor.nodeChanged();\n      }\n    }\n    imgElm.onload = function () {\n      if (!data.width && !data.height && $_cwfv1xctjnlpb19i.hasDimensions(editor)) {\n        editor.dom.setAttribs(imgElm, {\n          width: imgElm.clientWidth,\n          height: imgElm.clientHeight\n        });\n      }\n      selectImage();\n    };\n    imgElm.onerror = selectImage;\n  };\n  var blobToDataUri = function (blob) {\n    return new global$1(function (resolve, reject) {\n      var reader = FileReader();\n      reader.onload = function () {\n        resolve(reader.result);\n      };\n      reader.onerror = function () {\n        reject(reader.error.message);\n      };\n      reader.readAsDataURL(blob);\n    });\n  };\n  var $_c1uzycujnlpb19l = {\n    getImageSize: getImageSize,\n    buildListItems: buildListItems,\n    removePixelSuffix: removePixelSuffix,\n    addPixelSuffix: addPixelSuffix,\n    mergeMargins: mergeMargins,\n    createImageList: createImageList,\n    waitLoadImage: waitLoadImage,\n    blobToDataUri: blobToDataUri\n  };\n\n  var global$4 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  var shallow = function (old, nu) {\n    return nu;\n  };\n  var baseMerge = function (merger) {\n    return function () {\n      var objects = new Array(arguments.length);\n      for (var i = 0; i < objects.length; i++)\n        objects[i] = arguments[i];\n      if (objects.length === 0)\n        throw new Error('Can\\'t merge zero objects');\n      var ret = {};\n      for (var j = 0; j < objects.length; j++) {\n        var curObject = objects[j];\n        for (var key in curObject)\n          if (hasOwnProperty.call(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n      }\n      return ret;\n    };\n  };\n\n  var merge = baseMerge(shallow);\n\n  var DOM = global$4.DOM;\n  var getHspace = function (image) {\n    if (image.style.marginLeft && image.style.marginRight && image.style.marginLeft === image.style.marginRight) {\n      return $_c1uzycujnlpb19l.removePixelSuffix(image.style.marginLeft);\n    } else {\n      return '';\n    }\n  };\n  var getVspace = function (image) {\n    if (image.style.marginTop && image.style.marginBottom && image.style.marginTop === image.style.marginBottom) {\n      return $_c1uzycujnlpb19l.removePixelSuffix(image.style.marginTop);\n    } else {\n      return '';\n    }\n  };\n  var getBorder = function (image) {\n    if (image.style.borderWidth) {\n      return $_c1uzycujnlpb19l.removePixelSuffix(image.style.borderWidth);\n    } else {\n      return '';\n    }\n  };\n  var getAttrib = function (image, name$$1) {\n    if (image.hasAttribute(name$$1)) {\n      return image.getAttribute(name$$1);\n    } else {\n      return '';\n    }\n  };\n  var getStyle = function (image, name$$1) {\n    return image.style[name$$1] ? image.style[name$$1] : '';\n  };\n  var hasCaption = function (image) {\n    return image.parentNode !== null && image.parentNode.nodeName === 'FIGURE';\n  };\n  var setAttrib = function (image, name$$1, value) {\n    image.setAttribute(name$$1, value);\n  };\n  var wrapInFigure = function (image) {\n    var figureElm = DOM.create('figure', { class: 'image' });\n    DOM.insertAfter(figureElm, image);\n    figureElm.appendChild(image);\n    figureElm.appendChild(DOM.create('figcaption', { contentEditable: true }, 'Caption'));\n    figureElm.contentEditable = 'false';\n  };\n  var removeFigure = function (image) {\n    var figureElm = image.parentNode;\n    DOM.insertAfter(image, figureElm);\n    DOM.remove(figureElm);\n  };\n  var toggleCaption = function (image) {\n    if (hasCaption(image)) {\n      removeFigure(image);\n    } else {\n      wrapInFigure(image);\n    }\n  };\n  var normalizeStyle = function (image, normalizeCss) {\n    var attrValue = image.getAttribute('style');\n    var value = normalizeCss(attrValue !== null ? attrValue : '');\n    if (value.length > 0) {\n      image.setAttribute('style', value);\n      image.setAttribute('data-mce-style', value);\n    } else {\n      image.removeAttribute('style');\n    }\n  };\n  var setSize = function (name$$1, normalizeCss) {\n    return function (image, name$$1, value) {\n      if (image.style[name$$1]) {\n        image.style[name$$1] = $_c1uzycujnlpb19l.addPixelSuffix(value);\n        normalizeStyle(image, normalizeCss);\n      } else {\n        setAttrib(image, name$$1, value);\n      }\n    };\n  };\n  var getSize = function (image, name$$1) {\n    if (image.style[name$$1]) {\n      return $_c1uzycujnlpb19l.removePixelSuffix(image.style[name$$1]);\n    } else {\n      return getAttrib(image, name$$1);\n    }\n  };\n  var setHspace = function (image, value) {\n    var pxValue = $_c1uzycujnlpb19l.addPixelSuffix(value);\n    image.style.marginLeft = pxValue;\n    image.style.marginRight = pxValue;\n  };\n  var setVspace = function (image, value) {\n    var pxValue = $_c1uzycujnlpb19l.addPixelSuffix(value);\n    image.style.marginTop = pxValue;\n    image.style.marginBottom = pxValue;\n  };\n  var setBorder = function (image, value) {\n    var pxValue = $_c1uzycujnlpb19l.addPixelSuffix(value);\n    image.style.borderWidth = pxValue;\n  };\n  var setBorderStyle = function (image, value) {\n    image.style.borderStyle = value;\n  };\n  var getBorderStyle = function (image) {\n    return getStyle(image, 'borderStyle');\n  };\n  var isFigure = function (elm) {\n    return elm.nodeName === 'FIGURE';\n  };\n  var defaultData = function () {\n    return {\n      src: '',\n      alt: '',\n      title: '',\n      width: '',\n      height: '',\n      class: '',\n      style: '',\n      caption: false,\n      hspace: '',\n      vspace: '',\n      border: '',\n      borderStyle: ''\n    };\n  };\n  var getStyleValue = function (normalizeCss, data) {\n    var image = document.createElement('img');\n    setAttrib(image, 'style', data.style);\n    if (getHspace(image) || data.hspace !== '') {\n      setHspace(image, data.hspace);\n    }\n    if (getVspace(image) || data.vspace !== '') {\n      setVspace(image, data.vspace);\n    }\n    if (getBorder(image) || data.border !== '') {\n      setBorder(image, data.border);\n    }\n    if (getBorderStyle(image) || data.borderStyle !== '') {\n      setBorderStyle(image, data.borderStyle);\n    }\n    return normalizeCss(image.getAttribute('style'));\n  };\n  var create = function (normalizeCss, data) {\n    var image = document.createElement('img');\n    write(normalizeCss, merge(data, { caption: false }), image);\n    setAttrib(image, 'alt', data.alt);\n    if (data.caption) {\n      var figure = DOM.create('figure', { class: 'image' });\n      figure.appendChild(image);\n      figure.appendChild(DOM.create('figcaption', { contentEditable: true }, 'Caption'));\n      figure.contentEditable = 'false';\n      return figure;\n    } else {\n      return image;\n    }\n  };\n  var read = function (normalizeCss, image) {\n    return {\n      src: getAttrib(image, 'src'),\n      alt: getAttrib(image, 'alt'),\n      title: getAttrib(image, 'title'),\n      width: getSize(image, 'width'),\n      height: getSize(image, 'height'),\n      class: getAttrib(image, 'class'),\n      style: normalizeCss(getAttrib(image, 'style')),\n      caption: hasCaption(image),\n      hspace: getHspace(image),\n      vspace: getVspace(image),\n      border: getBorder(image),\n      borderStyle: getStyle(image, 'borderStyle')\n    };\n  };\n  var updateProp = function (image, oldData, newData, name$$1, set) {\n    if (newData[name$$1] !== oldData[name$$1]) {\n      set(image, name$$1, newData[name$$1]);\n    }\n  };\n  var normalized = function (set, normalizeCss) {\n    return function (image, name$$1, value) {\n      set(image, value);\n      normalizeStyle(image, normalizeCss);\n    };\n  };\n  var write = function (normalizeCss, newData, image) {\n    var oldData = read(normalizeCss, image);\n    updateProp(image, oldData, newData, 'caption', function (image, _name, _value) {\n      return toggleCaption(image);\n    });\n    updateProp(image, oldData, newData, 'src', setAttrib);\n    updateProp(image, oldData, newData, 'alt', setAttrib);\n    updateProp(image, oldData, newData, 'title', setAttrib);\n    updateProp(image, oldData, newData, 'width', setSize('width', normalizeCss));\n    updateProp(image, oldData, newData, 'height', setSize('height', normalizeCss));\n    updateProp(image, oldData, newData, 'class', setAttrib);\n    updateProp(image, oldData, newData, 'style', normalized(function (image, value) {\n      return setAttrib(image, 'style', value);\n    }, normalizeCss));\n    updateProp(image, oldData, newData, 'hspace', normalized(setHspace, normalizeCss));\n    updateProp(image, oldData, newData, 'vspace', normalized(setVspace, normalizeCss));\n    updateProp(image, oldData, newData, 'border', normalized(setBorder, normalizeCss));\n    updateProp(image, oldData, newData, 'borderStyle', normalized(setBorderStyle, normalizeCss));\n  };\n\n  var normalizeCss = function (editor, cssText) {\n    var css = editor.dom.styles.parse(cssText);\n    var mergedCss = $_c1uzycujnlpb19l.mergeMargins(css);\n    var compressed = editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));\n    return editor.dom.styles.serialize(compressed);\n  };\n  var getSelectedImage = function (editor) {\n    var imgElm = editor.selection.getNode();\n    var figureElm = editor.dom.getParent(imgElm, 'figure.image');\n    if (figureElm) {\n      return editor.dom.select('img', figureElm)[0];\n    }\n    if (imgElm && (imgElm.nodeName !== 'IMG' || imgElm.getAttribute('data-mce-object') || imgElm.getAttribute('data-mce-placeholder'))) {\n      return null;\n    }\n    return imgElm;\n  };\n  var splitTextBlock = function (editor, figure) {\n    var dom = editor.dom;\n    var textBlock = dom.getParent(figure.parentNode, function (node) {\n      return editor.schema.getTextBlockElements()[node.nodeName];\n    });\n    if (textBlock) {\n      return dom.split(textBlock, figure);\n    } else {\n      return figure;\n    }\n  };\n  var readImageDataFromSelection = function (editor) {\n    var image = getSelectedImage(editor);\n    return image ? read(function (css) {\n      return normalizeCss(editor, css);\n    }, image) : defaultData();\n  };\n  var insertImageAtCaret = function (editor, data) {\n    var elm = create(function (css) {\n      return normalizeCss(editor, css);\n    }, data);\n    editor.dom.setAttrib(elm, 'data-mce-id', '__mcenew');\n    editor.focus();\n    editor.selection.setContent(elm.outerHTML);\n    var insertedElm = editor.dom.select('*[data-mce-id=\"__mcenew\"]')[0];\n    editor.dom.setAttrib(insertedElm, 'data-mce-id', null);\n    if (isFigure(insertedElm)) {\n      var figure = splitTextBlock(editor, insertedElm);\n      editor.selection.select(figure);\n    } else {\n      editor.selection.select(insertedElm);\n    }\n  };\n  var syncSrcAttr = function (editor, image) {\n    editor.dom.setAttrib(image, 'src', image.getAttribute('src'));\n  };\n  var deleteImage = function (editor, image) {\n    if (image) {\n      var elm = editor.dom.is(image.parentNode, 'figure.image') ? image.parentNode : image;\n      editor.dom.remove(elm);\n      editor.focus();\n      editor.nodeChanged();\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        editor.selection.setCursorLocation();\n      }\n    }\n  };\n  var writeImageDataToSelection = function (editor, data) {\n    var image = getSelectedImage(editor);\n    write(function (css) {\n      return normalizeCss(editor, css);\n    }, data, image);\n    syncSrcAttr(editor, image);\n    if (isFigure(image.parentNode)) {\n      var figure = image.parentNode;\n      splitTextBlock(editor, figure);\n      editor.selection.select(image.parentNode);\n    } else {\n      editor.selection.select(image);\n      $_c1uzycujnlpb19l.waitLoadImage(editor, data, image);\n    }\n  };\n  var insertOrUpdateImage = function (editor, data) {\n    var image = getSelectedImage(editor);\n    if (image) {\n      if (data.src) {\n        writeImageDataToSelection(editor, data);\n      } else {\n        deleteImage(editor, image);\n      }\n    } else if (data.src) {\n      insertImageAtCaret(editor, data);\n    }\n  };\n\n  var updateVSpaceHSpaceBorder = function (editor) {\n    return function (evt) {\n      var dom = editor.dom;\n      var rootControl = evt.control.rootControl;\n      if (!$_cwfv1xctjnlpb19i.hasAdvTab(editor)) {\n        return;\n      }\n      var data = rootControl.toJSON();\n      var css = dom.parseStyle(data.style);\n      rootControl.find('#vspace').value('');\n      rootControl.find('#hspace').value('');\n      css = $_c1uzycujnlpb19l.mergeMargins(css);\n      if (css['margin-top'] && css['margin-bottom'] || css['margin-right'] && css['margin-left']) {\n        if (css['margin-top'] === css['margin-bottom']) {\n          rootControl.find('#vspace').value($_c1uzycujnlpb19l.removePixelSuffix(css['margin-top']));\n        } else {\n          rootControl.find('#vspace').value('');\n        }\n        if (css['margin-right'] === css['margin-left']) {\n          rootControl.find('#hspace').value($_c1uzycujnlpb19l.removePixelSuffix(css['margin-right']));\n        } else {\n          rootControl.find('#hspace').value('');\n        }\n      }\n      if (css['border-width']) {\n        rootControl.find('#border').value($_c1uzycujnlpb19l.removePixelSuffix(css['border-width']));\n      } else {\n        rootControl.find('#border').value('');\n      }\n      if (css['border-style']) {\n        rootControl.find('#borderStyle').value(css['border-style']);\n      } else {\n        rootControl.find('#borderStyle').value('');\n      }\n      rootControl.find('#style').value(dom.serializeStyle(dom.parseStyle(dom.serializeStyle(css))));\n    };\n  };\n  var updateStyle = function (editor, win) {\n    win.find('#style').each(function (ctrl) {\n      var value = getStyleValue(function (css) {\n        return normalizeCss(editor, css);\n      }, merge(defaultData(), win.toJSON()));\n      ctrl.value(value);\n    });\n  };\n  var makeTab = function (editor) {\n    return {\n      title: 'Advanced',\n      type: 'form',\n      pack: 'start',\n      items: [\n        {\n          label: 'Style',\n          name: 'style',\n          type: 'textbox',\n          onchange: updateVSpaceHSpaceBorder(editor)\n        },\n        {\n          type: 'form',\n          layout: 'grid',\n          packV: 'start',\n          columns: 2,\n          padding: 0,\n          defaults: {\n            type: 'textbox',\n            maxWidth: 50,\n            onchange: function (evt) {\n              updateStyle(editor, evt.control.rootControl);\n            }\n          },\n          items: [\n            {\n              label: 'Vertical space',\n              name: 'vspace'\n            },\n            {\n              label: 'Border width',\n              name: 'border'\n            },\n            {\n              label: 'Horizontal space',\n              name: 'hspace'\n            },\n            {\n              label: 'Border style',\n              type: 'listbox',\n              name: 'borderStyle',\n              width: 90,\n              maxWidth: 90,\n              onselect: function (evt) {\n                updateStyle(editor, evt.control.rootControl);\n              },\n              values: [\n                {\n                  text: 'Select...',\n                  value: ''\n                },\n                {\n                  text: 'Solid',\n                  value: 'solid'\n                },\n                {\n                  text: 'Dotted',\n                  value: 'dotted'\n                },\n                {\n                  text: 'Dashed',\n                  value: 'dashed'\n                },\n                {\n                  text: 'Double',\n                  value: 'double'\n                },\n                {\n                  text: 'Groove',\n                  value: 'groove'\n                },\n                {\n                  text: 'Ridge',\n                  value: 'ridge'\n                },\n                {\n                  text: 'Inset',\n                  value: 'inset'\n                },\n                {\n                  text: 'Outset',\n                  value: 'outset'\n                },\n                {\n                  text: 'None',\n                  value: 'none'\n                },\n                {\n                  text: 'Hidden',\n                  value: 'hidden'\n                }\n              ]\n            }\n          ]\n        }\n      ]\n    };\n  };\n  var $_cdolkdd3jnlpb1ag = { makeTab: makeTab };\n\n  var doSyncSize = function (widthCtrl, heightCtrl) {\n    widthCtrl.state.set('oldVal', widthCtrl.value());\n    heightCtrl.state.set('oldVal', heightCtrl.value());\n  };\n  var doSizeControls = function (win, f) {\n    var widthCtrl = win.find('#width')[0];\n    var heightCtrl = win.find('#height')[0];\n    var constrained = win.find('#constrain')[0];\n    if (widthCtrl && heightCtrl && constrained) {\n      f(widthCtrl, heightCtrl, constrained.checked());\n    }\n  };\n  var doUpdateSize = function (widthCtrl, heightCtrl, isContrained) {\n    var oldWidth = widthCtrl.state.get('oldVal');\n    var oldHeight = heightCtrl.state.get('oldVal');\n    var newWidth = widthCtrl.value();\n    var newHeight = heightCtrl.value();\n    if (isContrained && oldWidth && oldHeight && newWidth && newHeight) {\n      if (newWidth !== oldWidth) {\n        newHeight = Math.round(newWidth / oldWidth * newHeight);\n        if (!isNaN(newHeight)) {\n          heightCtrl.value(newHeight);\n        }\n      } else {\n        newWidth = Math.round(newHeight / oldHeight * newWidth);\n        if (!isNaN(newWidth)) {\n          widthCtrl.value(newWidth);\n        }\n      }\n    }\n    doSyncSize(widthCtrl, heightCtrl);\n  };\n  var syncSize = function (win) {\n    doSizeControls(win, doSyncSize);\n  };\n  var updateSize = function (win) {\n    doSizeControls(win, doUpdateSize);\n  };\n  var createUi = function () {\n    var recalcSize = function (evt) {\n      updateSize(evt.control.rootControl);\n    };\n    return {\n      type: 'container',\n      label: 'Dimensions',\n      layout: 'flex',\n      align: 'center',\n      spacing: 5,\n      items: [\n        {\n          name: 'width',\n          type: 'textbox',\n          maxLength: 5,\n          size: 5,\n          onchange: recalcSize,\n          ariaLabel: 'Width'\n        },\n        {\n          type: 'label',\n          text: 'x'\n        },\n        {\n          name: 'height',\n          type: 'textbox',\n          maxLength: 5,\n          size: 5,\n          onchange: recalcSize,\n          ariaLabel: 'Height'\n        },\n        {\n          name: 'constrain',\n          type: 'checkbox',\n          checked: true,\n          text: 'Constrain proportions'\n        }\n      ]\n    };\n  };\n  var $_dk9flrdajnlpb1bd = {\n    createUi: createUi,\n    syncSize: syncSize,\n    updateSize: updateSize\n  };\n\n  var onSrcChange = function (evt, editor) {\n    var srcURL, prependURL, absoluteURLPattern;\n    var meta = evt.meta || {};\n    var control = evt.control;\n    var rootControl = control.rootControl;\n    var imageListCtrl = rootControl.find('#image-list')[0];\n    if (imageListCtrl) {\n      imageListCtrl.value(editor.convertURL(control.value(), 'src'));\n    }\n    global$2.each(meta, function (value, key) {\n      rootControl.find('#' + key).value(value);\n    });\n    if (!meta.width && !meta.height) {\n      srcURL = editor.convertURL(control.value(), 'src');\n      prependURL = $_cwfv1xctjnlpb19i.getPrependUrl(editor);\n      absoluteURLPattern = new RegExp('^(?:[a-z]+:)?//', 'i');\n      if (prependURL && !absoluteURLPattern.test(srcURL) && srcURL.substring(0, prependURL.length) !== prependURL) {\n        srcURL = prependURL + srcURL;\n      }\n      control.value(srcURL);\n      $_c1uzycujnlpb19l.getImageSize(editor.documentBaseURI.toAbsolute(control.value()), function (data) {\n        if (data.width && data.height && $_cwfv1xctjnlpb19i.hasDimensions(editor)) {\n          rootControl.find('#width').value(data.width);\n          rootControl.find('#height').value(data.height);\n          $_dk9flrdajnlpb1bd.syncSize(rootControl);\n        }\n      });\n    }\n  };\n  var onBeforeCall = function (evt) {\n    evt.meta = evt.control.rootControl.toJSON();\n  };\n  var getGeneralItems = function (editor, imageListCtrl) {\n    var generalFormItems = [\n      {\n        name: 'src',\n        type: 'filepicker',\n        filetype: 'image',\n        label: 'Source',\n        autofocus: true,\n        onchange: function (evt) {\n          onSrcChange(evt, editor);\n        },\n        onbeforecall: onBeforeCall\n      },\n      imageListCtrl\n    ];\n    if ($_cwfv1xctjnlpb19i.hasDescription(editor)) {\n      generalFormItems.push({\n        name: 'alt',\n        type: 'textbox',\n        label: 'Image description'\n      });\n    }\n    if ($_cwfv1xctjnlpb19i.hasImageTitle(editor)) {\n      generalFormItems.push({\n        name: 'title',\n        type: 'textbox',\n        label: 'Image Title'\n      });\n    }\n    if ($_cwfv1xctjnlpb19i.hasDimensions(editor)) {\n      generalFormItems.push($_dk9flrdajnlpb1bd.createUi());\n    }\n    if ($_cwfv1xctjnlpb19i.getClassList(editor)) {\n      generalFormItems.push({\n        name: 'class',\n        type: 'listbox',\n        label: 'Class',\n        values: $_c1uzycujnlpb19l.buildListItems($_cwfv1xctjnlpb19i.getClassList(editor), function (item) {\n          if (item.value) {\n            item.textStyle = function () {\n              return editor.formatter.getCssText({\n                inline: 'img',\n                classes: [item.value]\n              });\n            };\n          }\n        })\n      });\n    }\n    if ($_cwfv1xctjnlpb19i.hasImageCaption(editor)) {\n      generalFormItems.push({\n        name: 'caption',\n        type: 'checkbox',\n        label: 'Caption'\n      });\n    }\n    return generalFormItems;\n  };\n  var makeTab$1 = function (editor, imageListCtrl) {\n    return {\n      title: 'General',\n      type: 'form',\n      items: getGeneralItems(editor, imageListCtrl)\n    };\n  };\n  var $_1uv9q4d9jnlpb1ba = {\n    makeTab: makeTab$1,\n    getGeneralItems: getGeneralItems\n  };\n\n  var url = function () {\n    return $_4q4g1acwjnlpb19s.getOrDie('URL');\n  };\n  var createObjectURL = function (blob) {\n    return url().createObjectURL(blob);\n  };\n  var revokeObjectURL = function (u) {\n    url().revokeObjectURL(u);\n  };\n  var $_9a12jidcjnlpb1bk = {\n    createObjectURL: createObjectURL,\n    revokeObjectURL: revokeObjectURL\n  };\n\n  var global$5 = tinymce.util.Tools.resolve('tinymce.ui.Factory');\n\n  function XMLHttpRequest () {\n    var f = $_4q4g1acwjnlpb19s.getOrDie('XMLHttpRequest');\n    return new f();\n  }\n\n  var noop = function () {\n  };\n  var pathJoin = function (path1, path2) {\n    if (path1) {\n      return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n    }\n    return path2;\n  };\n  function Uploader (settings) {\n    var defaultHandler = function (blobInfo, success, failure, progress) {\n      var xhr, formData;\n      xhr = XMLHttpRequest();\n      xhr.open('POST', settings.url);\n      xhr.withCredentials = settings.credentials;\n      xhr.upload.onprogress = function (e) {\n        progress(e.loaded / e.total * 100);\n      };\n      xhr.onerror = function () {\n        failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n      };\n      xhr.onload = function () {\n        var json;\n        if (xhr.status < 200 || xhr.status >= 300) {\n          failure('HTTP Error: ' + xhr.status);\n          return;\n        }\n        json = JSON.parse(xhr.responseText);\n        if (!json || typeof json.location !== 'string') {\n          failure('Invalid JSON: ' + xhr.responseText);\n          return;\n        }\n        success(pathJoin(settings.basePath, json.location));\n      };\n      formData = new FormData();\n      formData.append('file', blobInfo.blob(), blobInfo.filename());\n      xhr.send(formData);\n    };\n    var uploadBlob = function (blobInfo, handler) {\n      return new global$1(function (resolve, reject) {\n        try {\n          handler(blobInfo, resolve, reject, noop);\n        } catch (ex) {\n          reject(ex.message);\n        }\n      });\n    };\n    var isDefaultHandler = function (handler) {\n      return handler === defaultHandler;\n    };\n    var upload = function (blobInfo) {\n      return !settings.url && isDefaultHandler(settings.handler) ? global$1.reject('Upload url missing from the settings.') : uploadBlob(blobInfo, settings.handler);\n    };\n    settings = global$2.extend({\n      credentials: false,\n      handler: defaultHandler\n    }, settings);\n    return { upload: upload };\n  }\n\n  var onFileInput = function (editor) {\n    return function (evt) {\n      var Throbber = global$5.get('Throbber');\n      var rootControl = evt.control.rootControl;\n      var throbber = new Throbber(rootControl.getEl());\n      var file = evt.control.value();\n      var blobUri = $_9a12jidcjnlpb1bk.createObjectURL(file);\n      var uploader = Uploader({\n        url: $_cwfv1xctjnlpb19i.getUploadUrl(editor),\n        basePath: $_cwfv1xctjnlpb19i.getUploadBasePath(editor),\n        credentials: $_cwfv1xctjnlpb19i.getUploadCredentials(editor),\n        handler: $_cwfv1xctjnlpb19i.getUploadHandler(editor)\n      });\n      var finalize = function () {\n        throbber.hide();\n        $_9a12jidcjnlpb1bk.revokeObjectURL(blobUri);\n      };\n      throbber.show();\n      return $_c1uzycujnlpb19l.blobToDataUri(file).then(function (dataUrl) {\n        var blobInfo = editor.editorUpload.blobCache.create({\n          blob: file,\n          blobUri: blobUri,\n          name: file.name ? file.name.replace(/\\.[^\\.]+$/, '') : null,\n          base64: dataUrl.split(',')[1]\n        });\n        return uploader.upload(blobInfo).then(function (url) {\n          var src = rootControl.find('#src');\n          src.value(url);\n          rootControl.find('tabpanel')[0].activateTab(0);\n          src.fire('change');\n          finalize();\n          return url;\n        });\n      }).catch(function (err) {\n        editor.windowManager.alert(err);\n        finalize();\n      });\n    };\n  };\n  var acceptExts = '.jpg,.jpeg,.png,.gif';\n  var makeTab$2 = function (editor) {\n    return {\n      title: 'Upload',\n      type: 'form',\n      layout: 'flex',\n      direction: 'column',\n      align: 'stretch',\n      padding: '20 20 20 20',\n      items: [\n        {\n          type: 'container',\n          layout: 'flex',\n          direction: 'column',\n          align: 'center',\n          spacing: 10,\n          items: [\n            {\n              text: 'Browse for an image',\n              type: 'browsebutton',\n              accept: acceptExts,\n              onchange: onFileInput(editor)\n            },\n            {\n              text: 'OR',\n              type: 'label'\n            }\n          ]\n        },\n        {\n          text: 'Drop an image here',\n          type: 'dropzone',\n          accept: acceptExts,\n          height: 100,\n          onchange: onFileInput(editor)\n        }\n      ]\n    };\n  };\n  var $_bsie2ndbjnlpb1bg = { makeTab: makeTab$2 };\n\n  var curry = function (f) {\n    var x = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n      x[_i - 1] = arguments[_i];\n    }\n    var args = new Array(arguments.length - 1);\n    for (var i = 1; i < arguments.length; i++)\n      args[i - 1] = arguments[i];\n    return function () {\n      var x = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        x[_i] = arguments[_i];\n      }\n      var newArgs = new Array(arguments.length);\n      for (var j = 0; j < newArgs.length; j++)\n        newArgs[j] = arguments[j];\n      var all = args.concat(newArgs);\n      return f.apply(null, all);\n    };\n  };\n\n  var submitForm = function (editor, evt) {\n    var win = evt.control.getRoot();\n    $_dk9flrdajnlpb1bd.updateSize(win);\n    editor.undoManager.transact(function () {\n      var data = merge(readImageDataFromSelection(editor), win.toJSON());\n      insertOrUpdateImage(editor, data);\n    });\n    editor.editorUpload.uploadImagesAuto();\n  };\n  function Dialog (editor) {\n    function showDialog(imageList) {\n      var data = readImageDataFromSelection(editor);\n      var win, imageListCtrl;\n      if (imageList) {\n        imageListCtrl = {\n          type: 'listbox',\n          label: 'Image list',\n          name: 'image-list',\n          values: $_c1uzycujnlpb19l.buildListItems(imageList, function (item) {\n            item.value = editor.convertURL(item.value || item.url, 'src');\n          }, [{\n              text: 'None',\n              value: ''\n            }]),\n          value: data.src && editor.convertURL(data.src, 'src'),\n          onselect: function (e) {\n            var altCtrl = win.find('#alt');\n            if (!altCtrl.value() || e.lastControl && altCtrl.value() === e.lastControl.text()) {\n              altCtrl.value(e.control.text());\n            }\n            win.find('#src').value(e.control.value()).fire('change');\n          },\n          onPostRender: function () {\n            imageListCtrl = this;\n          }\n        };\n      }\n      if ($_cwfv1xctjnlpb19i.hasAdvTab(editor) || $_cwfv1xctjnlpb19i.hasUploadUrl(editor) || $_cwfv1xctjnlpb19i.hasUploadHandler(editor)) {\n        var body = [$_1uv9q4d9jnlpb1ba.makeTab(editor, imageListCtrl)];\n        if ($_cwfv1xctjnlpb19i.hasAdvTab(editor)) {\n          body.push($_cdolkdd3jnlpb1ag.makeTab(editor));\n        }\n        if ($_cwfv1xctjnlpb19i.hasUploadUrl(editor) || $_cwfv1xctjnlpb19i.hasUploadHandler(editor)) {\n          body.push($_bsie2ndbjnlpb1bg.makeTab(editor));\n        }\n        win = editor.windowManager.open({\n          title: 'Insert/edit image',\n          data: data,\n          bodyType: 'tabpanel',\n          body: body,\n          onSubmit: curry(submitForm, editor)\n        });\n      } else {\n        win = editor.windowManager.open({\n          title: 'Insert/edit image',\n          data: data,\n          body: $_1uv9q4d9jnlpb1ba.getGeneralItems(editor, imageListCtrl),\n          onSubmit: curry(submitForm, editor)\n        });\n      }\n      $_dk9flrdajnlpb1bd.syncSize(win);\n    }\n    function open() {\n      $_c1uzycujnlpb19l.createImageList(editor, showDialog);\n    }\n    return { open: open };\n  }\n\n  var register = function (editor) {\n    editor.addCommand('mceImage', Dialog(editor).open);\n  };\n  var $_jjmdwcrjnlpb19a = { register: register };\n\n  var hasImageClass = function (node) {\n    var className = node.attr('class');\n    return className && /\\bimage\\b/.test(className);\n  };\n  var toggleContentEditableState = function (state) {\n    return function (nodes) {\n      var i = nodes.length, node;\n      var toggleContentEditable = function (node) {\n        node.attr('contenteditable', state ? 'true' : null);\n      };\n      while (i--) {\n        node = nodes[i];\n        if (hasImageClass(node)) {\n          node.attr('contenteditable', state ? 'false' : null);\n          global$2.each(node.getAll('figcaption'), toggleContentEditable);\n        }\n      }\n    };\n  };\n  var setup = function (editor) {\n    editor.on('preInit', function () {\n      editor.parser.addNodeFilter('figure', toggleContentEditableState(true));\n      editor.serializer.addNodeFilter('figure', toggleContentEditableState(false));\n    });\n  };\n  var $_e9m3rqdhjnlpb1bu = { setup: setup };\n\n  var register$1 = function (editor) {\n    editor.addButton('image', {\n      icon: 'image',\n      tooltip: 'Insert/edit image',\n      onclick: Dialog(editor).open,\n      stateSelector: 'img:not([data-mce-object],[data-mce-placeholder]),figure.image'\n    });\n    editor.addMenuItem('image', {\n      icon: 'image',\n      text: 'Image',\n      onclick: Dialog(editor).open,\n      context: 'insert',\n      prependToContext: true\n    });\n  };\n  var $_7nkb3cdijnlpb1bw = { register: register$1 };\n\n  global.add('image', function (editor) {\n    $_e9m3rqdhjnlpb1bu.setup(editor);\n    $_7nkb3cdijnlpb1bw.register(editor);\n    $_jjmdwcrjnlpb19a.register(editor);\n  });\n  function Plugin () {\n  }\n\n  return Plugin;\n\n}());\n})();\n"]}]}