{"remainingRequest":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/babel-loader/lib/index.js!/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/eslint-loader/index.js??ref--13-0!/Users/shanliguo/Documents/workstudy/vue-form-making/src/lib/tinymce/plugins/media/plugin.js","dependencies":[{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/src/lib/tinymce/plugins/media/plugin.js","mtime":1551936176000},{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var media = function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n    var global$1 = tinymce.util.Tools.resolve('tinymce.Env');\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getScripts = function (editor) {\n      return editor.getParam('media_scripts');\n    };\n\n    var getAudioTemplateCallback = function (editor) {\n      return editor.getParam('audio_template_callback');\n    };\n\n    var getVideoTemplateCallback = function (editor) {\n      return editor.getParam('video_template_callback');\n    };\n\n    var hasLiveEmbeds = function (editor) {\n      return editor.getParam('media_live_embeds', true);\n    };\n\n    var shouldFilterHtml = function (editor) {\n      return editor.getParam('media_filter_html', true);\n    };\n\n    var getUrlResolver = function (editor) {\n      return editor.getParam('media_url_resolver');\n    };\n\n    var hasAltSource = function (editor) {\n      return editor.getParam('media_alt_source', true);\n    };\n\n    var hasPoster = function (editor) {\n      return editor.getParam('media_poster', true);\n    };\n\n    var hasDimensions = function (editor) {\n      return editor.getParam('media_dimensions', true);\n    };\n\n    var $_4lfblsh3jnlpb27u = {\n      getScripts: getScripts,\n      getAudioTemplateCallback: getAudioTemplateCallback,\n      getVideoTemplateCallback: getVideoTemplateCallback,\n      hasLiveEmbeds: hasLiveEmbeds,\n      shouldFilterHtml: shouldFilterHtml,\n      getUrlResolver: getUrlResolver,\n      hasAltSource: hasAltSource,\n      hasPoster: hasPoster,\n      hasDimensions: hasDimensions\n    };\n    var global$3 = tinymce.util.Tools.resolve('tinymce.html.SaxParser');\n    var global$4 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var getVideoScriptMatch = function (prefixes, src) {\n      if (prefixes) {\n        for (var i = 0; i < prefixes.length; i++) {\n          if (src.indexOf(prefixes[i].filter) !== -1) {\n            return prefixes[i];\n          }\n        }\n      }\n    };\n\n    var $_6kmpndh7jnlpb27z = {\n      getVideoScriptMatch: getVideoScriptMatch\n    };\n\n    var trimPx = function (value) {\n      return value.replace(/px$/, '');\n    };\n\n    var addPx = function (value) {\n      return /^[0-9.]+$/.test(value) ? value + 'px' : value;\n    };\n\n    var getSize = function (name) {\n      return function (elm) {\n        return elm ? trimPx(elm.style[name]) : '';\n      };\n    };\n\n    var setSize = function (name) {\n      return function (elm, value) {\n        if (elm) {\n          elm.style[name] = addPx(value);\n        }\n      };\n    };\n\n    var $_1vq9sh8jnlpb280 = {\n      getMaxWidth: getSize('maxWidth'),\n      getMaxHeight: getSize('maxHeight'),\n      setMaxWidth: setSize('maxWidth'),\n      setMaxHeight: setSize('maxHeight')\n    };\n    var DOM = global$4.DOM;\n\n    var getEphoxEmbedIri = function (elm) {\n      return DOM.getAttrib(elm, 'data-ephox-embed-iri');\n    };\n\n    var isEphoxEmbed = function (html) {\n      var fragment = DOM.createFragment(html);\n      return getEphoxEmbedIri(fragment.firstChild) !== '';\n    };\n\n    var htmlToDataSax = function (prefixes, html) {\n      var data = {};\n      global$3({\n        validate: false,\n        allow_conditional_comments: true,\n        special: 'script,noscript',\n        start: function (name, attrs) {\n          if (!data.source1 && name === 'param') {\n            data.source1 = attrs.map.movie;\n          }\n\n          if (name === 'iframe' || name === 'object' || name === 'embed' || name === 'video' || name === 'audio') {\n            if (!data.type) {\n              data.type = name;\n            }\n\n            data = global$2.extend(attrs.map, data);\n          }\n\n          if (name === 'script') {\n            var videoScript = $_6kmpndh7jnlpb27z.getVideoScriptMatch(prefixes, attrs.map.src);\n\n            if (!videoScript) {\n              return;\n            }\n\n            data = {\n              type: 'script',\n              source1: attrs.map.src,\n              width: videoScript.width,\n              height: videoScript.height\n            };\n          }\n\n          if (name === 'source') {\n            if (!data.source1) {\n              data.source1 = attrs.map.src;\n            } else if (!data.source2) {\n              data.source2 = attrs.map.src;\n            }\n          }\n\n          if (name === 'img' && !data.poster) {\n            data.poster = attrs.map.src;\n          }\n        }\n      }).parse(html);\n      data.source1 = data.source1 || data.src || data.data;\n      data.source2 = data.source2 || '';\n      data.poster = data.poster || '';\n      return data;\n    };\n\n    var ephoxEmbedHtmlToData = function (html) {\n      var fragment = DOM.createFragment(html);\n      var div = fragment.firstChild;\n      return {\n        type: 'ephox-embed-iri',\n        source1: getEphoxEmbedIri(div),\n        source2: '',\n        poster: '',\n        width: $_1vq9sh8jnlpb280.getMaxWidth(div),\n        height: $_1vq9sh8jnlpb280.getMaxHeight(div)\n      };\n    };\n\n    var htmlToData = function (prefixes, html) {\n      return isEphoxEmbed(html) ? ephoxEmbedHtmlToData(html) : htmlToDataSax(prefixes, html);\n    };\n\n    var $_7mert0h4jnlpb27v = {\n      htmlToData: htmlToData\n    };\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var guess = function (url) {\n      var mimes = {\n        mp3: 'audio/mpeg',\n        wav: 'audio/wav',\n        mp4: 'video/mp4',\n        webm: 'video/webm',\n        ogg: 'video/ogg',\n        swf: 'application/x-shockwave-flash'\n      };\n      var fileEnd = url.toLowerCase().split('.').pop();\n      var mime = mimes[fileEnd];\n      return mime ? mime : '';\n    };\n\n    var $_87k6mahcjnlpb28d = {\n      guess: guess\n    };\n    var global$6 = tinymce.util.Tools.resolve('tinymce.html.Writer');\n    var global$7 = tinymce.util.Tools.resolve('tinymce.html.Schema');\n    var DOM$1 = global$4.DOM;\n\n    var setAttributes = function (attrs, updatedAttrs) {\n      var name;\n      var i;\n      var value;\n      var attr;\n\n      for (name in updatedAttrs) {\n        value = '' + updatedAttrs[name];\n\n        if (attrs.map[name]) {\n          i = attrs.length;\n\n          while (i--) {\n            attr = attrs[i];\n\n            if (attr.name === name) {\n              if (value) {\n                attrs.map[name] = value;\n                attr.value = value;\n              } else {\n                delete attrs.map[name];\n                attrs.splice(i, 1);\n              }\n            }\n          }\n        } else if (value) {\n          attrs.push({\n            name: name,\n            value: value\n          });\n          attrs.map[name] = value;\n        }\n      }\n    };\n\n    var normalizeHtml = function (html) {\n      var writer = global$6();\n      var parser = global$3(writer);\n      parser.parse(html);\n      return writer.getContent();\n    };\n\n    var updateHtmlSax = function (html, data, updateAll) {\n      var writer = global$6();\n      var sourceCount = 0;\n      var hasImage;\n      global$3({\n        validate: false,\n        allow_conditional_comments: true,\n        special: 'script,noscript',\n        comment: function (text) {\n          writer.comment(text);\n        },\n        cdata: function (text) {\n          writer.cdata(text);\n        },\n        text: function (text, raw) {\n          writer.text(text, raw);\n        },\n        start: function (name, attrs, empty) {\n          switch (name) {\n            case 'video':\n            case 'object':\n            case 'embed':\n            case 'img':\n            case 'iframe':\n              if (data.height !== undefined && data.width !== undefined) {\n                setAttributes(attrs, {\n                  width: data.width,\n                  height: data.height\n                });\n              }\n\n              break;\n          }\n\n          if (updateAll) {\n            switch (name) {\n              case 'video':\n                setAttributes(attrs, {\n                  poster: data.poster,\n                  src: ''\n                });\n\n                if (data.source2) {\n                  setAttributes(attrs, {\n                    src: ''\n                  });\n                }\n\n                break;\n\n              case 'iframe':\n                setAttributes(attrs, {\n                  src: data.source1\n                });\n                break;\n\n              case 'source':\n                sourceCount++;\n\n                if (sourceCount <= 2) {\n                  setAttributes(attrs, {\n                    src: data['source' + sourceCount],\n                    type: data['source' + sourceCount + 'mime']\n                  });\n\n                  if (!data['source' + sourceCount]) {\n                    return;\n                  }\n                }\n\n                break;\n\n              case 'img':\n                if (!data.poster) {\n                  return;\n                }\n\n                hasImage = true;\n                break;\n            }\n          }\n\n          writer.start(name, attrs, empty);\n        },\n        end: function (name) {\n          if (name === 'video' && updateAll) {\n            for (var index = 1; index <= 2; index++) {\n              if (data['source' + index]) {\n                var attrs = [];\n                attrs.map = {};\n\n                if (sourceCount < index) {\n                  setAttributes(attrs, {\n                    src: data['source' + index],\n                    type: data['source' + index + 'mime']\n                  });\n                  writer.start('source', attrs, true);\n                }\n              }\n            }\n          }\n\n          if (data.poster && name === 'object' && updateAll && !hasImage) {\n            var imgAttrs = [];\n            imgAttrs.map = {};\n            setAttributes(imgAttrs, {\n              src: data.poster,\n              width: data.width,\n              height: data.height\n            });\n            writer.start('img', imgAttrs, true);\n          }\n\n          writer.end(name);\n        }\n      }, global$7({})).parse(html);\n      return writer.getContent();\n    };\n\n    var isEphoxEmbed$1 = function (html) {\n      var fragment = DOM$1.createFragment(html);\n      return DOM$1.getAttrib(fragment.firstChild, 'data-ephox-embed-iri') !== '';\n    };\n\n    var updateEphoxEmbed = function (html, data) {\n      var fragment = DOM$1.createFragment(html);\n      var div = fragment.firstChild;\n      $_1vq9sh8jnlpb280.setMaxWidth(div, data.width);\n      $_1vq9sh8jnlpb280.setMaxHeight(div, data.height);\n      return normalizeHtml(div.outerHTML);\n    };\n\n    var updateHtml = function (html, data, updateAll) {\n      return isEphoxEmbed$1(html) ? updateEphoxEmbed(html, data) : updateHtmlSax(html, data, updateAll);\n    };\n\n    var $_2h712hhdjnlpb28f = {\n      updateHtml: updateHtml\n    };\n    var urlPatterns = [{\n      regex: /youtu\\.be\\/([\\w\\-_\\?&=.]+)/i,\n      type: 'iframe',\n      w: 560,\n      h: 314,\n      url: '//www.youtube.com/embed/$1',\n      allowFullscreen: true\n    }, {\n      regex: /youtube\\.com(.+)v=([^&]+)(&([a-z0-9&=\\-_]+))?/i,\n      type: 'iframe',\n      w: 560,\n      h: 314,\n      url: '//www.youtube.com/embed/$2?$4',\n      allowFullscreen: true\n    }, {\n      regex: /youtube.com\\/embed\\/([a-z0-9\\?&=\\-_]+)/i,\n      type: 'iframe',\n      w: 560,\n      h: 314,\n      url: '//www.youtube.com/embed/$1',\n      allowFullscreen: true\n    }, {\n      regex: /vimeo\\.com\\/([0-9]+)/,\n      type: 'iframe',\n      w: 425,\n      h: 350,\n      url: '//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc',\n      allowFullscreen: true\n    }, {\n      regex: /vimeo\\.com\\/(.*)\\/([0-9]+)/,\n      type: 'iframe',\n      w: 425,\n      h: 350,\n      url: '//player.vimeo.com/video/$2?title=0&amp;byline=0',\n      allowFullscreen: true\n    }, {\n      regex: /maps\\.google\\.([a-z]{2,3})\\/maps\\/(.+)msid=(.+)/,\n      type: 'iframe',\n      w: 425,\n      h: 350,\n      url: '//maps.google.com/maps/ms?msid=$2&output=embed\"',\n      allowFullscreen: false\n    }, {\n      regex: /dailymotion\\.com\\/video\\/([^_]+)/,\n      type: 'iframe',\n      w: 480,\n      h: 270,\n      url: '//www.dailymotion.com/embed/video/$1',\n      allowFullscreen: true\n    }, {\n      regex: /dai\\.ly\\/([^_]+)/,\n      type: 'iframe',\n      w: 480,\n      h: 270,\n      url: '//www.dailymotion.com/embed/video/$1',\n      allowFullscreen: true\n    }];\n\n    var getUrl = function (pattern, url) {\n      var match = pattern.regex.exec(url);\n      var newUrl = pattern.url;\n\n      var _loop_1 = function (i) {\n        newUrl = newUrl.replace('$' + i, function () {\n          return match[i] ? match[i] : '';\n        });\n      };\n\n      for (var i = 0; i < match.length; i++) {\n        _loop_1(i);\n      }\n\n      return newUrl.replace(/\\?$/, '');\n    };\n\n    var matchPattern = function (url) {\n      var pattern = urlPatterns.filter(function (pattern) {\n        return pattern.regex.test(url);\n      });\n\n      if (pattern.length > 0) {\n        return global$2.extend({}, pattern[0], {\n          url: getUrl(pattern[0], url)\n        });\n      } else {\n        return null;\n      }\n    };\n\n    var getIframeHtml = function (data) {\n      var allowFullscreen = data.allowFullscreen ? ' allowFullscreen=\"1\"' : '';\n      return '<iframe src=\"' + data.source1 + '\" width=\"' + data.width + '\" height=\"' + data.height + '\"' + allowFullscreen + '></iframe>';\n    };\n\n    var getFlashHtml = function (data) {\n      var html = '<object data=\"' + data.source1 + '\" width=\"' + data.width + '\" height=\"' + data.height + '\" type=\"application/x-shockwave-flash\">';\n\n      if (data.poster) {\n        html += '<img src=\"' + data.poster + '\" width=\"' + data.width + '\" height=\"' + data.height + '\" />';\n      }\n\n      html += '</object>';\n      return html;\n    };\n\n    var getAudioHtml = function (data, audioTemplateCallback) {\n      if (audioTemplateCallback) {\n        return audioTemplateCallback(data);\n      } else {\n        return '<audio controls=\"controls\" src=\"' + data.source1 + '\">' + (data.source2 ? '\\n<source src=\"' + data.source2 + '\"' + (data.source2mime ? ' type=\"' + data.source2mime + '\"' : '') + ' />\\n' : '') + '</audio>';\n      }\n    };\n\n    var getVideoHtml = function (data, videoTemplateCallback) {\n      if (videoTemplateCallback) {\n        return videoTemplateCallback(data);\n      } else {\n        return '<video width=\"' + data.width + '\" height=\"' + data.height + '\"' + (data.poster ? ' poster=\"' + data.poster + '\"' : '') + ' controls=\"controls\">\\n' + '<source src=\"' + data.source1 + '\"' + (data.source1mime ? ' type=\"' + data.source1mime + '\"' : '') + ' />\\n' + (data.source2 ? '<source src=\"' + data.source2 + '\"' + (data.source2mime ? ' type=\"' + data.source2mime + '\"' : '') + ' />\\n' : '') + '</video>';\n      }\n    };\n\n    var getScriptHtml = function (data) {\n      return '<script src=\"' + data.source1 + '\"></script>';\n    };\n\n    var dataToHtml = function (editor, dataIn) {\n      var data = global$2.extend({}, dataIn);\n\n      if (!data.source1) {\n        global$2.extend(data, $_7mert0h4jnlpb27v.htmlToData($_4lfblsh3jnlpb27u.getScripts(editor), data.embed));\n\n        if (!data.source1) {\n          return '';\n        }\n      }\n\n      if (!data.source2) {\n        data.source2 = '';\n      }\n\n      if (!data.poster) {\n        data.poster = '';\n      }\n\n      data.source1 = editor.convertURL(data.source1, 'source');\n      data.source2 = editor.convertURL(data.source2, 'source');\n      data.source1mime = $_87k6mahcjnlpb28d.guess(data.source1);\n      data.source2mime = $_87k6mahcjnlpb28d.guess(data.source2);\n      data.poster = editor.convertURL(data.poster, 'poster');\n      var pattern = matchPattern(data.source1);\n\n      if (pattern) {\n        data.source1 = pattern.url;\n        data.type = pattern.type;\n        data.allowFullscreen = pattern.allowFullscreen;\n        data.width = data.width || pattern.w;\n        data.height = data.height || pattern.h;\n      }\n\n      if (data.embed) {\n        return $_2h712hhdjnlpb28f.updateHtml(data.embed, data, true);\n      } else {\n        var videoScript = $_6kmpndh7jnlpb27z.getVideoScriptMatch($_4lfblsh3jnlpb27u.getScripts(editor), data.source1);\n\n        if (videoScript) {\n          data.type = 'script';\n          data.width = videoScript.width;\n          data.height = videoScript.height;\n        }\n\n        var audioTemplateCallback = $_4lfblsh3jnlpb27u.getAudioTemplateCallback(editor);\n        var videoTemplateCallback = $_4lfblsh3jnlpb27u.getVideoTemplateCallback(editor);\n        data.width = data.width || 300;\n        data.height = data.height || 150;\n        global$2.each(data, function (value, key) {\n          data[key] = editor.dom.encode(value);\n        });\n\n        if (data.type === 'iframe') {\n          return getIframeHtml(data);\n        } else if (data.source1mime === 'application/x-shockwave-flash') {\n          return getFlashHtml(data);\n        } else if (data.source1mime.indexOf('audio') !== -1) {\n          return getAudioHtml(data, audioTemplateCallback);\n        } else if (data.type === 'script') {\n          return getScriptHtml(data);\n        } else {\n          return getVideoHtml(data, videoTemplateCallback);\n        }\n      }\n    };\n\n    var $_bjso6ohbjnlpb284 = {\n      dataToHtml: dataToHtml\n    };\n    var cache = {};\n\n    var embedPromise = function (data, dataToHtml, handler) {\n      return new global$5(function (res, rej) {\n        var wrappedResolve = function (response) {\n          if (response.html) {\n            cache[data.source1] = response;\n          }\n\n          return res({\n            url: data.source1,\n            html: response.html ? response.html : dataToHtml(data)\n          });\n        };\n\n        if (cache[data.source1]) {\n          wrappedResolve(cache[data.source1]);\n        } else {\n          handler({\n            url: data.source1\n          }, wrappedResolve, rej);\n        }\n      });\n    };\n\n    var defaultPromise = function (data, dataToHtml) {\n      return new global$5(function (res) {\n        res({\n          html: dataToHtml(data),\n          url: data.source1\n        });\n      });\n    };\n\n    var loadedData = function (editor) {\n      return function (data) {\n        return $_bjso6ohbjnlpb284.dataToHtml(editor, data);\n      };\n    };\n\n    var getEmbedHtml = function (editor, data) {\n      var embedHandler = $_4lfblsh3jnlpb27u.getUrlResolver(editor);\n      return embedHandler ? embedPromise(data, loadedData(editor), embedHandler) : defaultPromise(data, loadedData(editor));\n    };\n\n    var isCached = function (url) {\n      return cache.hasOwnProperty(url);\n    };\n\n    var $_3q0cc6h9jnlpb281 = {\n      getEmbedHtml: getEmbedHtml,\n      isCached: isCached\n    };\n\n    var doSyncSize = function (widthCtrl, heightCtrl) {\n      widthCtrl.state.set('oldVal', widthCtrl.value());\n      heightCtrl.state.set('oldVal', heightCtrl.value());\n    };\n\n    var doSizeControls = function (win, f) {\n      var widthCtrl = win.find('#width')[0];\n      var heightCtrl = win.find('#height')[0];\n      var constrained = win.find('#constrain')[0];\n\n      if (widthCtrl && heightCtrl && constrained) {\n        f(widthCtrl, heightCtrl, constrained.checked());\n      }\n    };\n\n    var doUpdateSize = function (widthCtrl, heightCtrl, isContrained) {\n      var oldWidth = widthCtrl.state.get('oldVal');\n      var oldHeight = heightCtrl.state.get('oldVal');\n      var newWidth = widthCtrl.value();\n      var newHeight = heightCtrl.value();\n\n      if (isContrained && oldWidth && oldHeight && newWidth && newHeight) {\n        if (newWidth !== oldWidth) {\n          newHeight = Math.round(newWidth / oldWidth * newHeight);\n\n          if (!isNaN(newHeight)) {\n            heightCtrl.value(newHeight);\n          }\n        } else {\n          newWidth = Math.round(newHeight / oldHeight * newWidth);\n\n          if (!isNaN(newWidth)) {\n            widthCtrl.value(newWidth);\n          }\n        }\n      }\n\n      doSyncSize(widthCtrl, heightCtrl);\n    };\n\n    var syncSize = function (win) {\n      doSizeControls(win, doSyncSize);\n    };\n\n    var updateSize = function (win) {\n      doSizeControls(win, doUpdateSize);\n    };\n\n    var createUi = function (onChange) {\n      var recalcSize = function () {\n        onChange(function (win) {\n          updateSize(win);\n        });\n      };\n\n      return {\n        type: 'container',\n        label: 'Dimensions',\n        layout: 'flex',\n        align: 'center',\n        spacing: 5,\n        items: [{\n          name: 'width',\n          type: 'textbox',\n          maxLength: 5,\n          size: 5,\n          onchange: recalcSize,\n          ariaLabel: 'Width'\n        }, {\n          type: 'label',\n          text: 'x'\n        }, {\n          name: 'height',\n          type: 'textbox',\n          maxLength: 5,\n          size: 5,\n          onchange: recalcSize,\n          ariaLabel: 'Height'\n        }, {\n          name: 'constrain',\n          type: 'checkbox',\n          checked: true,\n          text: 'Constrain proportions'\n        }]\n      };\n    };\n\n    var $_s3mrghhjnlpb28m = {\n      createUi: createUi,\n      syncSize: syncSize,\n      updateSize: updateSize\n    };\n    var embedChange = global$1.ie && global$1.ie <= 8 ? 'onChange' : 'onInput';\n\n    var handleError = function (editor) {\n      return function (error) {\n        var errorMessage = error && error.msg ? 'Media embed handler error: ' + error.msg : 'Media embed handler threw unknown error.';\n        editor.notificationManager.open({\n          type: 'error',\n          text: errorMessage\n        });\n      };\n    };\n\n    var getData = function (editor) {\n      var element = editor.selection.getNode();\n      var dataEmbed = element.getAttribute('data-ephox-embed-iri');\n\n      if (dataEmbed) {\n        return {\n          'source1': dataEmbed,\n          'data-ephox-embed-iri': dataEmbed,\n          'width': $_1vq9sh8jnlpb280.getMaxWidth(element),\n          'height': $_1vq9sh8jnlpb280.getMaxHeight(element)\n        };\n      }\n\n      return element.getAttribute('data-mce-object') ? $_7mert0h4jnlpb27v.htmlToData($_4lfblsh3jnlpb27u.getScripts(editor), editor.serializer.serialize(element, {\n        selection: true\n      })) : {};\n    };\n\n    var getSource = function (editor) {\n      var elm = editor.selection.getNode();\n\n      if (elm.getAttribute('data-mce-object') || elm.getAttribute('data-ephox-embed-iri')) {\n        return editor.selection.getContent();\n      }\n    };\n\n    var addEmbedHtml = function (win, editor) {\n      return function (response) {\n        var html = response.html;\n        var embed = win.find('#embed')[0];\n        var data = global$2.extend($_7mert0h4jnlpb27v.htmlToData($_4lfblsh3jnlpb27u.getScripts(editor), html), {\n          source1: response.url\n        });\n        win.fromJSON(data);\n\n        if (embed) {\n          embed.value(html);\n          $_s3mrghhjnlpb28m.updateSize(win);\n        }\n      };\n    };\n\n    var selectPlaceholder = function (editor, beforeObjects) {\n      var i;\n      var y;\n      var afterObjects = editor.dom.select('img[data-mce-object]');\n\n      for (i = 0; i < beforeObjects.length; i++) {\n        for (y = afterObjects.length - 1; y >= 0; y--) {\n          if (beforeObjects[i] === afterObjects[y]) {\n            afterObjects.splice(y, 1);\n          }\n        }\n      }\n\n      editor.selection.select(afterObjects[0]);\n    };\n\n    var handleInsert = function (editor, html) {\n      var beforeObjects = editor.dom.select('img[data-mce-object]');\n      editor.insertContent(html);\n      selectPlaceholder(editor, beforeObjects);\n      editor.nodeChanged();\n    };\n\n    var submitForm = function (win, editor) {\n      var data = win.toJSON();\n      data.embed = $_2h712hhdjnlpb28f.updateHtml(data.embed, data);\n\n      if (data.embed && $_3q0cc6h9jnlpb281.isCached(data.source1)) {\n        handleInsert(editor, data.embed);\n      } else {\n        $_3q0cc6h9jnlpb281.getEmbedHtml(editor, data).then(function (response) {\n          handleInsert(editor, response.html);\n        }).catch(handleError(editor));\n      }\n    };\n\n    var populateMeta = function (win, meta) {\n      global$2.each(meta, function (value, key) {\n        win.find('#' + key).value(value);\n      });\n    };\n\n    var showDialog = function (editor) {\n      var win;\n      var data;\n      var generalFormItems = [{\n        name: 'source1',\n        type: 'filepicker',\n        filetype: 'media',\n        size: 40,\n        autofocus: true,\n        label: 'Source',\n        onpaste: function () {\n          setTimeout(function () {\n            $_3q0cc6h9jnlpb281.getEmbedHtml(editor, win.toJSON()).then(addEmbedHtml(win, editor)).catch(handleError(editor));\n          }, 1);\n        },\n        onchange: function (e) {\n          $_3q0cc6h9jnlpb281.getEmbedHtml(editor, win.toJSON()).then(addEmbedHtml(win, editor)).catch(handleError(editor));\n          populateMeta(win, e.meta);\n        },\n        onbeforecall: function (e) {\n          e.meta = win.toJSON();\n        }\n      }];\n      var advancedFormItems = [];\n\n      var reserialise = function (update) {\n        update(win);\n        data = win.toJSON();\n        win.find('#embed').value($_2h712hhdjnlpb28f.updateHtml(data.embed, data));\n      };\n\n      if ($_4lfblsh3jnlpb27u.hasAltSource(editor)) {\n        advancedFormItems.push({\n          name: 'source2',\n          type: 'filepicker',\n          filetype: 'media',\n          size: 40,\n          label: 'Alternative source'\n        });\n      }\n\n      if ($_4lfblsh3jnlpb27u.hasPoster(editor)) {\n        advancedFormItems.push({\n          name: 'poster',\n          type: 'filepicker',\n          filetype: 'image',\n          size: 40,\n          label: 'Poster'\n        });\n      }\n\n      if ($_4lfblsh3jnlpb27u.hasDimensions(editor)) {\n        var control = $_s3mrghhjnlpb28m.createUi(reserialise);\n        generalFormItems.push(control);\n      }\n\n      data = getData(editor);\n      var embedTextBox = {\n        id: 'mcemediasource',\n        type: 'textbox',\n        flex: 1,\n        name: 'embed',\n        value: getSource(editor),\n        multiline: true,\n        rows: 5,\n        label: 'Source'\n      };\n\n      var updateValueOnChange = function () {\n        data = global$2.extend({}, $_7mert0h4jnlpb27v.htmlToData($_4lfblsh3jnlpb27u.getScripts(editor), this.value()));\n        this.parent().parent().fromJSON(data);\n      };\n\n      embedTextBox[embedChange] = updateValueOnChange;\n      var body = [{\n        title: 'General',\n        type: 'form',\n        items: generalFormItems\n      }, {\n        title: 'Embed',\n        type: 'container',\n        layout: 'flex',\n        direction: 'column',\n        align: 'stretch',\n        padding: 10,\n        spacing: 10,\n        items: [{\n          type: 'label',\n          text: 'Paste your embed code below:',\n          forId: 'mcemediasource'\n        }, embedTextBox]\n      }];\n\n      if (advancedFormItems.length > 0) {\n        body.push({\n          title: 'Advanced',\n          type: 'form',\n          items: advancedFormItems\n        });\n      }\n\n      win = editor.windowManager.open({\n        title: 'Insert/edit media',\n        data: data,\n        bodyType: 'tabpanel',\n        body: body,\n        onSubmit: function () {\n          $_s3mrghhjnlpb28m.updateSize(win);\n          submitForm(win, editor);\n        }\n      });\n      $_s3mrghhjnlpb28m.syncSize(win);\n    };\n\n    var $_ejovioh0jnlpb27m = {\n      showDialog: showDialog\n    };\n\n    var get = function (editor) {\n      var showDialog = function () {\n        $_ejovioh0jnlpb27m.showDialog(editor);\n      };\n\n      return {\n        showDialog: showDialog\n      };\n    };\n\n    var $_2j6fosgzjnlpb27k = {\n      get: get\n    };\n\n    var register = function (editor) {\n      var showDialog = function () {\n        $_ejovioh0jnlpb27m.showDialog(editor);\n      };\n\n      editor.addCommand('mceMedia', showDialog);\n    };\n\n    var $_55m8chhijnlpb28o = {\n      register: register\n    };\n    var global$8 = tinymce.util.Tools.resolve('tinymce.html.Node');\n\n    var sanitize = function (editor, html) {\n      if ($_4lfblsh3jnlpb27u.shouldFilterHtml(editor) === false) {\n        return html;\n      }\n\n      var writer = global$6();\n      var blocked;\n      global$3({\n        validate: false,\n        allow_conditional_comments: false,\n        special: 'script,noscript',\n        comment: function (text) {\n          writer.comment(text);\n        },\n        cdata: function (text) {\n          writer.cdata(text);\n        },\n        text: function (text, raw) {\n          writer.text(text, raw);\n        },\n        start: function (name, attrs, empty) {\n          blocked = true;\n\n          if (name === 'script' || name === 'noscript') {\n            return;\n          }\n\n          for (var i = 0; i < attrs.length; i++) {\n            if (attrs[i].name.indexOf('on') === 0) {\n              return;\n            }\n\n            if (attrs[i].name === 'style') {\n              attrs[i].value = editor.dom.serializeStyle(editor.dom.parseStyle(attrs[i].value), name);\n            }\n          }\n\n          writer.start(name, attrs, empty);\n          blocked = false;\n        },\n        end: function (name) {\n          if (blocked) {\n            return;\n          }\n\n          writer.end(name);\n        }\n      }, global$7({})).parse(html);\n      return writer.getContent();\n    };\n\n    var $_aa29lrhmjnlpb28x = {\n      sanitize: sanitize\n    };\n\n    var createPlaceholderNode = function (editor, node) {\n      var placeHolder;\n      var name = node.name;\n      placeHolder = new global$8('img', 1);\n      placeHolder.shortEnded = true;\n      retainAttributesAndInnerHtml(editor, node, placeHolder);\n      placeHolder.attr({\n        'width': node.attr('width') || '300',\n        'height': node.attr('height') || (name === 'audio' ? '30' : '150'),\n        'style': node.attr('style'),\n        'src': global$1.transparentSrc,\n        'data-mce-object': name,\n        'class': 'mce-object mce-object-' + name\n      });\n      return placeHolder;\n    };\n\n    var createPreviewIframeNode = function (editor, node) {\n      var previewWrapper;\n      var previewNode;\n      var shimNode;\n      var name = node.name;\n      previewWrapper = new global$8('span', 1);\n      previewWrapper.attr({\n        'contentEditable': 'false',\n        'style': node.attr('style'),\n        'data-mce-object': name,\n        'class': 'mce-preview-object mce-object-' + name\n      });\n      retainAttributesAndInnerHtml(editor, node, previewWrapper);\n      previewNode = new global$8(name, 1);\n      previewNode.attr({\n        src: node.attr('src'),\n        allowfullscreen: node.attr('allowfullscreen'),\n        style: node.attr('style'),\n        class: node.attr('class'),\n        width: node.attr('width'),\n        height: node.attr('height'),\n        frameborder: '0'\n      });\n      shimNode = new global$8('span', 1);\n      shimNode.attr('class', 'mce-shim');\n      previewWrapper.append(previewNode);\n      previewWrapper.append(shimNode);\n      return previewWrapper;\n    };\n\n    var retainAttributesAndInnerHtml = function (editor, sourceNode, targetNode) {\n      var attrName;\n      var attrValue;\n      var attribs;\n      var ai;\n      var innerHtml;\n      attribs = sourceNode.attributes;\n      ai = attribs.length;\n\n      while (ai--) {\n        attrName = attribs[ai].name;\n        attrValue = attribs[ai].value;\n\n        if (attrName !== 'width' && attrName !== 'height' && attrName !== 'style') {\n          if (attrName === 'data' || attrName === 'src') {\n            attrValue = editor.convertURL(attrValue, attrName);\n          }\n\n          targetNode.attr('data-mce-p-' + attrName, attrValue);\n        }\n      }\n\n      innerHtml = sourceNode.firstChild && sourceNode.firstChild.value;\n\n      if (innerHtml) {\n        targetNode.attr('data-mce-html', escape($_aa29lrhmjnlpb28x.sanitize(editor, innerHtml)));\n        targetNode.firstChild = null;\n      }\n    };\n\n    var isWithinEphoxEmbed = function (node) {\n      while (node = node.parent) {\n        if (node.attr('data-ephox-embed-iri')) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    var placeHolderConverter = function (editor) {\n      return function (nodes) {\n        var i = nodes.length;\n        var node;\n        var videoScript;\n\n        while (i--) {\n          node = nodes[i];\n\n          if (!node.parent) {\n            continue;\n          }\n\n          if (node.parent.attr('data-mce-object')) {\n            continue;\n          }\n\n          if (node.name === 'script') {\n            videoScript = $_6kmpndh7jnlpb27z.getVideoScriptMatch($_4lfblsh3jnlpb27u.getScripts(editor), node.attr('src'));\n\n            if (!videoScript) {\n              continue;\n            }\n          }\n\n          if (videoScript) {\n            if (videoScript.width) {\n              node.attr('width', videoScript.width.toString());\n            }\n\n            if (videoScript.height) {\n              node.attr('height', videoScript.height.toString());\n            }\n          }\n\n          if (node.name === 'iframe' && $_4lfblsh3jnlpb27u.hasLiveEmbeds(editor) && global$1.ceFalse) {\n            if (!isWithinEphoxEmbed(node)) {\n              node.replace(createPreviewIframeNode(editor, node));\n            }\n          } else {\n            if (!isWithinEphoxEmbed(node)) {\n              node.replace(createPlaceholderNode(editor, node));\n            }\n          }\n        }\n      };\n    };\n\n    var $_fw6tyyhljnlpb28t = {\n      createPreviewIframeNode: createPreviewIframeNode,\n      createPlaceholderNode: createPlaceholderNode,\n      placeHolderConverter: placeHolderConverter\n    };\n\n    var setup = function (editor) {\n      editor.on('preInit', function () {\n        var specialElements = editor.schema.getSpecialElements();\n        global$2.each('video audio iframe object'.split(' '), function (name) {\n          specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n        });\n        var boolAttrs = editor.schema.getBoolAttrs();\n        global$2.each('webkitallowfullscreen mozallowfullscreen allowfullscreen'.split(' '), function (name) {\n          boolAttrs[name] = {};\n        });\n        editor.parser.addNodeFilter('iframe,video,audio,object,embed,script', $_fw6tyyhljnlpb28t.placeHolderConverter(editor));\n        editor.serializer.addAttributeFilter('data-mce-object', function (nodes, name) {\n          var i = nodes.length;\n          var node;\n          var realElm;\n          var ai;\n          var attribs;\n          var innerHtml;\n          var innerNode;\n          var realElmName;\n          var className;\n\n          while (i--) {\n            node = nodes[i];\n\n            if (!node.parent) {\n              continue;\n            }\n\n            realElmName = node.attr(name);\n            realElm = new global$8(realElmName, 1);\n\n            if (realElmName !== 'audio' && realElmName !== 'script') {\n              className = node.attr('class');\n\n              if (className && className.indexOf('mce-preview-object') !== -1) {\n                realElm.attr({\n                  width: node.firstChild.attr('width'),\n                  height: node.firstChild.attr('height')\n                });\n              } else {\n                realElm.attr({\n                  width: node.attr('width'),\n                  height: node.attr('height')\n                });\n              }\n            }\n\n            realElm.attr({\n              style: node.attr('style')\n            });\n            attribs = node.attributes;\n            ai = attribs.length;\n\n            while (ai--) {\n              var attrName = attribs[ai].name;\n\n              if (attrName.indexOf('data-mce-p-') === 0) {\n                realElm.attr(attrName.substr(11), attribs[ai].value);\n              }\n            }\n\n            if (realElmName === 'script') {\n              realElm.attr('type', 'text/javascript');\n            }\n\n            innerHtml = node.attr('data-mce-html');\n\n            if (innerHtml) {\n              innerNode = new global$8('#text', 3);\n              innerNode.raw = true;\n              innerNode.value = $_aa29lrhmjnlpb28x.sanitize(editor, unescape(innerHtml));\n              realElm.append(innerNode);\n            }\n\n            node.replace(realElm);\n          }\n        });\n      });\n      editor.on('setContent', function () {\n        editor.$('span.mce-preview-object').each(function (index, elm) {\n          var $elm = editor.$(elm);\n\n          if ($elm.find('span.mce-shim', elm).length === 0) {\n            $elm.append('<span class=\"mce-shim\"></span>');\n          }\n        });\n      });\n    };\n\n    var $_c08hpjhjjnlpb28q = {\n      setup: setup\n    };\n\n    var setup$1 = function (editor) {\n      editor.on('ResolveName', function (e) {\n        var name;\n\n        if (e.target.nodeType === 1 && (name = e.target.getAttribute('data-mce-object'))) {\n          e.name = name;\n        }\n      });\n    };\n\n    var $_3gc5c2hnjnlpb28z = {\n      setup: setup$1\n    };\n\n    var setup$2 = function (editor) {\n      editor.on('click keyup', function () {\n        var selectedNode = editor.selection.getNode();\n\n        if (selectedNode && editor.dom.hasClass(selectedNode, 'mce-preview-object')) {\n          if (editor.dom.getAttrib(selectedNode, 'data-mce-selected')) {\n            selectedNode.setAttribute('data-mce-selected', '2');\n          }\n        }\n      });\n      editor.on('ObjectSelected', function (e) {\n        var objectType = e.target.getAttribute('data-mce-object');\n\n        if (objectType === 'audio' || objectType === 'script') {\n          e.preventDefault();\n        }\n      });\n      editor.on('objectResized', function (e) {\n        var target = e.target;\n        var html;\n\n        if (target.getAttribute('data-mce-object')) {\n          html = target.getAttribute('data-mce-html');\n\n          if (html) {\n            html = unescape(html);\n            target.setAttribute('data-mce-html', escape($_2h712hhdjnlpb28f.updateHtml(html, {\n              width: e.width,\n              height: e.height\n            })));\n          }\n        }\n      });\n    };\n\n    var $_764l5hhojnlpb290 = {\n      setup: setup$2\n    };\n\n    var register$1 = function (editor) {\n      editor.addButton('media', {\n        tooltip: 'Insert/edit media',\n        cmd: 'mceMedia',\n        stateSelector: ['img[data-mce-object]', 'span[data-mce-object]', 'div[data-ephox-embed-iri]']\n      });\n      editor.addMenuItem('media', {\n        icon: 'media',\n        text: 'Media',\n        cmd: 'mceMedia',\n        context: 'insert',\n        prependToContext: true\n      });\n    };\n\n    var $_3g78wahpjnlpb291 = {\n      register: register$1\n    };\n    global.add('media', function (editor) {\n      $_55m8chhijnlpb28o.register(editor);\n      $_3g78wahpjnlpb291.register(editor);\n      $_3gc5c2hnjnlpb28z.setup(editor);\n      $_c08hpjhjjnlpb28q.setup(editor);\n      $_764l5hhojnlpb290.setup(editor);\n      return $_2j6fosgzjnlpb27k.get(editor);\n    });\n\n    function Plugin() {}\n\n    return Plugin;\n  }();\n})();",{"version":3,"sources":["/Users/shanliguo/Documents/workstudy/vue-form-making/src/lib/tinymce/plugins/media/plugin.js"],"names":["media","global","tinymce","util","Tools","resolve","global$1","global$2","getScripts","editor","getParam","getAudioTemplateCallback","getVideoTemplateCallback","hasLiveEmbeds","shouldFilterHtml","getUrlResolver","hasAltSource","hasPoster","hasDimensions","$_4lfblsh3jnlpb27u","global$3","global$4","getVideoScriptMatch","prefixes","src","i","length","indexOf","filter","$_6kmpndh7jnlpb27z","trimPx","value","replace","addPx","test","getSize","name","elm","style","setSize","$_1vq9sh8jnlpb280","getMaxWidth","getMaxHeight","setMaxWidth","setMaxHeight","DOM","getEphoxEmbedIri","getAttrib","isEphoxEmbed","html","fragment","createFragment","firstChild","htmlToDataSax","data","validate","allow_conditional_comments","special","start","attrs","source1","map","movie","type","extend","videoScript","width","height","source2","poster","parse","ephoxEmbedHtmlToData","div","htmlToData","$_7mert0h4jnlpb27v","global$5","guess","url","mimes","mp3","wav","mp4","webm","ogg","swf","fileEnd","toLowerCase","split","pop","mime","$_87k6mahcjnlpb28d","global$6","global$7","DOM$1","setAttributes","updatedAttrs","attr","splice","push","normalizeHtml","writer","parser","getContent","updateHtmlSax","updateAll","sourceCount","hasImage","comment","text","cdata","raw","empty","undefined","end","index","imgAttrs","isEphoxEmbed$1","updateEphoxEmbed","outerHTML","updateHtml","$_2h712hhdjnlpb28f","urlPatterns","regex","w","h","allowFullscreen","getUrl","pattern","match","exec","newUrl","_loop_1","matchPattern","getIframeHtml","getFlashHtml","getAudioHtml","audioTemplateCallback","source2mime","getVideoHtml","videoTemplateCallback","source1mime","getScriptHtml","dataToHtml","dataIn","embed","convertURL","each","key","dom","encode","$_bjso6ohbjnlpb284","cache","embedPromise","handler","res","rej","wrappedResolve","response","defaultPromise","loadedData","getEmbedHtml","embedHandler","isCached","hasOwnProperty","$_3q0cc6h9jnlpb281","doSyncSize","widthCtrl","heightCtrl","state","set","doSizeControls","win","f","find","constrained","checked","doUpdateSize","isContrained","oldWidth","get","oldHeight","newWidth","newHeight","Math","round","isNaN","syncSize","updateSize","createUi","onChange","recalcSize","label","layout","align","spacing","items","maxLength","size","onchange","ariaLabel","$_s3mrghhjnlpb28m","embedChange","ie","handleError","error","errorMessage","msg","notificationManager","open","getData","element","selection","getNode","dataEmbed","getAttribute","serializer","serialize","getSource","addEmbedHtml","fromJSON","selectPlaceholder","beforeObjects","y","afterObjects","select","handleInsert","insertContent","nodeChanged","submitForm","toJSON","then","catch","populateMeta","meta","showDialog","generalFormItems","filetype","autofocus","onpaste","setTimeout","e","onbeforecall","advancedFormItems","reserialise","update","control","embedTextBox","id","flex","multiline","rows","updateValueOnChange","parent","body","title","direction","padding","forId","windowManager","bodyType","onSubmit","$_ejovioh0jnlpb27m","$_2j6fosgzjnlpb27k","register","addCommand","$_55m8chhijnlpb28o","global$8","sanitize","blocked","serializeStyle","parseStyle","$_aa29lrhmjnlpb28x","createPlaceholderNode","node","placeHolder","shortEnded","retainAttributesAndInnerHtml","transparentSrc","createPreviewIframeNode","previewWrapper","previewNode","shimNode","allowfullscreen","class","frameborder","append","sourceNode","targetNode","attrName","attrValue","attribs","ai","innerHtml","attributes","escape","isWithinEphoxEmbed","placeHolderConverter","nodes","toString","ceFalse","$_fw6tyyhljnlpb28t","setup","on","specialElements","schema","getSpecialElements","RegExp","boolAttrs","getBoolAttrs","addNodeFilter","addAttributeFilter","realElm","innerNode","realElmName","className","substr","unescape","$","$elm","$_c08hpjhjjnlpb28q","setup$1","target","nodeType","$_3gc5c2hnjnlpb28z","setup$2","selectedNode","hasClass","setAttribute","objectType","preventDefault","$_764l5hhojnlpb290","register$1","addButton","tooltip","cmd","stateSelector","addMenuItem","icon","context","prependToContext","$_3g78wahpjnlpb291","add","Plugin"],"mappings":"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","sourcesContent":["(function () {\nvar media = (function () {\n  'use strict';\n\n  var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var global$1 = tinymce.util.Tools.resolve('tinymce.Env');\n\n  var global$2 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var getScripts = function (editor) {\n    return editor.getParam('media_scripts');\n  };\n  var getAudioTemplateCallback = function (editor) {\n    return editor.getParam('audio_template_callback');\n  };\n  var getVideoTemplateCallback = function (editor) {\n    return editor.getParam('video_template_callback');\n  };\n  var hasLiveEmbeds = function (editor) {\n    return editor.getParam('media_live_embeds', true);\n  };\n  var shouldFilterHtml = function (editor) {\n    return editor.getParam('media_filter_html', true);\n  };\n  var getUrlResolver = function (editor) {\n    return editor.getParam('media_url_resolver');\n  };\n  var hasAltSource = function (editor) {\n    return editor.getParam('media_alt_source', true);\n  };\n  var hasPoster = function (editor) {\n    return editor.getParam('media_poster', true);\n  };\n  var hasDimensions = function (editor) {\n    return editor.getParam('media_dimensions', true);\n  };\n  var $_4lfblsh3jnlpb27u = {\n    getScripts: getScripts,\n    getAudioTemplateCallback: getAudioTemplateCallback,\n    getVideoTemplateCallback: getVideoTemplateCallback,\n    hasLiveEmbeds: hasLiveEmbeds,\n    shouldFilterHtml: shouldFilterHtml,\n    getUrlResolver: getUrlResolver,\n    hasAltSource: hasAltSource,\n    hasPoster: hasPoster,\n    hasDimensions: hasDimensions\n  };\n\n  var global$3 = tinymce.util.Tools.resolve('tinymce.html.SaxParser');\n\n  var global$4 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n  var getVideoScriptMatch = function (prefixes, src) {\n    if (prefixes) {\n      for (var i = 0; i < prefixes.length; i++) {\n        if (src.indexOf(prefixes[i].filter) !== -1) {\n          return prefixes[i];\n        }\n      }\n    }\n  };\n  var $_6kmpndh7jnlpb27z = { getVideoScriptMatch: getVideoScriptMatch };\n\n  var trimPx = function (value) {\n    return value.replace(/px$/, '');\n  };\n  var addPx = function (value) {\n    return /^[0-9.]+$/.test(value) ? value + 'px' : value;\n  };\n  var getSize = function (name) {\n    return function (elm) {\n      return elm ? trimPx(elm.style[name]) : '';\n    };\n  };\n  var setSize = function (name) {\n    return function (elm, value) {\n      if (elm) {\n        elm.style[name] = addPx(value);\n      }\n    };\n  };\n  var $_1vq9sh8jnlpb280 = {\n    getMaxWidth: getSize('maxWidth'),\n    getMaxHeight: getSize('maxHeight'),\n    setMaxWidth: setSize('maxWidth'),\n    setMaxHeight: setSize('maxHeight')\n  };\n\n  var DOM = global$4.DOM;\n  var getEphoxEmbedIri = function (elm) {\n    return DOM.getAttrib(elm, 'data-ephox-embed-iri');\n  };\n  var isEphoxEmbed = function (html) {\n    var fragment = DOM.createFragment(html);\n    return getEphoxEmbedIri(fragment.firstChild) !== '';\n  };\n  var htmlToDataSax = function (prefixes, html) {\n    var data = {};\n    global$3({\n      validate: false,\n      allow_conditional_comments: true,\n      special: 'script,noscript',\n      start: function (name, attrs) {\n        if (!data.source1 && name === 'param') {\n          data.source1 = attrs.map.movie;\n        }\n        if (name === 'iframe' || name === 'object' || name === 'embed' || name === 'video' || name === 'audio') {\n          if (!data.type) {\n            data.type = name;\n          }\n          data = global$2.extend(attrs.map, data);\n        }\n        if (name === 'script') {\n          var videoScript = $_6kmpndh7jnlpb27z.getVideoScriptMatch(prefixes, attrs.map.src);\n          if (!videoScript) {\n            return;\n          }\n          data = {\n            type: 'script',\n            source1: attrs.map.src,\n            width: videoScript.width,\n            height: videoScript.height\n          };\n        }\n        if (name === 'source') {\n          if (!data.source1) {\n            data.source1 = attrs.map.src;\n          } else if (!data.source2) {\n            data.source2 = attrs.map.src;\n          }\n        }\n        if (name === 'img' && !data.poster) {\n          data.poster = attrs.map.src;\n        }\n      }\n    }).parse(html);\n    data.source1 = data.source1 || data.src || data.data;\n    data.source2 = data.source2 || '';\n    data.poster = data.poster || '';\n    return data;\n  };\n  var ephoxEmbedHtmlToData = function (html) {\n    var fragment = DOM.createFragment(html);\n    var div = fragment.firstChild;\n    return {\n      type: 'ephox-embed-iri',\n      source1: getEphoxEmbedIri(div),\n      source2: '',\n      poster: '',\n      width: $_1vq9sh8jnlpb280.getMaxWidth(div),\n      height: $_1vq9sh8jnlpb280.getMaxHeight(div)\n    };\n  };\n  var htmlToData = function (prefixes, html) {\n    return isEphoxEmbed(html) ? ephoxEmbedHtmlToData(html) : htmlToDataSax(prefixes, html);\n  };\n  var $_7mert0h4jnlpb27v = { htmlToData: htmlToData };\n\n  var global$5 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n  var guess = function (url) {\n    var mimes = {\n      mp3: 'audio/mpeg',\n      wav: 'audio/wav',\n      mp4: 'video/mp4',\n      webm: 'video/webm',\n      ogg: 'video/ogg',\n      swf: 'application/x-shockwave-flash'\n    };\n    var fileEnd = url.toLowerCase().split('.').pop();\n    var mime = mimes[fileEnd];\n    return mime ? mime : '';\n  };\n  var $_87k6mahcjnlpb28d = { guess: guess };\n\n  var global$6 = tinymce.util.Tools.resolve('tinymce.html.Writer');\n\n  var global$7 = tinymce.util.Tools.resolve('tinymce.html.Schema');\n\n  var DOM$1 = global$4.DOM;\n  var setAttributes = function (attrs, updatedAttrs) {\n    var name;\n    var i;\n    var value;\n    var attr;\n    for (name in updatedAttrs) {\n      value = '' + updatedAttrs[name];\n      if (attrs.map[name]) {\n        i = attrs.length;\n        while (i--) {\n          attr = attrs[i];\n          if (attr.name === name) {\n            if (value) {\n              attrs.map[name] = value;\n              attr.value = value;\n            } else {\n              delete attrs.map[name];\n              attrs.splice(i, 1);\n            }\n          }\n        }\n      } else if (value) {\n        attrs.push({\n          name: name,\n          value: value\n        });\n        attrs.map[name] = value;\n      }\n    }\n  };\n  var normalizeHtml = function (html) {\n    var writer = global$6();\n    var parser = global$3(writer);\n    parser.parse(html);\n    return writer.getContent();\n  };\n  var updateHtmlSax = function (html, data, updateAll) {\n    var writer = global$6();\n    var sourceCount = 0;\n    var hasImage;\n    global$3({\n      validate: false,\n      allow_conditional_comments: true,\n      special: 'script,noscript',\n      comment: function (text) {\n        writer.comment(text);\n      },\n      cdata: function (text) {\n        writer.cdata(text);\n      },\n      text: function (text, raw) {\n        writer.text(text, raw);\n      },\n      start: function (name, attrs, empty) {\n        switch (name) {\n        case 'video':\n        case 'object':\n        case 'embed':\n        case 'img':\n        case 'iframe':\n          if (data.height !== undefined && data.width !== undefined) {\n            setAttributes(attrs, {\n              width: data.width,\n              height: data.height\n            });\n          }\n          break;\n        }\n        if (updateAll) {\n          switch (name) {\n          case 'video':\n            setAttributes(attrs, {\n              poster: data.poster,\n              src: ''\n            });\n            if (data.source2) {\n              setAttributes(attrs, { src: '' });\n            }\n            break;\n          case 'iframe':\n            setAttributes(attrs, { src: data.source1 });\n            break;\n          case 'source':\n            sourceCount++;\n            if (sourceCount <= 2) {\n              setAttributes(attrs, {\n                src: data['source' + sourceCount],\n                type: data['source' + sourceCount + 'mime']\n              });\n              if (!data['source' + sourceCount]) {\n                return;\n              }\n            }\n            break;\n          case 'img':\n            if (!data.poster) {\n              return;\n            }\n            hasImage = true;\n            break;\n          }\n        }\n        writer.start(name, attrs, empty);\n      },\n      end: function (name) {\n        if (name === 'video' && updateAll) {\n          for (var index = 1; index <= 2; index++) {\n            if (data['source' + index]) {\n              var attrs = [];\n              attrs.map = {};\n              if (sourceCount < index) {\n                setAttributes(attrs, {\n                  src: data['source' + index],\n                  type: data['source' + index + 'mime']\n                });\n                writer.start('source', attrs, true);\n              }\n            }\n          }\n        }\n        if (data.poster && name === 'object' && updateAll && !hasImage) {\n          var imgAttrs = [];\n          imgAttrs.map = {};\n          setAttributes(imgAttrs, {\n            src: data.poster,\n            width: data.width,\n            height: data.height\n          });\n          writer.start('img', imgAttrs, true);\n        }\n        writer.end(name);\n      }\n    }, global$7({})).parse(html);\n    return writer.getContent();\n  };\n  var isEphoxEmbed$1 = function (html) {\n    var fragment = DOM$1.createFragment(html);\n    return DOM$1.getAttrib(fragment.firstChild, 'data-ephox-embed-iri') !== '';\n  };\n  var updateEphoxEmbed = function (html, data) {\n    var fragment = DOM$1.createFragment(html);\n    var div = fragment.firstChild;\n    $_1vq9sh8jnlpb280.setMaxWidth(div, data.width);\n    $_1vq9sh8jnlpb280.setMaxHeight(div, data.height);\n    return normalizeHtml(div.outerHTML);\n  };\n  var updateHtml = function (html, data, updateAll) {\n    return isEphoxEmbed$1(html) ? updateEphoxEmbed(html, data) : updateHtmlSax(html, data, updateAll);\n  };\n  var $_2h712hhdjnlpb28f = { updateHtml: updateHtml };\n\n  var urlPatterns = [\n    {\n      regex: /youtu\\.be\\/([\\w\\-_\\?&=.]+)/i,\n      type: 'iframe',\n      w: 560,\n      h: 314,\n      url: '//www.youtube.com/embed/$1',\n      allowFullscreen: true\n    },\n    {\n      regex: /youtube\\.com(.+)v=([^&]+)(&([a-z0-9&=\\-_]+))?/i,\n      type: 'iframe',\n      w: 560,\n      h: 314,\n      url: '//www.youtube.com/embed/$2?$4',\n      allowFullscreen: true\n    },\n    {\n      regex: /youtube.com\\/embed\\/([a-z0-9\\?&=\\-_]+)/i,\n      type: 'iframe',\n      w: 560,\n      h: 314,\n      url: '//www.youtube.com/embed/$1',\n      allowFullscreen: true\n    },\n    {\n      regex: /vimeo\\.com\\/([0-9]+)/,\n      type: 'iframe',\n      w: 425,\n      h: 350,\n      url: '//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc',\n      allowFullscreen: true\n    },\n    {\n      regex: /vimeo\\.com\\/(.*)\\/([0-9]+)/,\n      type: 'iframe',\n      w: 425,\n      h: 350,\n      url: '//player.vimeo.com/video/$2?title=0&amp;byline=0',\n      allowFullscreen: true\n    },\n    {\n      regex: /maps\\.google\\.([a-z]{2,3})\\/maps\\/(.+)msid=(.+)/,\n      type: 'iframe',\n      w: 425,\n      h: 350,\n      url: '//maps.google.com/maps/ms?msid=$2&output=embed\"',\n      allowFullscreen: false\n    },\n    {\n      regex: /dailymotion\\.com\\/video\\/([^_]+)/,\n      type: 'iframe',\n      w: 480,\n      h: 270,\n      url: '//www.dailymotion.com/embed/video/$1',\n      allowFullscreen: true\n    },\n    {\n      regex: /dai\\.ly\\/([^_]+)/,\n      type: 'iframe',\n      w: 480,\n      h: 270,\n      url: '//www.dailymotion.com/embed/video/$1',\n      allowFullscreen: true\n    }\n  ];\n  var getUrl = function (pattern, url) {\n    var match = pattern.regex.exec(url);\n    var newUrl = pattern.url;\n    var _loop_1 = function (i) {\n      newUrl = newUrl.replace('$' + i, function () {\n        return match[i] ? match[i] : '';\n      });\n    };\n    for (var i = 0; i < match.length; i++) {\n      _loop_1(i);\n    }\n    return newUrl.replace(/\\?$/, '');\n  };\n  var matchPattern = function (url) {\n    var pattern = urlPatterns.filter(function (pattern) {\n      return pattern.regex.test(url);\n    });\n    if (pattern.length > 0) {\n      return global$2.extend({}, pattern[0], { url: getUrl(pattern[0], url) });\n    } else {\n      return null;\n    }\n  };\n\n  var getIframeHtml = function (data) {\n    var allowFullscreen = data.allowFullscreen ? ' allowFullscreen=\"1\"' : '';\n    return '<iframe src=\"' + data.source1 + '\" width=\"' + data.width + '\" height=\"' + data.height + '\"' + allowFullscreen + '></iframe>';\n  };\n  var getFlashHtml = function (data) {\n    var html = '<object data=\"' + data.source1 + '\" width=\"' + data.width + '\" height=\"' + data.height + '\" type=\"application/x-shockwave-flash\">';\n    if (data.poster) {\n      html += '<img src=\"' + data.poster + '\" width=\"' + data.width + '\" height=\"' + data.height + '\" />';\n    }\n    html += '</object>';\n    return html;\n  };\n  var getAudioHtml = function (data, audioTemplateCallback) {\n    if (audioTemplateCallback) {\n      return audioTemplateCallback(data);\n    } else {\n      return '<audio controls=\"controls\" src=\"' + data.source1 + '\">' + (data.source2 ? '\\n<source src=\"' + data.source2 + '\"' + (data.source2mime ? ' type=\"' + data.source2mime + '\"' : '') + ' />\\n' : '') + '</audio>';\n    }\n  };\n  var getVideoHtml = function (data, videoTemplateCallback) {\n    if (videoTemplateCallback) {\n      return videoTemplateCallback(data);\n    } else {\n      return '<video width=\"' + data.width + '\" height=\"' + data.height + '\"' + (data.poster ? ' poster=\"' + data.poster + '\"' : '') + ' controls=\"controls\">\\n' + '<source src=\"' + data.source1 + '\"' + (data.source1mime ? ' type=\"' + data.source1mime + '\"' : '') + ' />\\n' + (data.source2 ? '<source src=\"' + data.source2 + '\"' + (data.source2mime ? ' type=\"' + data.source2mime + '\"' : '') + ' />\\n' : '') + '</video>';\n    }\n  };\n  var getScriptHtml = function (data) {\n    return '<script src=\"' + data.source1 + '\"></script>';\n  };\n  var dataToHtml = function (editor, dataIn) {\n    var data = global$2.extend({}, dataIn);\n    if (!data.source1) {\n      global$2.extend(data, $_7mert0h4jnlpb27v.htmlToData($_4lfblsh3jnlpb27u.getScripts(editor), data.embed));\n      if (!data.source1) {\n        return '';\n      }\n    }\n    if (!data.source2) {\n      data.source2 = '';\n    }\n    if (!data.poster) {\n      data.poster = '';\n    }\n    data.source1 = editor.convertURL(data.source1, 'source');\n    data.source2 = editor.convertURL(data.source2, 'source');\n    data.source1mime = $_87k6mahcjnlpb28d.guess(data.source1);\n    data.source2mime = $_87k6mahcjnlpb28d.guess(data.source2);\n    data.poster = editor.convertURL(data.poster, 'poster');\n    var pattern = matchPattern(data.source1);\n    if (pattern) {\n      data.source1 = pattern.url;\n      data.type = pattern.type;\n      data.allowFullscreen = pattern.allowFullscreen;\n      data.width = data.width || pattern.w;\n      data.height = data.height || pattern.h;\n    }\n    if (data.embed) {\n      return $_2h712hhdjnlpb28f.updateHtml(data.embed, data, true);\n    } else {\n      var videoScript = $_6kmpndh7jnlpb27z.getVideoScriptMatch($_4lfblsh3jnlpb27u.getScripts(editor), data.source1);\n      if (videoScript) {\n        data.type = 'script';\n        data.width = videoScript.width;\n        data.height = videoScript.height;\n      }\n      var audioTemplateCallback = $_4lfblsh3jnlpb27u.getAudioTemplateCallback(editor);\n      var videoTemplateCallback = $_4lfblsh3jnlpb27u.getVideoTemplateCallback(editor);\n      data.width = data.width || 300;\n      data.height = data.height || 150;\n      global$2.each(data, function (value, key) {\n        data[key] = editor.dom.encode(value);\n      });\n      if (data.type === 'iframe') {\n        return getIframeHtml(data);\n      } else if (data.source1mime === 'application/x-shockwave-flash') {\n        return getFlashHtml(data);\n      } else if (data.source1mime.indexOf('audio') !== -1) {\n        return getAudioHtml(data, audioTemplateCallback);\n      } else if (data.type === 'script') {\n        return getScriptHtml(data);\n      } else {\n        return getVideoHtml(data, videoTemplateCallback);\n      }\n    }\n  };\n  var $_bjso6ohbjnlpb284 = { dataToHtml: dataToHtml };\n\n  var cache = {};\n  var embedPromise = function (data, dataToHtml, handler) {\n    return new global$5(function (res, rej) {\n      var wrappedResolve = function (response) {\n        if (response.html) {\n          cache[data.source1] = response;\n        }\n        return res({\n          url: data.source1,\n          html: response.html ? response.html : dataToHtml(data)\n        });\n      };\n      if (cache[data.source1]) {\n        wrappedResolve(cache[data.source1]);\n      } else {\n        handler({ url: data.source1 }, wrappedResolve, rej);\n      }\n    });\n  };\n  var defaultPromise = function (data, dataToHtml) {\n    return new global$5(function (res) {\n      res({\n        html: dataToHtml(data),\n        url: data.source1\n      });\n    });\n  };\n  var loadedData = function (editor) {\n    return function (data) {\n      return $_bjso6ohbjnlpb284.dataToHtml(editor, data);\n    };\n  };\n  var getEmbedHtml = function (editor, data) {\n    var embedHandler = $_4lfblsh3jnlpb27u.getUrlResolver(editor);\n    return embedHandler ? embedPromise(data, loadedData(editor), embedHandler) : defaultPromise(data, loadedData(editor));\n  };\n  var isCached = function (url) {\n    return cache.hasOwnProperty(url);\n  };\n  var $_3q0cc6h9jnlpb281 = {\n    getEmbedHtml: getEmbedHtml,\n    isCached: isCached\n  };\n\n  var doSyncSize = function (widthCtrl, heightCtrl) {\n    widthCtrl.state.set('oldVal', widthCtrl.value());\n    heightCtrl.state.set('oldVal', heightCtrl.value());\n  };\n  var doSizeControls = function (win, f) {\n    var widthCtrl = win.find('#width')[0];\n    var heightCtrl = win.find('#height')[0];\n    var constrained = win.find('#constrain')[0];\n    if (widthCtrl && heightCtrl && constrained) {\n      f(widthCtrl, heightCtrl, constrained.checked());\n    }\n  };\n  var doUpdateSize = function (widthCtrl, heightCtrl, isContrained) {\n    var oldWidth = widthCtrl.state.get('oldVal');\n    var oldHeight = heightCtrl.state.get('oldVal');\n    var newWidth = widthCtrl.value();\n    var newHeight = heightCtrl.value();\n    if (isContrained && oldWidth && oldHeight && newWidth && newHeight) {\n      if (newWidth !== oldWidth) {\n        newHeight = Math.round(newWidth / oldWidth * newHeight);\n        if (!isNaN(newHeight)) {\n          heightCtrl.value(newHeight);\n        }\n      } else {\n        newWidth = Math.round(newHeight / oldHeight * newWidth);\n        if (!isNaN(newWidth)) {\n          widthCtrl.value(newWidth);\n        }\n      }\n    }\n    doSyncSize(widthCtrl, heightCtrl);\n  };\n  var syncSize = function (win) {\n    doSizeControls(win, doSyncSize);\n  };\n  var updateSize = function (win) {\n    doSizeControls(win, doUpdateSize);\n  };\n  var createUi = function (onChange) {\n    var recalcSize = function () {\n      onChange(function (win) {\n        updateSize(win);\n      });\n    };\n    return {\n      type: 'container',\n      label: 'Dimensions',\n      layout: 'flex',\n      align: 'center',\n      spacing: 5,\n      items: [\n        {\n          name: 'width',\n          type: 'textbox',\n          maxLength: 5,\n          size: 5,\n          onchange: recalcSize,\n          ariaLabel: 'Width'\n        },\n        {\n          type: 'label',\n          text: 'x'\n        },\n        {\n          name: 'height',\n          type: 'textbox',\n          maxLength: 5,\n          size: 5,\n          onchange: recalcSize,\n          ariaLabel: 'Height'\n        },\n        {\n          name: 'constrain',\n          type: 'checkbox',\n          checked: true,\n          text: 'Constrain proportions'\n        }\n      ]\n    };\n  };\n  var $_s3mrghhjnlpb28m = {\n    createUi: createUi,\n    syncSize: syncSize,\n    updateSize: updateSize\n  };\n\n  var embedChange = global$1.ie && global$1.ie <= 8 ? 'onChange' : 'onInput';\n  var handleError = function (editor) {\n    return function (error) {\n      var errorMessage = error && error.msg ? 'Media embed handler error: ' + error.msg : 'Media embed handler threw unknown error.';\n      editor.notificationManager.open({\n        type: 'error',\n        text: errorMessage\n      });\n    };\n  };\n  var getData = function (editor) {\n    var element = editor.selection.getNode();\n    var dataEmbed = element.getAttribute('data-ephox-embed-iri');\n    if (dataEmbed) {\n      return {\n        'source1': dataEmbed,\n        'data-ephox-embed-iri': dataEmbed,\n        'width': $_1vq9sh8jnlpb280.getMaxWidth(element),\n        'height': $_1vq9sh8jnlpb280.getMaxHeight(element)\n      };\n    }\n    return element.getAttribute('data-mce-object') ? $_7mert0h4jnlpb27v.htmlToData($_4lfblsh3jnlpb27u.getScripts(editor), editor.serializer.serialize(element, { selection: true })) : {};\n  };\n  var getSource = function (editor) {\n    var elm = editor.selection.getNode();\n    if (elm.getAttribute('data-mce-object') || elm.getAttribute('data-ephox-embed-iri')) {\n      return editor.selection.getContent();\n    }\n  };\n  var addEmbedHtml = function (win, editor) {\n    return function (response) {\n      var html = response.html;\n      var embed = win.find('#embed')[0];\n      var data = global$2.extend($_7mert0h4jnlpb27v.htmlToData($_4lfblsh3jnlpb27u.getScripts(editor), html), { source1: response.url });\n      win.fromJSON(data);\n      if (embed) {\n        embed.value(html);\n        $_s3mrghhjnlpb28m.updateSize(win);\n      }\n    };\n  };\n  var selectPlaceholder = function (editor, beforeObjects) {\n    var i;\n    var y;\n    var afterObjects = editor.dom.select('img[data-mce-object]');\n    for (i = 0; i < beforeObjects.length; i++) {\n      for (y = afterObjects.length - 1; y >= 0; y--) {\n        if (beforeObjects[i] === afterObjects[y]) {\n          afterObjects.splice(y, 1);\n        }\n      }\n    }\n    editor.selection.select(afterObjects[0]);\n  };\n  var handleInsert = function (editor, html) {\n    var beforeObjects = editor.dom.select('img[data-mce-object]');\n    editor.insertContent(html);\n    selectPlaceholder(editor, beforeObjects);\n    editor.nodeChanged();\n  };\n  var submitForm = function (win, editor) {\n    var data = win.toJSON();\n    data.embed = $_2h712hhdjnlpb28f.updateHtml(data.embed, data);\n    if (data.embed && $_3q0cc6h9jnlpb281.isCached(data.source1)) {\n      handleInsert(editor, data.embed);\n    } else {\n      $_3q0cc6h9jnlpb281.getEmbedHtml(editor, data).then(function (response) {\n        handleInsert(editor, response.html);\n      }).catch(handleError(editor));\n    }\n  };\n  var populateMeta = function (win, meta) {\n    global$2.each(meta, function (value, key) {\n      win.find('#' + key).value(value);\n    });\n  };\n  var showDialog = function (editor) {\n    var win;\n    var data;\n    var generalFormItems = [{\n        name: 'source1',\n        type: 'filepicker',\n        filetype: 'media',\n        size: 40,\n        autofocus: true,\n        label: 'Source',\n        onpaste: function () {\n          setTimeout(function () {\n            $_3q0cc6h9jnlpb281.getEmbedHtml(editor, win.toJSON()).then(addEmbedHtml(win, editor)).catch(handleError(editor));\n          }, 1);\n        },\n        onchange: function (e) {\n          $_3q0cc6h9jnlpb281.getEmbedHtml(editor, win.toJSON()).then(addEmbedHtml(win, editor)).catch(handleError(editor));\n          populateMeta(win, e.meta);\n        },\n        onbeforecall: function (e) {\n          e.meta = win.toJSON();\n        }\n      }];\n    var advancedFormItems = [];\n    var reserialise = function (update) {\n      update(win);\n      data = win.toJSON();\n      win.find('#embed').value($_2h712hhdjnlpb28f.updateHtml(data.embed, data));\n    };\n    if ($_4lfblsh3jnlpb27u.hasAltSource(editor)) {\n      advancedFormItems.push({\n        name: 'source2',\n        type: 'filepicker',\n        filetype: 'media',\n        size: 40,\n        label: 'Alternative source'\n      });\n    }\n    if ($_4lfblsh3jnlpb27u.hasPoster(editor)) {\n      advancedFormItems.push({\n        name: 'poster',\n        type: 'filepicker',\n        filetype: 'image',\n        size: 40,\n        label: 'Poster'\n      });\n    }\n    if ($_4lfblsh3jnlpb27u.hasDimensions(editor)) {\n      var control = $_s3mrghhjnlpb28m.createUi(reserialise);\n      generalFormItems.push(control);\n    }\n    data = getData(editor);\n    var embedTextBox = {\n      id: 'mcemediasource',\n      type: 'textbox',\n      flex: 1,\n      name: 'embed',\n      value: getSource(editor),\n      multiline: true,\n      rows: 5,\n      label: 'Source'\n    };\n    var updateValueOnChange = function () {\n      data = global$2.extend({}, $_7mert0h4jnlpb27v.htmlToData($_4lfblsh3jnlpb27u.getScripts(editor), this.value()));\n      this.parent().parent().fromJSON(data);\n    };\n    embedTextBox[embedChange] = updateValueOnChange;\n    var body = [\n      {\n        title: 'General',\n        type: 'form',\n        items: generalFormItems\n      },\n      {\n        title: 'Embed',\n        type: 'container',\n        layout: 'flex',\n        direction: 'column',\n        align: 'stretch',\n        padding: 10,\n        spacing: 10,\n        items: [\n          {\n            type: 'label',\n            text: 'Paste your embed code below:',\n            forId: 'mcemediasource'\n          },\n          embedTextBox\n        ]\n      }\n    ];\n    if (advancedFormItems.length > 0) {\n      body.push({\n        title: 'Advanced',\n        type: 'form',\n        items: advancedFormItems\n      });\n    }\n    win = editor.windowManager.open({\n      title: 'Insert/edit media',\n      data: data,\n      bodyType: 'tabpanel',\n      body: body,\n      onSubmit: function () {\n        $_s3mrghhjnlpb28m.updateSize(win);\n        submitForm(win, editor);\n      }\n    });\n    $_s3mrghhjnlpb28m.syncSize(win);\n  };\n  var $_ejovioh0jnlpb27m = { showDialog: showDialog };\n\n  var get = function (editor) {\n    var showDialog = function () {\n      $_ejovioh0jnlpb27m.showDialog(editor);\n    };\n    return { showDialog: showDialog };\n  };\n  var $_2j6fosgzjnlpb27k = { get: get };\n\n  var register = function (editor) {\n    var showDialog = function () {\n      $_ejovioh0jnlpb27m.showDialog(editor);\n    };\n    editor.addCommand('mceMedia', showDialog);\n  };\n  var $_55m8chhijnlpb28o = { register: register };\n\n  var global$8 = tinymce.util.Tools.resolve('tinymce.html.Node');\n\n  var sanitize = function (editor, html) {\n    if ($_4lfblsh3jnlpb27u.shouldFilterHtml(editor) === false) {\n      return html;\n    }\n    var writer = global$6();\n    var blocked;\n    global$3({\n      validate: false,\n      allow_conditional_comments: false,\n      special: 'script,noscript',\n      comment: function (text) {\n        writer.comment(text);\n      },\n      cdata: function (text) {\n        writer.cdata(text);\n      },\n      text: function (text, raw) {\n        writer.text(text, raw);\n      },\n      start: function (name, attrs, empty) {\n        blocked = true;\n        if (name === 'script' || name === 'noscript') {\n          return;\n        }\n        for (var i = 0; i < attrs.length; i++) {\n          if (attrs[i].name.indexOf('on') === 0) {\n            return;\n          }\n          if (attrs[i].name === 'style') {\n            attrs[i].value = editor.dom.serializeStyle(editor.dom.parseStyle(attrs[i].value), name);\n          }\n        }\n        writer.start(name, attrs, empty);\n        blocked = false;\n      },\n      end: function (name) {\n        if (blocked) {\n          return;\n        }\n        writer.end(name);\n      }\n    }, global$7({})).parse(html);\n    return writer.getContent();\n  };\n  var $_aa29lrhmjnlpb28x = { sanitize: sanitize };\n\n  var createPlaceholderNode = function (editor, node) {\n    var placeHolder;\n    var name = node.name;\n    placeHolder = new global$8('img', 1);\n    placeHolder.shortEnded = true;\n    retainAttributesAndInnerHtml(editor, node, placeHolder);\n    placeHolder.attr({\n      'width': node.attr('width') || '300',\n      'height': node.attr('height') || (name === 'audio' ? '30' : '150'),\n      'style': node.attr('style'),\n      'src': global$1.transparentSrc,\n      'data-mce-object': name,\n      'class': 'mce-object mce-object-' + name\n    });\n    return placeHolder;\n  };\n  var createPreviewIframeNode = function (editor, node) {\n    var previewWrapper;\n    var previewNode;\n    var shimNode;\n    var name = node.name;\n    previewWrapper = new global$8('span', 1);\n    previewWrapper.attr({\n      'contentEditable': 'false',\n      'style': node.attr('style'),\n      'data-mce-object': name,\n      'class': 'mce-preview-object mce-object-' + name\n    });\n    retainAttributesAndInnerHtml(editor, node, previewWrapper);\n    previewNode = new global$8(name, 1);\n    previewNode.attr({\n      src: node.attr('src'),\n      allowfullscreen: node.attr('allowfullscreen'),\n      style: node.attr('style'),\n      class: node.attr('class'),\n      width: node.attr('width'),\n      height: node.attr('height'),\n      frameborder: '0'\n    });\n    shimNode = new global$8('span', 1);\n    shimNode.attr('class', 'mce-shim');\n    previewWrapper.append(previewNode);\n    previewWrapper.append(shimNode);\n    return previewWrapper;\n  };\n  var retainAttributesAndInnerHtml = function (editor, sourceNode, targetNode) {\n    var attrName;\n    var attrValue;\n    var attribs;\n    var ai;\n    var innerHtml;\n    attribs = sourceNode.attributes;\n    ai = attribs.length;\n    while (ai--) {\n      attrName = attribs[ai].name;\n      attrValue = attribs[ai].value;\n      if (attrName !== 'width' && attrName !== 'height' && attrName !== 'style') {\n        if (attrName === 'data' || attrName === 'src') {\n          attrValue = editor.convertURL(attrValue, attrName);\n        }\n        targetNode.attr('data-mce-p-' + attrName, attrValue);\n      }\n    }\n    innerHtml = sourceNode.firstChild && sourceNode.firstChild.value;\n    if (innerHtml) {\n      targetNode.attr('data-mce-html', escape($_aa29lrhmjnlpb28x.sanitize(editor, innerHtml)));\n      targetNode.firstChild = null;\n    }\n  };\n  var isWithinEphoxEmbed = function (node) {\n    while (node = node.parent) {\n      if (node.attr('data-ephox-embed-iri')) {\n        return true;\n      }\n    }\n    return false;\n  };\n  var placeHolderConverter = function (editor) {\n    return function (nodes) {\n      var i = nodes.length;\n      var node;\n      var videoScript;\n      while (i--) {\n        node = nodes[i];\n        if (!node.parent) {\n          continue;\n        }\n        if (node.parent.attr('data-mce-object')) {\n          continue;\n        }\n        if (node.name === 'script') {\n          videoScript = $_6kmpndh7jnlpb27z.getVideoScriptMatch($_4lfblsh3jnlpb27u.getScripts(editor), node.attr('src'));\n          if (!videoScript) {\n            continue;\n          }\n        }\n        if (videoScript) {\n          if (videoScript.width) {\n            node.attr('width', videoScript.width.toString());\n          }\n          if (videoScript.height) {\n            node.attr('height', videoScript.height.toString());\n          }\n        }\n        if (node.name === 'iframe' && $_4lfblsh3jnlpb27u.hasLiveEmbeds(editor) && global$1.ceFalse) {\n          if (!isWithinEphoxEmbed(node)) {\n            node.replace(createPreviewIframeNode(editor, node));\n          }\n        } else {\n          if (!isWithinEphoxEmbed(node)) {\n            node.replace(createPlaceholderNode(editor, node));\n          }\n        }\n      }\n    };\n  };\n  var $_fw6tyyhljnlpb28t = {\n    createPreviewIframeNode: createPreviewIframeNode,\n    createPlaceholderNode: createPlaceholderNode,\n    placeHolderConverter: placeHolderConverter\n  };\n\n  var setup = function (editor) {\n    editor.on('preInit', function () {\n      var specialElements = editor.schema.getSpecialElements();\n      global$2.each('video audio iframe object'.split(' '), function (name) {\n        specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n      });\n      var boolAttrs = editor.schema.getBoolAttrs();\n      global$2.each('webkitallowfullscreen mozallowfullscreen allowfullscreen'.split(' '), function (name) {\n        boolAttrs[name] = {};\n      });\n      editor.parser.addNodeFilter('iframe,video,audio,object,embed,script', $_fw6tyyhljnlpb28t.placeHolderConverter(editor));\n      editor.serializer.addAttributeFilter('data-mce-object', function (nodes, name) {\n        var i = nodes.length;\n        var node;\n        var realElm;\n        var ai;\n        var attribs;\n        var innerHtml;\n        var innerNode;\n        var realElmName;\n        var className;\n        while (i--) {\n          node = nodes[i];\n          if (!node.parent) {\n            continue;\n          }\n          realElmName = node.attr(name);\n          realElm = new global$8(realElmName, 1);\n          if (realElmName !== 'audio' && realElmName !== 'script') {\n            className = node.attr('class');\n            if (className && className.indexOf('mce-preview-object') !== -1) {\n              realElm.attr({\n                width: node.firstChild.attr('width'),\n                height: node.firstChild.attr('height')\n              });\n            } else {\n              realElm.attr({\n                width: node.attr('width'),\n                height: node.attr('height')\n              });\n            }\n          }\n          realElm.attr({ style: node.attr('style') });\n          attribs = node.attributes;\n          ai = attribs.length;\n          while (ai--) {\n            var attrName = attribs[ai].name;\n            if (attrName.indexOf('data-mce-p-') === 0) {\n              realElm.attr(attrName.substr(11), attribs[ai].value);\n            }\n          }\n          if (realElmName === 'script') {\n            realElm.attr('type', 'text/javascript');\n          }\n          innerHtml = node.attr('data-mce-html');\n          if (innerHtml) {\n            innerNode = new global$8('#text', 3);\n            innerNode.raw = true;\n            innerNode.value = $_aa29lrhmjnlpb28x.sanitize(editor, unescape(innerHtml));\n            realElm.append(innerNode);\n          }\n          node.replace(realElm);\n        }\n      });\n    });\n    editor.on('setContent', function () {\n      editor.$('span.mce-preview-object').each(function (index, elm) {\n        var $elm = editor.$(elm);\n        if ($elm.find('span.mce-shim', elm).length === 0) {\n          $elm.append('<span class=\"mce-shim\"></span>');\n        }\n      });\n    });\n  };\n  var $_c08hpjhjjnlpb28q = { setup: setup };\n\n  var setup$1 = function (editor) {\n    editor.on('ResolveName', function (e) {\n      var name;\n      if (e.target.nodeType === 1 && (name = e.target.getAttribute('data-mce-object'))) {\n        e.name = name;\n      }\n    });\n  };\n  var $_3gc5c2hnjnlpb28z = { setup: setup$1 };\n\n  var setup$2 = function (editor) {\n    editor.on('click keyup', function () {\n      var selectedNode = editor.selection.getNode();\n      if (selectedNode && editor.dom.hasClass(selectedNode, 'mce-preview-object')) {\n        if (editor.dom.getAttrib(selectedNode, 'data-mce-selected')) {\n          selectedNode.setAttribute('data-mce-selected', '2');\n        }\n      }\n    });\n    editor.on('ObjectSelected', function (e) {\n      var objectType = e.target.getAttribute('data-mce-object');\n      if (objectType === 'audio' || objectType === 'script') {\n        e.preventDefault();\n      }\n    });\n    editor.on('objectResized', function (e) {\n      var target = e.target;\n      var html;\n      if (target.getAttribute('data-mce-object')) {\n        html = target.getAttribute('data-mce-html');\n        if (html) {\n          html = unescape(html);\n          target.setAttribute('data-mce-html', escape($_2h712hhdjnlpb28f.updateHtml(html, {\n            width: e.width,\n            height: e.height\n          })));\n        }\n      }\n    });\n  };\n  var $_764l5hhojnlpb290 = { setup: setup$2 };\n\n  var register$1 = function (editor) {\n    editor.addButton('media', {\n      tooltip: 'Insert/edit media',\n      cmd: 'mceMedia',\n      stateSelector: [\n        'img[data-mce-object]',\n        'span[data-mce-object]',\n        'div[data-ephox-embed-iri]'\n      ]\n    });\n    editor.addMenuItem('media', {\n      icon: 'media',\n      text: 'Media',\n      cmd: 'mceMedia',\n      context: 'insert',\n      prependToContext: true\n    });\n  };\n  var $_3g78wahpjnlpb291 = { register: register$1 };\n\n  global.add('media', function (editor) {\n    $_55m8chhijnlpb28o.register(editor);\n    $_3g78wahpjnlpb291.register(editor);\n    $_3gc5c2hnjnlpb28z.setup(editor);\n    $_c08hpjhjjnlpb28q.setup(editor);\n    $_764l5hhojnlpb290.setup(editor);\n    return $_2j6fosgzjnlpb27k.get(editor);\n  });\n  function Plugin () {\n  }\n\n  return Plugin;\n\n}());\n})();\n"]}]}