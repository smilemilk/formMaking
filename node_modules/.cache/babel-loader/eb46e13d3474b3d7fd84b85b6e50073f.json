{"remainingRequest":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/babel-loader/lib/index.js!/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/eslint-loader/index.js??ref--13-0!/Users/shanliguo/Documents/workstudy/vue-form-making/src/lib/tinymce/plugins/link/plugin.js","dependencies":[{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/src/lib/tinymce/plugins/link/plugin.js","mtime":1551936176000},{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/shanliguo/Documents/workstudy/vue-form-making/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var link = function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var assumeExternalTargets = function (editorSettings) {\n      return typeof editorSettings.link_assume_external_targets === 'boolean' ? editorSettings.link_assume_external_targets : false;\n    };\n\n    var hasContextToolbar = function (editorSettings) {\n      return typeof editorSettings.link_context_toolbar === 'boolean' ? editorSettings.link_context_toolbar : false;\n    };\n\n    var getLinkList = function (editorSettings) {\n      return editorSettings.link_list;\n    };\n\n    var hasDefaultLinkTarget = function (editorSettings) {\n      return typeof editorSettings.default_link_target === 'string';\n    };\n\n    var getDefaultLinkTarget = function (editorSettings) {\n      return editorSettings.default_link_target;\n    };\n\n    var getTargetList = function (editorSettings) {\n      return editorSettings.target_list;\n    };\n\n    var setTargetList = function (editor, list) {\n      editor.settings.target_list = list;\n    };\n\n    var shouldShowTargetList = function (editorSettings) {\n      return getTargetList(editorSettings) !== false;\n    };\n\n    var getRelList = function (editorSettings) {\n      return editorSettings.rel_list;\n    };\n\n    var hasRelList = function (editorSettings) {\n      return getRelList(editorSettings) !== undefined;\n    };\n\n    var getLinkClassList = function (editorSettings) {\n      return editorSettings.link_class_list;\n    };\n\n    var hasLinkClassList = function (editorSettings) {\n      return getLinkClassList(editorSettings) !== undefined;\n    };\n\n    var shouldShowLinkTitle = function (editorSettings) {\n      return editorSettings.link_title !== false;\n    };\n\n    var allowUnsafeLinkTarget = function (editorSettings) {\n      return typeof editorSettings.allow_unsafe_link_target === 'boolean' ? editorSettings.allow_unsafe_link_target : false;\n    };\n\n    var $_bau5ogfvjnlpb21f = {\n      assumeExternalTargets: assumeExternalTargets,\n      hasContextToolbar: hasContextToolbar,\n      getLinkList: getLinkList,\n      hasDefaultLinkTarget: hasDefaultLinkTarget,\n      getDefaultLinkTarget: getDefaultLinkTarget,\n      getTargetList: getTargetList,\n      setTargetList: setTargetList,\n      shouldShowTargetList: shouldShowTargetList,\n      getRelList: getRelList,\n      hasRelList: hasRelList,\n      getLinkClassList: getLinkClassList,\n      hasLinkClassList: hasLinkClassList,\n      shouldShowLinkTitle: shouldShowLinkTitle,\n      allowUnsafeLinkTarget: allowUnsafeLinkTarget\n    };\n    var global$2 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n    var global$3 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var appendClickRemove = function (link, evt) {\n      document.body.appendChild(link);\n      link.dispatchEvent(evt);\n      document.body.removeChild(link);\n    };\n\n    var open$$1 = function (url) {\n      if (!global$3.ie || global$3.ie > 10) {\n        var link = document.createElement('a');\n        link.target = '_blank';\n        link.href = url;\n        link.rel = 'noreferrer noopener';\n        var evt = document.createEvent('MouseEvents');\n        evt.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n        appendClickRemove(link, evt);\n      } else {\n        var win = window.open('', '_blank');\n\n        if (win) {\n          win.opener = null;\n          var doc = win.document;\n          doc.open();\n          doc.write('<meta http-equiv=\"refresh\" content=\"0; url=' + global$2.DOM.encode(url) + '\">');\n          doc.close();\n        }\n      }\n    };\n\n    var $_2sf6akfwjnlpb21g = {\n      open: open$$1\n    };\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var toggleTargetRules = function (rel, isUnsafe) {\n      var rules = ['noopener'];\n      var newRel = rel ? rel.split(/\\s+/) : [];\n\n      var toString = function (rel) {\n        return global$4.trim(rel.sort().join(' '));\n      };\n\n      var addTargetRules = function (rel) {\n        rel = removeTargetRules(rel);\n        return rel.length ? rel.concat(rules) : rules;\n      };\n\n      var removeTargetRules = function (rel) {\n        return rel.filter(function (val) {\n          return global$4.inArray(rules, val) === -1;\n        });\n      };\n\n      newRel = isUnsafe ? addTargetRules(newRel) : removeTargetRules(newRel);\n      return newRel.length ? toString(newRel) : null;\n    };\n\n    var trimCaretContainers = function (text) {\n      return text.replace(/\\uFEFF/g, '');\n    };\n\n    var getAnchorElement = function (editor, selectedElm) {\n      selectedElm = selectedElm || editor.selection.getNode();\n\n      if (isImageFigure(selectedElm)) {\n        return editor.dom.select('a[href]', selectedElm)[0];\n      } else {\n        return editor.dom.getParent(selectedElm, 'a[href]');\n      }\n    };\n\n    var getAnchorText = function (selection, anchorElm) {\n      var text = anchorElm ? anchorElm.innerText || anchorElm.textContent : selection.getContent({\n        format: 'text'\n      });\n      return trimCaretContainers(text);\n    };\n\n    var isLink = function (elm) {\n      return elm && elm.nodeName === 'A' && elm.href;\n    };\n\n    var hasLinks = function (elements) {\n      return global$4.grep(elements, isLink).length > 0;\n    };\n\n    var isOnlyTextSelected = function (html) {\n      if (/</.test(html) && (!/^<a [^>]+>[^<]+<\\/a>$/.test(html) || html.indexOf('href=') === -1)) {\n        return false;\n      }\n\n      return true;\n    };\n\n    var isImageFigure = function (node) {\n      return node && node.nodeName === 'FIGURE' && /\\bimage\\b/i.test(node.className);\n    };\n\n    var link = function (editor, attachState) {\n      return function (data) {\n        editor.undoManager.transact(function () {\n          var selectedElm = editor.selection.getNode();\n          var anchorElm = getAnchorElement(editor, selectedElm);\n          var linkAttrs = {\n            href: data.href,\n            target: data.target ? data.target : null,\n            rel: data.rel ? data.rel : null,\n            class: data.class ? data.class : null,\n            title: data.title ? data.title : null\n          };\n\n          if (!$_bau5ogfvjnlpb21f.hasRelList(editor.settings) && $_bau5ogfvjnlpb21f.allowUnsafeLinkTarget(editor.settings) === false) {\n            linkAttrs.rel = toggleTargetRules(linkAttrs.rel, linkAttrs.target === '_blank');\n          }\n\n          if (data.href === attachState.href) {\n            attachState.attach();\n            attachState = {};\n          }\n\n          if (anchorElm) {\n            editor.focus();\n\n            if (data.hasOwnProperty('text')) {\n              if ('innerText' in anchorElm) {\n                anchorElm.innerText = data.text;\n              } else {\n                anchorElm.textContent = data.text;\n              }\n            }\n\n            editor.dom.setAttribs(anchorElm, linkAttrs);\n            editor.selection.select(anchorElm);\n            editor.undoManager.add();\n          } else {\n            if (isImageFigure(selectedElm)) {\n              linkImageFigure(editor, selectedElm, linkAttrs);\n            } else if (data.hasOwnProperty('text')) {\n              editor.insertContent(editor.dom.createHTML('a', linkAttrs, editor.dom.encode(data.text)));\n            } else {\n              editor.execCommand('mceInsertLink', false, linkAttrs);\n            }\n          }\n        });\n      };\n    };\n\n    var unlink = function (editor) {\n      return function () {\n        editor.undoManager.transact(function () {\n          var node = editor.selection.getNode();\n\n          if (isImageFigure(node)) {\n            unlinkImageFigure(editor, node);\n          } else {\n            editor.execCommand('unlink');\n          }\n        });\n      };\n    };\n\n    var unlinkImageFigure = function (editor, fig) {\n      var a, img;\n      img = editor.dom.select('img', fig)[0];\n\n      if (img) {\n        a = editor.dom.getParents(img, 'a[href]', fig)[0];\n\n        if (a) {\n          a.parentNode.insertBefore(img, a);\n          editor.dom.remove(a);\n        }\n      }\n    };\n\n    var linkImageFigure = function (editor, fig, attrs) {\n      var a, img;\n      img = editor.dom.select('img', fig)[0];\n\n      if (img) {\n        a = editor.dom.create('a', attrs);\n        img.parentNode.insertBefore(a, img);\n        a.appendChild(img);\n      }\n    };\n\n    var $_f77mtqg0jnlpb21y = {\n      link: link,\n      unlink: unlink,\n      isLink: isLink,\n      hasLinks: hasLinks,\n      isOnlyTextSelected: isOnlyTextSelected,\n      getAnchorElement: getAnchorElement,\n      getAnchorText: getAnchorText,\n      toggleTargetRules: toggleTargetRules\n    };\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n    var global$6 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n    var attachState = {};\n\n    var createLinkList = function (editor, callback) {\n      var linkList = $_bau5ogfvjnlpb21f.getLinkList(editor.settings);\n\n      if (typeof linkList === 'string') {\n        global$6.send({\n          url: linkList,\n          success: function (text) {\n            callback(editor, JSON.parse(text));\n          }\n        });\n      } else if (typeof linkList === 'function') {\n        linkList(function (list) {\n          callback(editor, list);\n        });\n      } else {\n        callback(editor, linkList);\n      }\n    };\n\n    var buildListItems = function (inputList, itemCallback, startItems) {\n      var appendItems = function (values, output) {\n        output = output || [];\n        global$4.each(values, function (item) {\n          var menuItem = {\n            text: item.text || item.title\n          };\n\n          if (item.menu) {\n            menuItem.menu = appendItems(item.menu);\n          } else {\n            menuItem.value = item.value;\n\n            if (itemCallback) {\n              itemCallback(menuItem);\n            }\n          }\n\n          output.push(menuItem);\n        });\n        return output;\n      };\n\n      return appendItems(inputList, startItems || []);\n    };\n\n    var delayedConfirm = function (editor, message, callback) {\n      var rng = editor.selection.getRng();\n      global$5.setEditorTimeout(editor, function () {\n        editor.windowManager.confirm(message, function (state) {\n          editor.selection.setRng(rng);\n          callback(state);\n        });\n      });\n    };\n\n    var showDialog = function (editor, linkList) {\n      var data = {};\n      var selection = editor.selection;\n      var dom = editor.dom;\n      var anchorElm, initialText;\n      var win, onlyText, textListCtrl, linkListCtrl, relListCtrl, targetListCtrl, classListCtrl, linkTitleCtrl, value;\n\n      var linkListChangeHandler = function (e) {\n        var textCtrl = win.find('#text');\n\n        if (!textCtrl.value() || e.lastControl && textCtrl.value() === e.lastControl.text()) {\n          textCtrl.value(e.control.text());\n        }\n\n        win.find('#href').value(e.control.value());\n      };\n\n      var buildAnchorListControl = function (url) {\n        var anchorList = [];\n        global$4.each(editor.dom.select('a:not([href])'), function (anchor) {\n          var id = anchor.name || anchor.id;\n\n          if (id) {\n            anchorList.push({\n              text: id,\n              value: '#' + id,\n              selected: url.indexOf('#' + id) !== -1\n            });\n          }\n        });\n\n        if (anchorList.length) {\n          anchorList.unshift({\n            text: 'None',\n            value: ''\n          });\n          return {\n            name: 'anchor',\n            type: 'listbox',\n            label: 'Anchors',\n            values: anchorList,\n            onselect: linkListChangeHandler\n          };\n        }\n      };\n\n      var updateText = function () {\n        if (!initialText && onlyText && !data.text) {\n          this.parent().parent().find('#text')[0].value(this.value());\n        }\n      };\n\n      var urlChange = function (e) {\n        var meta = e.meta || {};\n\n        if (linkListCtrl) {\n          linkListCtrl.value(editor.convertURL(this.value(), 'href'));\n        }\n\n        global$4.each(e.meta, function (value, key) {\n          var inp = win.find('#' + key);\n\n          if (key === 'text') {\n            if (initialText.length === 0) {\n              inp.value(value);\n              data.text = value;\n            }\n          } else {\n            inp.value(value);\n          }\n        });\n\n        if (meta.attach) {\n          attachState = {\n            href: this.value(),\n            attach: meta.attach\n          };\n        }\n\n        if (!meta.text) {\n          updateText.call(this);\n        }\n      };\n\n      var onBeforeCall = function (e) {\n        e.meta = win.toJSON();\n      };\n\n      onlyText = $_f77mtqg0jnlpb21y.isOnlyTextSelected(selection.getContent());\n      anchorElm = $_f77mtqg0jnlpb21y.getAnchorElement(editor);\n      data.text = initialText = $_f77mtqg0jnlpb21y.getAnchorText(editor.selection, anchorElm);\n      data.href = anchorElm ? dom.getAttrib(anchorElm, 'href') : '';\n\n      if (anchorElm) {\n        data.target = dom.getAttrib(anchorElm, 'target');\n      } else if ($_bau5ogfvjnlpb21f.hasDefaultLinkTarget(editor.settings)) {\n        data.target = $_bau5ogfvjnlpb21f.getDefaultLinkTarget(editor.settings);\n      }\n\n      if (value = dom.getAttrib(anchorElm, 'rel')) {\n        data.rel = value;\n      }\n\n      if (value = dom.getAttrib(anchorElm, 'class')) {\n        data.class = value;\n      }\n\n      if (value = dom.getAttrib(anchorElm, 'title')) {\n        data.title = value;\n      }\n\n      if (onlyText) {\n        textListCtrl = {\n          name: 'text',\n          type: 'textbox',\n          size: 40,\n          label: 'Text to display',\n          onchange: function () {\n            data.text = this.value();\n          }\n        };\n      }\n\n      if (linkList) {\n        linkListCtrl = {\n          type: 'listbox',\n          label: 'Link list',\n          values: buildListItems(linkList, function (item) {\n            item.value = editor.convertURL(item.value || item.url, 'href');\n          }, [{\n            text: 'None',\n            value: ''\n          }]),\n          onselect: linkListChangeHandler,\n          value: editor.convertURL(data.href, 'href'),\n          onPostRender: function () {\n            linkListCtrl = this;\n          }\n        };\n      }\n\n      if ($_bau5ogfvjnlpb21f.shouldShowTargetList(editor.settings)) {\n        if ($_bau5ogfvjnlpb21f.getTargetList(editor.settings) === undefined) {\n          $_bau5ogfvjnlpb21f.setTargetList(editor, [{\n            text: 'None',\n            value: ''\n          }, {\n            text: 'New window',\n            value: '_blank'\n          }]);\n        }\n\n        targetListCtrl = {\n          name: 'target',\n          type: 'listbox',\n          label: 'Target',\n          values: buildListItems($_bau5ogfvjnlpb21f.getTargetList(editor.settings))\n        };\n      }\n\n      if ($_bau5ogfvjnlpb21f.hasRelList(editor.settings)) {\n        relListCtrl = {\n          name: 'rel',\n          type: 'listbox',\n          label: 'Rel',\n          values: buildListItems($_bau5ogfvjnlpb21f.getRelList(editor.settings), function (item) {\n            if ($_bau5ogfvjnlpb21f.allowUnsafeLinkTarget(editor.settings) === false) {\n              item.value = $_f77mtqg0jnlpb21y.toggleTargetRules(item.value, data.target === '_blank');\n            }\n          })\n        };\n      }\n\n      if ($_bau5ogfvjnlpb21f.hasLinkClassList(editor.settings)) {\n        classListCtrl = {\n          name: 'class',\n          type: 'listbox',\n          label: 'Class',\n          values: buildListItems($_bau5ogfvjnlpb21f.getLinkClassList(editor.settings), function (item) {\n            if (item.value) {\n              item.textStyle = function () {\n                return editor.formatter.getCssText({\n                  inline: 'a',\n                  classes: [item.value]\n                });\n              };\n            }\n          })\n        };\n      }\n\n      if ($_bau5ogfvjnlpb21f.shouldShowLinkTitle(editor.settings)) {\n        linkTitleCtrl = {\n          name: 'title',\n          type: 'textbox',\n          label: 'Title',\n          value: data.title\n        };\n      }\n\n      win = editor.windowManager.open({\n        title: 'Insert link',\n        data: data,\n        body: [{\n          name: 'href',\n          type: 'filepicker',\n          filetype: 'file',\n          size: 40,\n          autofocus: true,\n          label: 'Url',\n          onchange: urlChange,\n          onkeyup: updateText,\n          onpaste: updateText,\n          onbeforecall: onBeforeCall\n        }, textListCtrl, linkTitleCtrl, buildAnchorListControl(data.href), linkListCtrl, relListCtrl, targetListCtrl, classListCtrl],\n        onSubmit: function (e) {\n          var assumeExternalTargets = $_bau5ogfvjnlpb21f.assumeExternalTargets(editor.settings);\n          var insertLink = $_f77mtqg0jnlpb21y.link(editor, attachState);\n          var removeLink = $_f77mtqg0jnlpb21y.unlink(editor);\n          var resultData = global$4.extend({}, data, e.data);\n          var href = resultData.href;\n\n          if (!href) {\n            removeLink();\n            return;\n          }\n\n          if (!onlyText || resultData.text === initialText) {\n            delete resultData.text;\n          }\n\n          if (href.indexOf('@') > 0 && href.indexOf('//') === -1 && href.indexOf('mailto:') === -1) {\n            delayedConfirm(editor, 'The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?', function (state) {\n              if (state) {\n                resultData.href = 'mailto:' + href;\n              }\n\n              insertLink(resultData);\n            });\n            return;\n          }\n\n          if (assumeExternalTargets === true && !/^\\w+:/i.test(href) || assumeExternalTargets === false && /^\\s*www[\\.|\\d\\.]/i.test(href)) {\n            delayedConfirm(editor, 'The URL you entered seems to be an external link. Do you want to add the required http:// prefix?', function (state) {\n              if (state) {\n                resultData.href = 'http://' + href;\n              }\n\n              insertLink(resultData);\n            });\n            return;\n          }\n\n          insertLink(resultData);\n        }\n      });\n    };\n\n    var open$1 = function (editor) {\n      createLinkList(editor, showDialog);\n    };\n\n    var $_26z4c1g2jnlpb223 = {\n      open: open$1\n    };\n\n    var getLink = function (editor, elm) {\n      return editor.dom.getParent(elm, 'a[href]');\n    };\n\n    var getSelectedLink = function (editor) {\n      return getLink(editor, editor.selection.getStart());\n    };\n\n    var getHref = function (elm) {\n      var href = elm.getAttribute('data-mce-href');\n      return href ? href : elm.getAttribute('href');\n    };\n\n    var isContextMenuVisible = function (editor) {\n      var contextmenu = editor.plugins.contextmenu;\n      return contextmenu ? contextmenu.isContextMenuVisible() : false;\n    };\n\n    var hasOnlyAltModifier = function (e) {\n      return e.altKey === true && e.shiftKey === false && e.ctrlKey === false && e.metaKey === false;\n    };\n\n    var gotoLink = function (editor, a) {\n      if (a) {\n        var href = getHref(a);\n\n        if (/^#/.test(href)) {\n          var targetEl = editor.$(href);\n\n          if (targetEl.length) {\n            editor.selection.scrollIntoView(targetEl[0], true);\n          }\n        } else {\n          $_2sf6akfwjnlpb21g.open(a.href);\n        }\n      }\n    };\n\n    var openDialog = function (editor) {\n      return function () {\n        $_26z4c1g2jnlpb223.open(editor);\n      };\n    };\n\n    var gotoSelectedLink = function (editor) {\n      return function () {\n        gotoLink(editor, getSelectedLink(editor));\n      };\n    };\n\n    var leftClickedOnAHref = function (editor) {\n      return function (elm) {\n        var sel, rng, node;\n\n        if ($_bau5ogfvjnlpb21f.hasContextToolbar(editor.settings) && !isContextMenuVisible(editor) && $_f77mtqg0jnlpb21y.isLink(elm)) {\n          sel = editor.selection;\n          rng = sel.getRng();\n          node = rng.startContainer;\n\n          if (node.nodeType === 3 && sel.isCollapsed() && rng.startOffset > 0 && rng.startOffset < node.data.length) {\n            return true;\n          }\n        }\n\n        return false;\n      };\n    };\n\n    var setupGotoLinks = function (editor) {\n      editor.on('click', function (e) {\n        var link = getLink(editor, e.target);\n\n        if (link && global$1.metaKeyPressed(e)) {\n          e.preventDefault();\n          gotoLink(editor, link);\n        }\n      });\n      editor.on('keydown', function (e) {\n        var link = getSelectedLink(editor);\n\n        if (link && e.keyCode === 13 && hasOnlyAltModifier(e)) {\n          e.preventDefault();\n          gotoLink(editor, link);\n        }\n      });\n    };\n\n    var toggleActiveState = function (editor) {\n      return function () {\n        var self = this;\n        editor.on('nodechange', function (e) {\n          self.active(!editor.readonly && !!$_f77mtqg0jnlpb21y.getAnchorElement(editor, e.element));\n        });\n      };\n    };\n\n    var toggleViewLinkState = function (editor) {\n      return function () {\n        var self = this;\n\n        var toggleVisibility = function (e) {\n          if ($_f77mtqg0jnlpb21y.hasLinks(e.parents)) {\n            self.show();\n          } else {\n            self.hide();\n          }\n        };\n\n        if (!$_f77mtqg0jnlpb21y.hasLinks(editor.dom.getParents(editor.selection.getStart()))) {\n          self.hide();\n        }\n\n        editor.on('nodechange', toggleVisibility);\n        self.on('remove', function () {\n          editor.off('nodechange', toggleVisibility);\n        });\n      };\n    };\n\n    var $_gfdrd4ftjnlpb21b = {\n      openDialog: openDialog,\n      gotoSelectedLink: gotoSelectedLink,\n      leftClickedOnAHref: leftClickedOnAHref,\n      setupGotoLinks: setupGotoLinks,\n      toggleActiveState: toggleActiveState,\n      toggleViewLinkState: toggleViewLinkState\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceLink', $_gfdrd4ftjnlpb21b.openDialog(editor));\n    };\n\n    var $_arqtiifsjnlpb219 = {\n      register: register\n    };\n\n    var setup = function (editor) {\n      editor.addShortcut('Meta+K', '', $_gfdrd4ftjnlpb21b.openDialog(editor));\n    };\n\n    var $_agry27g5jnlpb22b = {\n      setup: setup\n    };\n\n    var setupButtons = function (editor) {\n      editor.addButton('link', {\n        active: false,\n        icon: 'link',\n        tooltip: 'Insert/edit link',\n        onclick: $_gfdrd4ftjnlpb21b.openDialog(editor),\n        onpostrender: $_gfdrd4ftjnlpb21b.toggleActiveState(editor)\n      });\n      editor.addButton('unlink', {\n        active: false,\n        icon: 'unlink',\n        tooltip: 'Remove link',\n        onclick: $_f77mtqg0jnlpb21y.unlink(editor),\n        onpostrender: $_gfdrd4ftjnlpb21b.toggleActiveState(editor)\n      });\n\n      if (editor.addContextToolbar) {\n        editor.addButton('openlink', {\n          icon: 'newtab',\n          tooltip: 'Open link',\n          onclick: $_gfdrd4ftjnlpb21b.gotoSelectedLink(editor)\n        });\n      }\n    };\n\n    var setupMenuItems = function (editor) {\n      editor.addMenuItem('openlink', {\n        text: 'Open link',\n        icon: 'newtab',\n        onclick: $_gfdrd4ftjnlpb21b.gotoSelectedLink(editor),\n        onPostRender: $_gfdrd4ftjnlpb21b.toggleViewLinkState(editor),\n        prependToContext: true\n      });\n      editor.addMenuItem('link', {\n        icon: 'link',\n        text: 'Link',\n        shortcut: 'Meta+K',\n        onclick: $_gfdrd4ftjnlpb21b.openDialog(editor),\n        stateSelector: 'a[href]',\n        context: 'insert',\n        prependToContext: true\n      });\n      editor.addMenuItem('unlink', {\n        icon: 'unlink',\n        text: 'Remove link',\n        onclick: $_f77mtqg0jnlpb21y.unlink(editor),\n        stateSelector: 'a[href]'\n      });\n    };\n\n    var setupContextToolbars = function (editor) {\n      if (editor.addContextToolbar) {\n        editor.addContextToolbar($_gfdrd4ftjnlpb21b.leftClickedOnAHref(editor), 'openlink | link unlink');\n      }\n    };\n\n    var $_33507lg6jnlpb22c = {\n      setupButtons: setupButtons,\n      setupMenuItems: setupMenuItems,\n      setupContextToolbars: setupContextToolbars\n    };\n    global.add('link', function (editor) {\n      $_33507lg6jnlpb22c.setupButtons(editor);\n      $_33507lg6jnlpb22c.setupMenuItems(editor);\n      $_33507lg6jnlpb22c.setupContextToolbars(editor);\n      $_gfdrd4ftjnlpb21b.setupGotoLinks(editor);\n      $_arqtiifsjnlpb219.register(editor);\n      $_agry27g5jnlpb22b.setup(editor);\n    });\n\n    function Plugin() {}\n\n    return Plugin;\n  }();\n})();",{"version":3,"sources":["/Users/shanliguo/Documents/workstudy/vue-form-making/src/lib/tinymce/plugins/link/plugin.js"],"names":["link","global","tinymce","util","Tools","resolve","global$1","assumeExternalTargets","editorSettings","link_assume_external_targets","hasContextToolbar","link_context_toolbar","getLinkList","link_list","hasDefaultLinkTarget","default_link_target","getDefaultLinkTarget","getTargetList","target_list","setTargetList","editor","list","settings","shouldShowTargetList","getRelList","rel_list","hasRelList","undefined","getLinkClassList","link_class_list","hasLinkClassList","shouldShowLinkTitle","link_title","allowUnsafeLinkTarget","allow_unsafe_link_target","$_bau5ogfvjnlpb21f","global$2","global$3","appendClickRemove","evt","document","body","appendChild","dispatchEvent","removeChild","open$$1","url","ie","createElement","target","href","rel","createEvent","initMouseEvent","window","win","open","opener","doc","write","DOM","encode","close","$_2sf6akfwjnlpb21g","global$4","toggleTargetRules","isUnsafe","rules","newRel","split","toString","trim","sort","join","addTargetRules","removeTargetRules","length","concat","filter","val","inArray","trimCaretContainers","text","replace","getAnchorElement","selectedElm","selection","getNode","isImageFigure","dom","select","getParent","getAnchorText","anchorElm","innerText","textContent","getContent","format","isLink","elm","nodeName","hasLinks","elements","grep","isOnlyTextSelected","html","test","indexOf","node","className","attachState","data","undoManager","transact","linkAttrs","class","title","attach","focus","hasOwnProperty","setAttribs","add","linkImageFigure","insertContent","createHTML","execCommand","unlink","unlinkImageFigure","fig","a","img","getParents","parentNode","insertBefore","remove","attrs","create","$_f77mtqg0jnlpb21y","global$5","global$6","createLinkList","callback","linkList","send","success","JSON","parse","buildListItems","inputList","itemCallback","startItems","appendItems","values","output","each","item","menuItem","menu","value","push","delayedConfirm","message","rng","getRng","setEditorTimeout","windowManager","confirm","state","setRng","showDialog","initialText","onlyText","textListCtrl","linkListCtrl","relListCtrl","targetListCtrl","classListCtrl","linkTitleCtrl","linkListChangeHandler","e","textCtrl","find","lastControl","control","buildAnchorListControl","anchorList","anchor","id","name","selected","unshift","type","label","onselect","updateText","parent","urlChange","meta","convertURL","key","inp","call","onBeforeCall","toJSON","getAttrib","size","onchange","onPostRender","textStyle","formatter","getCssText","inline","classes","filetype","autofocus","onkeyup","onpaste","onbeforecall","onSubmit","insertLink","removeLink","resultData","extend","open$1","$_26z4c1g2jnlpb223","getLink","getSelectedLink","getStart","getHref","getAttribute","isContextMenuVisible","contextmenu","plugins","hasOnlyAltModifier","altKey","shiftKey","ctrlKey","metaKey","gotoLink","targetEl","$","scrollIntoView","openDialog","gotoSelectedLink","leftClickedOnAHref","sel","startContainer","nodeType","isCollapsed","startOffset","setupGotoLinks","on","metaKeyPressed","preventDefault","keyCode","toggleActiveState","self","active","readonly","element","toggleViewLinkState","toggleVisibility","parents","show","hide","off","$_gfdrd4ftjnlpb21b","register","addCommand","$_arqtiifsjnlpb219","setup","addShortcut","$_agry27g5jnlpb22b","setupButtons","addButton","icon","tooltip","onclick","onpostrender","addContextToolbar","setupMenuItems","addMenuItem","prependToContext","shortcut","stateSelector","context","setupContextToolbars","$_33507lg6jnlpb22c","Plugin"],"mappings":"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","sourcesContent":["(function () {\nvar link = (function () {\n  'use strict';\n\n  var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var global$1 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n  var assumeExternalTargets = function (editorSettings) {\n    return typeof editorSettings.link_assume_external_targets === 'boolean' ? editorSettings.link_assume_external_targets : false;\n  };\n  var hasContextToolbar = function (editorSettings) {\n    return typeof editorSettings.link_context_toolbar === 'boolean' ? editorSettings.link_context_toolbar : false;\n  };\n  var getLinkList = function (editorSettings) {\n    return editorSettings.link_list;\n  };\n  var hasDefaultLinkTarget = function (editorSettings) {\n    return typeof editorSettings.default_link_target === 'string';\n  };\n  var getDefaultLinkTarget = function (editorSettings) {\n    return editorSettings.default_link_target;\n  };\n  var getTargetList = function (editorSettings) {\n    return editorSettings.target_list;\n  };\n  var setTargetList = function (editor, list) {\n    editor.settings.target_list = list;\n  };\n  var shouldShowTargetList = function (editorSettings) {\n    return getTargetList(editorSettings) !== false;\n  };\n  var getRelList = function (editorSettings) {\n    return editorSettings.rel_list;\n  };\n  var hasRelList = function (editorSettings) {\n    return getRelList(editorSettings) !== undefined;\n  };\n  var getLinkClassList = function (editorSettings) {\n    return editorSettings.link_class_list;\n  };\n  var hasLinkClassList = function (editorSettings) {\n    return getLinkClassList(editorSettings) !== undefined;\n  };\n  var shouldShowLinkTitle = function (editorSettings) {\n    return editorSettings.link_title !== false;\n  };\n  var allowUnsafeLinkTarget = function (editorSettings) {\n    return typeof editorSettings.allow_unsafe_link_target === 'boolean' ? editorSettings.allow_unsafe_link_target : false;\n  };\n  var $_bau5ogfvjnlpb21f = {\n    assumeExternalTargets: assumeExternalTargets,\n    hasContextToolbar: hasContextToolbar,\n    getLinkList: getLinkList,\n    hasDefaultLinkTarget: hasDefaultLinkTarget,\n    getDefaultLinkTarget: getDefaultLinkTarget,\n    getTargetList: getTargetList,\n    setTargetList: setTargetList,\n    shouldShowTargetList: shouldShowTargetList,\n    getRelList: getRelList,\n    hasRelList: hasRelList,\n    getLinkClassList: getLinkClassList,\n    hasLinkClassList: hasLinkClassList,\n    shouldShowLinkTitle: shouldShowLinkTitle,\n    allowUnsafeLinkTarget: allowUnsafeLinkTarget\n  };\n\n  var global$2 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n  var global$3 = tinymce.util.Tools.resolve('tinymce.Env');\n\n  var appendClickRemove = function (link, evt) {\n    document.body.appendChild(link);\n    link.dispatchEvent(evt);\n    document.body.removeChild(link);\n  };\n  var open$$1 = function (url) {\n    if (!global$3.ie || global$3.ie > 10) {\n      var link = document.createElement('a');\n      link.target = '_blank';\n      link.href = url;\n      link.rel = 'noreferrer noopener';\n      var evt = document.createEvent('MouseEvents');\n      evt.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n      appendClickRemove(link, evt);\n    } else {\n      var win = window.open('', '_blank');\n      if (win) {\n        win.opener = null;\n        var doc = win.document;\n        doc.open();\n        doc.write('<meta http-equiv=\"refresh\" content=\"0; url=' + global$2.DOM.encode(url) + '\">');\n        doc.close();\n      }\n    }\n  };\n  var $_2sf6akfwjnlpb21g = { open: open$$1 };\n\n  var global$4 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var toggleTargetRules = function (rel, isUnsafe) {\n    var rules = ['noopener'];\n    var newRel = rel ? rel.split(/\\s+/) : [];\n    var toString = function (rel) {\n      return global$4.trim(rel.sort().join(' '));\n    };\n    var addTargetRules = function (rel) {\n      rel = removeTargetRules(rel);\n      return rel.length ? rel.concat(rules) : rules;\n    };\n    var removeTargetRules = function (rel) {\n      return rel.filter(function (val) {\n        return global$4.inArray(rules, val) === -1;\n      });\n    };\n    newRel = isUnsafe ? addTargetRules(newRel) : removeTargetRules(newRel);\n    return newRel.length ? toString(newRel) : null;\n  };\n  var trimCaretContainers = function (text) {\n    return text.replace(/\\uFEFF/g, '');\n  };\n  var getAnchorElement = function (editor, selectedElm) {\n    selectedElm = selectedElm || editor.selection.getNode();\n    if (isImageFigure(selectedElm)) {\n      return editor.dom.select('a[href]', selectedElm)[0];\n    } else {\n      return editor.dom.getParent(selectedElm, 'a[href]');\n    }\n  };\n  var getAnchorText = function (selection, anchorElm) {\n    var text = anchorElm ? anchorElm.innerText || anchorElm.textContent : selection.getContent({ format: 'text' });\n    return trimCaretContainers(text);\n  };\n  var isLink = function (elm) {\n    return elm && elm.nodeName === 'A' && elm.href;\n  };\n  var hasLinks = function (elements) {\n    return global$4.grep(elements, isLink).length > 0;\n  };\n  var isOnlyTextSelected = function (html) {\n    if (/</.test(html) && (!/^<a [^>]+>[^<]+<\\/a>$/.test(html) || html.indexOf('href=') === -1)) {\n      return false;\n    }\n    return true;\n  };\n  var isImageFigure = function (node) {\n    return node && node.nodeName === 'FIGURE' && /\\bimage\\b/i.test(node.className);\n  };\n  var link = function (editor, attachState) {\n    return function (data) {\n      editor.undoManager.transact(function () {\n        var selectedElm = editor.selection.getNode();\n        var anchorElm = getAnchorElement(editor, selectedElm);\n        var linkAttrs = {\n          href: data.href,\n          target: data.target ? data.target : null,\n          rel: data.rel ? data.rel : null,\n          class: data.class ? data.class : null,\n          title: data.title ? data.title : null\n        };\n        if (!$_bau5ogfvjnlpb21f.hasRelList(editor.settings) && $_bau5ogfvjnlpb21f.allowUnsafeLinkTarget(editor.settings) === false) {\n          linkAttrs.rel = toggleTargetRules(linkAttrs.rel, linkAttrs.target === '_blank');\n        }\n        if (data.href === attachState.href) {\n          attachState.attach();\n          attachState = {};\n        }\n        if (anchorElm) {\n          editor.focus();\n          if (data.hasOwnProperty('text')) {\n            if ('innerText' in anchorElm) {\n              anchorElm.innerText = data.text;\n            } else {\n              anchorElm.textContent = data.text;\n            }\n          }\n          editor.dom.setAttribs(anchorElm, linkAttrs);\n          editor.selection.select(anchorElm);\n          editor.undoManager.add();\n        } else {\n          if (isImageFigure(selectedElm)) {\n            linkImageFigure(editor, selectedElm, linkAttrs);\n          } else if (data.hasOwnProperty('text')) {\n            editor.insertContent(editor.dom.createHTML('a', linkAttrs, editor.dom.encode(data.text)));\n          } else {\n            editor.execCommand('mceInsertLink', false, linkAttrs);\n          }\n        }\n      });\n    };\n  };\n  var unlink = function (editor) {\n    return function () {\n      editor.undoManager.transact(function () {\n        var node = editor.selection.getNode();\n        if (isImageFigure(node)) {\n          unlinkImageFigure(editor, node);\n        } else {\n          editor.execCommand('unlink');\n        }\n      });\n    };\n  };\n  var unlinkImageFigure = function (editor, fig) {\n    var a, img;\n    img = editor.dom.select('img', fig)[0];\n    if (img) {\n      a = editor.dom.getParents(img, 'a[href]', fig)[0];\n      if (a) {\n        a.parentNode.insertBefore(img, a);\n        editor.dom.remove(a);\n      }\n    }\n  };\n  var linkImageFigure = function (editor, fig, attrs) {\n    var a, img;\n    img = editor.dom.select('img', fig)[0];\n    if (img) {\n      a = editor.dom.create('a', attrs);\n      img.parentNode.insertBefore(a, img);\n      a.appendChild(img);\n    }\n  };\n  var $_f77mtqg0jnlpb21y = {\n    link: link,\n    unlink: unlink,\n    isLink: isLink,\n    hasLinks: hasLinks,\n    isOnlyTextSelected: isOnlyTextSelected,\n    getAnchorElement: getAnchorElement,\n    getAnchorText: getAnchorText,\n    toggleTargetRules: toggleTargetRules\n  };\n\n  var global$5 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n  var global$6 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n  var attachState = {};\n  var createLinkList = function (editor, callback) {\n    var linkList = $_bau5ogfvjnlpb21f.getLinkList(editor.settings);\n    if (typeof linkList === 'string') {\n      global$6.send({\n        url: linkList,\n        success: function (text) {\n          callback(editor, JSON.parse(text));\n        }\n      });\n    } else if (typeof linkList === 'function') {\n      linkList(function (list) {\n        callback(editor, list);\n      });\n    } else {\n      callback(editor, linkList);\n    }\n  };\n  var buildListItems = function (inputList, itemCallback, startItems) {\n    var appendItems = function (values, output) {\n      output = output || [];\n      global$4.each(values, function (item) {\n        var menuItem = { text: item.text || item.title };\n        if (item.menu) {\n          menuItem.menu = appendItems(item.menu);\n        } else {\n          menuItem.value = item.value;\n          if (itemCallback) {\n            itemCallback(menuItem);\n          }\n        }\n        output.push(menuItem);\n      });\n      return output;\n    };\n    return appendItems(inputList, startItems || []);\n  };\n  var delayedConfirm = function (editor, message, callback) {\n    var rng = editor.selection.getRng();\n    global$5.setEditorTimeout(editor, function () {\n      editor.windowManager.confirm(message, function (state) {\n        editor.selection.setRng(rng);\n        callback(state);\n      });\n    });\n  };\n  var showDialog = function (editor, linkList) {\n    var data = {};\n    var selection = editor.selection;\n    var dom = editor.dom;\n    var anchorElm, initialText;\n    var win, onlyText, textListCtrl, linkListCtrl, relListCtrl, targetListCtrl, classListCtrl, linkTitleCtrl, value;\n    var linkListChangeHandler = function (e) {\n      var textCtrl = win.find('#text');\n      if (!textCtrl.value() || e.lastControl && textCtrl.value() === e.lastControl.text()) {\n        textCtrl.value(e.control.text());\n      }\n      win.find('#href').value(e.control.value());\n    };\n    var buildAnchorListControl = function (url) {\n      var anchorList = [];\n      global$4.each(editor.dom.select('a:not([href])'), function (anchor) {\n        var id = anchor.name || anchor.id;\n        if (id) {\n          anchorList.push({\n            text: id,\n            value: '#' + id,\n            selected: url.indexOf('#' + id) !== -1\n          });\n        }\n      });\n      if (anchorList.length) {\n        anchorList.unshift({\n          text: 'None',\n          value: ''\n        });\n        return {\n          name: 'anchor',\n          type: 'listbox',\n          label: 'Anchors',\n          values: anchorList,\n          onselect: linkListChangeHandler\n        };\n      }\n    };\n    var updateText = function () {\n      if (!initialText && onlyText && !data.text) {\n        this.parent().parent().find('#text')[0].value(this.value());\n      }\n    };\n    var urlChange = function (e) {\n      var meta = e.meta || {};\n      if (linkListCtrl) {\n        linkListCtrl.value(editor.convertURL(this.value(), 'href'));\n      }\n      global$4.each(e.meta, function (value, key) {\n        var inp = win.find('#' + key);\n        if (key === 'text') {\n          if (initialText.length === 0) {\n            inp.value(value);\n            data.text = value;\n          }\n        } else {\n          inp.value(value);\n        }\n      });\n      if (meta.attach) {\n        attachState = {\n          href: this.value(),\n          attach: meta.attach\n        };\n      }\n      if (!meta.text) {\n        updateText.call(this);\n      }\n    };\n    var onBeforeCall = function (e) {\n      e.meta = win.toJSON();\n    };\n    onlyText = $_f77mtqg0jnlpb21y.isOnlyTextSelected(selection.getContent());\n    anchorElm = $_f77mtqg0jnlpb21y.getAnchorElement(editor);\n    data.text = initialText = $_f77mtqg0jnlpb21y.getAnchorText(editor.selection, anchorElm);\n    data.href = anchorElm ? dom.getAttrib(anchorElm, 'href') : '';\n    if (anchorElm) {\n      data.target = dom.getAttrib(anchorElm, 'target');\n    } else if ($_bau5ogfvjnlpb21f.hasDefaultLinkTarget(editor.settings)) {\n      data.target = $_bau5ogfvjnlpb21f.getDefaultLinkTarget(editor.settings);\n    }\n    if (value = dom.getAttrib(anchorElm, 'rel')) {\n      data.rel = value;\n    }\n    if (value = dom.getAttrib(anchorElm, 'class')) {\n      data.class = value;\n    }\n    if (value = dom.getAttrib(anchorElm, 'title')) {\n      data.title = value;\n    }\n    if (onlyText) {\n      textListCtrl = {\n        name: 'text',\n        type: 'textbox',\n        size: 40,\n        label: 'Text to display',\n        onchange: function () {\n          data.text = this.value();\n        }\n      };\n    }\n    if (linkList) {\n      linkListCtrl = {\n        type: 'listbox',\n        label: 'Link list',\n        values: buildListItems(linkList, function (item) {\n          item.value = editor.convertURL(item.value || item.url, 'href');\n        }, [{\n            text: 'None',\n            value: ''\n          }]),\n        onselect: linkListChangeHandler,\n        value: editor.convertURL(data.href, 'href'),\n        onPostRender: function () {\n          linkListCtrl = this;\n        }\n      };\n    }\n    if ($_bau5ogfvjnlpb21f.shouldShowTargetList(editor.settings)) {\n      if ($_bau5ogfvjnlpb21f.getTargetList(editor.settings) === undefined) {\n        $_bau5ogfvjnlpb21f.setTargetList(editor, [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'New window',\n            value: '_blank'\n          }\n        ]);\n      }\n      targetListCtrl = {\n        name: 'target',\n        type: 'listbox',\n        label: 'Target',\n        values: buildListItems($_bau5ogfvjnlpb21f.getTargetList(editor.settings))\n      };\n    }\n    if ($_bau5ogfvjnlpb21f.hasRelList(editor.settings)) {\n      relListCtrl = {\n        name: 'rel',\n        type: 'listbox',\n        label: 'Rel',\n        values: buildListItems($_bau5ogfvjnlpb21f.getRelList(editor.settings), function (item) {\n          if ($_bau5ogfvjnlpb21f.allowUnsafeLinkTarget(editor.settings) === false) {\n            item.value = $_f77mtqg0jnlpb21y.toggleTargetRules(item.value, data.target === '_blank');\n          }\n        })\n      };\n    }\n    if ($_bau5ogfvjnlpb21f.hasLinkClassList(editor.settings)) {\n      classListCtrl = {\n        name: 'class',\n        type: 'listbox',\n        label: 'Class',\n        values: buildListItems($_bau5ogfvjnlpb21f.getLinkClassList(editor.settings), function (item) {\n          if (item.value) {\n            item.textStyle = function () {\n              return editor.formatter.getCssText({\n                inline: 'a',\n                classes: [item.value]\n              });\n            };\n          }\n        })\n      };\n    }\n    if ($_bau5ogfvjnlpb21f.shouldShowLinkTitle(editor.settings)) {\n      linkTitleCtrl = {\n        name: 'title',\n        type: 'textbox',\n        label: 'Title',\n        value: data.title\n      };\n    }\n    win = editor.windowManager.open({\n      title: 'Insert link',\n      data: data,\n      body: [\n        {\n          name: 'href',\n          type: 'filepicker',\n          filetype: 'file',\n          size: 40,\n          autofocus: true,\n          label: 'Url',\n          onchange: urlChange,\n          onkeyup: updateText,\n          onpaste: updateText,\n          onbeforecall: onBeforeCall\n        },\n        textListCtrl,\n        linkTitleCtrl,\n        buildAnchorListControl(data.href),\n        linkListCtrl,\n        relListCtrl,\n        targetListCtrl,\n        classListCtrl\n      ],\n      onSubmit: function (e) {\n        var assumeExternalTargets = $_bau5ogfvjnlpb21f.assumeExternalTargets(editor.settings);\n        var insertLink = $_f77mtqg0jnlpb21y.link(editor, attachState);\n        var removeLink = $_f77mtqg0jnlpb21y.unlink(editor);\n        var resultData = global$4.extend({}, data, e.data);\n        var href = resultData.href;\n        if (!href) {\n          removeLink();\n          return;\n        }\n        if (!onlyText || resultData.text === initialText) {\n          delete resultData.text;\n        }\n        if (href.indexOf('@') > 0 && href.indexOf('//') === -1 && href.indexOf('mailto:') === -1) {\n          delayedConfirm(editor, 'The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?', function (state) {\n            if (state) {\n              resultData.href = 'mailto:' + href;\n            }\n            insertLink(resultData);\n          });\n          return;\n        }\n        if (assumeExternalTargets === true && !/^\\w+:/i.test(href) || assumeExternalTargets === false && /^\\s*www[\\.|\\d\\.]/i.test(href)) {\n          delayedConfirm(editor, 'The URL you entered seems to be an external link. Do you want to add the required http:// prefix?', function (state) {\n            if (state) {\n              resultData.href = 'http://' + href;\n            }\n            insertLink(resultData);\n          });\n          return;\n        }\n        insertLink(resultData);\n      }\n    });\n  };\n  var open$1 = function (editor) {\n    createLinkList(editor, showDialog);\n  };\n  var $_26z4c1g2jnlpb223 = { open: open$1 };\n\n  var getLink = function (editor, elm) {\n    return editor.dom.getParent(elm, 'a[href]');\n  };\n  var getSelectedLink = function (editor) {\n    return getLink(editor, editor.selection.getStart());\n  };\n  var getHref = function (elm) {\n    var href = elm.getAttribute('data-mce-href');\n    return href ? href : elm.getAttribute('href');\n  };\n  var isContextMenuVisible = function (editor) {\n    var contextmenu = editor.plugins.contextmenu;\n    return contextmenu ? contextmenu.isContextMenuVisible() : false;\n  };\n  var hasOnlyAltModifier = function (e) {\n    return e.altKey === true && e.shiftKey === false && e.ctrlKey === false && e.metaKey === false;\n  };\n  var gotoLink = function (editor, a) {\n    if (a) {\n      var href = getHref(a);\n      if (/^#/.test(href)) {\n        var targetEl = editor.$(href);\n        if (targetEl.length) {\n          editor.selection.scrollIntoView(targetEl[0], true);\n        }\n      } else {\n        $_2sf6akfwjnlpb21g.open(a.href);\n      }\n    }\n  };\n  var openDialog = function (editor) {\n    return function () {\n      $_26z4c1g2jnlpb223.open(editor);\n    };\n  };\n  var gotoSelectedLink = function (editor) {\n    return function () {\n      gotoLink(editor, getSelectedLink(editor));\n    };\n  };\n  var leftClickedOnAHref = function (editor) {\n    return function (elm) {\n      var sel, rng, node;\n      if ($_bau5ogfvjnlpb21f.hasContextToolbar(editor.settings) && !isContextMenuVisible(editor) && $_f77mtqg0jnlpb21y.isLink(elm)) {\n        sel = editor.selection;\n        rng = sel.getRng();\n        node = rng.startContainer;\n        if (node.nodeType === 3 && sel.isCollapsed() && rng.startOffset > 0 && rng.startOffset < node.data.length) {\n          return true;\n        }\n      }\n      return false;\n    };\n  };\n  var setupGotoLinks = function (editor) {\n    editor.on('click', function (e) {\n      var link = getLink(editor, e.target);\n      if (link && global$1.metaKeyPressed(e)) {\n        e.preventDefault();\n        gotoLink(editor, link);\n      }\n    });\n    editor.on('keydown', function (e) {\n      var link = getSelectedLink(editor);\n      if (link && e.keyCode === 13 && hasOnlyAltModifier(e)) {\n        e.preventDefault();\n        gotoLink(editor, link);\n      }\n    });\n  };\n  var toggleActiveState = function (editor) {\n    return function () {\n      var self = this;\n      editor.on('nodechange', function (e) {\n        self.active(!editor.readonly && !!$_f77mtqg0jnlpb21y.getAnchorElement(editor, e.element));\n      });\n    };\n  };\n  var toggleViewLinkState = function (editor) {\n    return function () {\n      var self = this;\n      var toggleVisibility = function (e) {\n        if ($_f77mtqg0jnlpb21y.hasLinks(e.parents)) {\n          self.show();\n        } else {\n          self.hide();\n        }\n      };\n      if (!$_f77mtqg0jnlpb21y.hasLinks(editor.dom.getParents(editor.selection.getStart()))) {\n        self.hide();\n      }\n      editor.on('nodechange', toggleVisibility);\n      self.on('remove', function () {\n        editor.off('nodechange', toggleVisibility);\n      });\n    };\n  };\n  var $_gfdrd4ftjnlpb21b = {\n    openDialog: openDialog,\n    gotoSelectedLink: gotoSelectedLink,\n    leftClickedOnAHref: leftClickedOnAHref,\n    setupGotoLinks: setupGotoLinks,\n    toggleActiveState: toggleActiveState,\n    toggleViewLinkState: toggleViewLinkState\n  };\n\n  var register = function (editor) {\n    editor.addCommand('mceLink', $_gfdrd4ftjnlpb21b.openDialog(editor));\n  };\n  var $_arqtiifsjnlpb219 = { register: register };\n\n  var setup = function (editor) {\n    editor.addShortcut('Meta+K', '', $_gfdrd4ftjnlpb21b.openDialog(editor));\n  };\n  var $_agry27g5jnlpb22b = { setup: setup };\n\n  var setupButtons = function (editor) {\n    editor.addButton('link', {\n      active: false,\n      icon: 'link',\n      tooltip: 'Insert/edit link',\n      onclick: $_gfdrd4ftjnlpb21b.openDialog(editor),\n      onpostrender: $_gfdrd4ftjnlpb21b.toggleActiveState(editor)\n    });\n    editor.addButton('unlink', {\n      active: false,\n      icon: 'unlink',\n      tooltip: 'Remove link',\n      onclick: $_f77mtqg0jnlpb21y.unlink(editor),\n      onpostrender: $_gfdrd4ftjnlpb21b.toggleActiveState(editor)\n    });\n    if (editor.addContextToolbar) {\n      editor.addButton('openlink', {\n        icon: 'newtab',\n        tooltip: 'Open link',\n        onclick: $_gfdrd4ftjnlpb21b.gotoSelectedLink(editor)\n      });\n    }\n  };\n  var setupMenuItems = function (editor) {\n    editor.addMenuItem('openlink', {\n      text: 'Open link',\n      icon: 'newtab',\n      onclick: $_gfdrd4ftjnlpb21b.gotoSelectedLink(editor),\n      onPostRender: $_gfdrd4ftjnlpb21b.toggleViewLinkState(editor),\n      prependToContext: true\n    });\n    editor.addMenuItem('link', {\n      icon: 'link',\n      text: 'Link',\n      shortcut: 'Meta+K',\n      onclick: $_gfdrd4ftjnlpb21b.openDialog(editor),\n      stateSelector: 'a[href]',\n      context: 'insert',\n      prependToContext: true\n    });\n    editor.addMenuItem('unlink', {\n      icon: 'unlink',\n      text: 'Remove link',\n      onclick: $_f77mtqg0jnlpb21y.unlink(editor),\n      stateSelector: 'a[href]'\n    });\n  };\n  var setupContextToolbars = function (editor) {\n    if (editor.addContextToolbar) {\n      editor.addContextToolbar($_gfdrd4ftjnlpb21b.leftClickedOnAHref(editor), 'openlink | link unlink');\n    }\n  };\n  var $_33507lg6jnlpb22c = {\n    setupButtons: setupButtons,\n    setupMenuItems: setupMenuItems,\n    setupContextToolbars: setupContextToolbars\n  };\n\n  global.add('link', function (editor) {\n    $_33507lg6jnlpb22c.setupButtons(editor);\n    $_33507lg6jnlpb22c.setupMenuItems(editor);\n    $_33507lg6jnlpb22c.setupContextToolbars(editor);\n    $_gfdrd4ftjnlpb21b.setupGotoLinks(editor);\n    $_arqtiifsjnlpb219.register(editor);\n    $_agry27g5jnlpb22b.setup(editor);\n  });\n  function Plugin () {\n  }\n\n  return Plugin;\n\n}());\n})();\n"]}]}